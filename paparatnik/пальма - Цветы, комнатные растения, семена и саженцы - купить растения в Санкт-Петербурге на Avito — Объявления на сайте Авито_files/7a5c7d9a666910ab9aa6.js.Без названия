!function(c){function e(e){for(var t,n,o=e[0],i=e[1],r=e[2],a=0,s=[];a<o.length;a++)n=o[a],f[n]&&s.push(f[n][0]),f[n]=0;for(t in i)Object.prototype.hasOwnProperty.call(i,t)&&(c[t]=i[t]);for(d&&d(e);s.length;)s.shift()();return l.push.apply(l,r||[]),u()}function u(){for(var e,t=0;t<l.length;t++){for(var n=l[t],o=!0,i=1;i<n.length;i++){var r=n[i];0!==f[r]&&(o=!1)}o&&(l.splice(t--,1),e=a(a.s=n[0]))}return e}var n={},f={dafb6f83:0},l=[];function a(e){if(n[e])return n[e].exports;var t=n[e]={i:e,l:!1,exports:{}};return c[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=c,a.c=n,a.d=function(e,t,n){a.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},a.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.t=function(t,e){if(1&e&&(t=a(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(a.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)a.d(n,o,function(e){return t[e]}.bind(null,o));return n},a.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return a.d(t,"a",t),t},a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},a.p="https://static.avito.ru/s/cc/";var t=window.webpackJsonp=window.webpackJsonp||[],o=t.push.bind(t);t.push=e,t=t.slice();for(var i=0;i<t.length;i++)e(t[i]);var d=o;l.push([2645,"411846e3"]),u()}({2645:function(e,t,n){e.exports=n(2646)},2646:function(e,t,n){"use strict";n.r(t);var l=n(6170);n(6008);!function(){var o="sent-push-token",n="notifications_permission_state",t={default:0,prompt:0,denied:0,granted:1};if("https:"===window.location.protocol&&navigator.serviceWorker&&window.PushManager&&window.Notification&&window.fetch&&window.ServiceWorkerRegistration&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&window.PushSubscription&&PushSubscription.prototype.hasOwnProperty("getKey")){l.a.initializeApp({messagingSenderId:"699005684910"});var i=l.a.messaging();if("granted"===window.Notification.permission&&(window.avito.isAuthenticated?(c(),i.onMessage(function(e){console.log("Получено сообщение. ",e);var t=e.notification,n=e.data||null;"visible"===document.visibilityState&&t&&new URL(t.click_action).href!==window.location.href&&navigator.serviceWorker.register("/messaging-sw.js",{scope:"/local-messaging-push-scope"}).then(function(e){return function(o){var i=o.installing||o.waiting||o.active,e=new Error("SW успешно зарегистрирован, но по каким-то причинам недоступен"),r=new Error("SW не активен");return new Promise(function(t,n){if(i)if("activated"!==i.state)if("redundant"!==i.state){i.addEventListener("statechange",function e(){if("activated"===i.state)t(o);else{if("redundant"!==i.state)return;n(r)}i.removeEventListener("statechange",e)})}else n(r);else t(o);else n(e)})}(e).then(function(){return(t.data=t).analyticParams=n,e.update(),e.showNotification(t.title,t),e})}).catch(function(e){console.warn("Не удалось зарегистрировать SW",e)})})):u()),window.avito.isAuthenticated){navigator.permissions.query({name:"notifications"}).then(function(e){e.onchange=function(){var e=t[this.state];"visible"===document.visibilityState&&setTimeout(function(){f(e)},50)}});var e=window.localStorage.getItem(n),r=t[window.Notification.permission];e&&Number(e)!==r&&(f(r),window.localStorage.setItem(n,r))}window.avito.firebaseMessaging={subscribe:c,unsubscribe:u}}function a(n){!function(e){return window.localStorage.getItem(o)===e}(n)&&fetch("/profile/token/save",{method:"post",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({token:n,platform:"firebase"})}).then(function(e){if(e.ok&&-1!==e.headers.get("content-type").indexOf("application/json"))return function(e){window.localStorage.setItem(o,e)}(n),e.json();var t=new Error(e.statusText);throw t.responseOriginal=e,t}).catch(function(){s()})}function s(){window.localStorage.removeItem(o)}function c(){return i.requestPermission().then(function(){i.getToken().then(function(e){e?a(e):s()}).catch(function(){s()})}).catch(function(e){console.warn("Не удалось получить разрешение на показ уведомлений.",e)})}function u(){var e=window.localStorage.getItem(o);return e?i.deleteToken(e).then(function(){s()}).catch(function(e){console.warn("Не удалось удалить токен.",e)}):Promise.resolve()}function f(e){var t=Boolean(window.localStorage.getItem("web-push-subscribe-banner-logged"));window.localStorage.setItem(n,e),t||fetch("/events/add",{method:"post",headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:"eid=2682&version=2&browser_web_push_agreement="+e})}}()}});