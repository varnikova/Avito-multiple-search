(window.webpackJsonp=window.webpackJsonp||[]).push([["c98a3928"],{5966:function(e,t,a){"use strict";var n={};a.r(n),a.d(n,"push",function(){return g}),a.d(n,"channel",function(){return y.a}),a.d(n,"channels",function(){return I.a}),a.d(n,"messages",function(){return C.a}),a.d(n,"eventsChatTyping",function(){return v.a}),a.d(n,"options",function(){return H.a}),a.d(n,"geoMessagesMarkers",function(){return E.a}),a.d(n,"upload",function(){return O.a}),a.d(n,"contextActionsHash",function(){return P.a}),a.d(n,"images",function(){return N.a}),a.d(n,"items",function(){return k.a}),a.d(n,"draftMessages",function(){return R.a}),a.d(n,"router",function(){return T.a}),a.d(n,"users",function(){return A.a}),a.d(n,"system",function(){return j.a}),a.d(n,"attachItems",function(){return S.a}),a.d(n,"phone",function(){return M.a});var r={};a.r(r),a.d(r,"reset",function(){return ne});var s,l=a(35),d=a.n(l),i=a(5963),o=a(148),c=a(378),u=a(377),p=a(4672),h=Object(c.a)((s={PUSH_RESET:null},babelHelpers.defineProperty(s,p.a.EVENTS_CHAT_READ,null),babelHelpers.defineProperty(s,p.a.EVENTS_MESSAGES_READ,null),babelHelpers.defineProperty(s,u.a.EVENTS_MESSAGE,null),s)),b=a(5977);function m(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,n)}return a}var f={channelId:null,messageId:null},g=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case h.EVENTS_MESSAGE:var a=t.response.data;return a.fromUid===b.a.session.userId?e:function(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?m(a,!0).forEach(function(e){babelHelpers.defineProperty(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):m(a).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}({},e,{messageId:a.id,channelId:a.channelId});case h.EVENTS_MESSAGES_READ:var n=t.response,r=n.fromUid,s=n.ids,l=void 0===s?[]:s;return r===b.a.session.userId&&l.includes(e.messageId)?f:e;case h.PUSH_RESET:return f;default:return e}},y=a(4671),I=a(376),C=a(435),v=a(4673),H=a(4676),E=a(4680),O=a(4675),P=a(440),N=a(441),k=a(442),R=a(4681),T=a(443),A=a(446),j=a(449),S=a(4674),M=a(4682),L=a(4798),x=a(5932),w=a(661),q=a.n(w),U=a(561),_=a.n(U),D=a(453),z=a.n(D),F=a(5969),B=a(5987),V=a(6176),G=a(45),K=a(5877),W=a.n(K),J=a(5878),Q=a.n(J),X=a(5879),Y=a.n(X),Z=a(6178),$=a(555),ee=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props.noAccent;return d.a.createElement("div",{className:Y.a.root},d.a.createElement("div",{className:Y.a.title},d.a.createElement($.a,{size:e?"m":"l"},"Сообщения")),this.renderCircle())}},{key:"renderCircle",value:function(){var e=this.props.count;if(!e||e<0)return null;var t=100<=e,a=t?"99+":e,n=Object(Z.a)(Y.a.count,babelHelpers.defineProperty({},Y.a.count_max,t));return d.a.createElement("div",{className:n},a)}}]),t}(d.a.Component);babelHelpers.defineProperty(ee,"propTypes",{count:G.number,noAccent:G.bool});var te=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props,t=e.count,a=e.noAccent;return d.a.createElement("div",{className:Q.a.root},d.a.createElement(ee,{noAccent:a,count:t}))}}]),t}(d.a.Component);babelHelpers.defineProperty(te,"propTypes",{count:G.number.isRequired,noAccent:G.bool});var ae=Object(i.b)(function(e){return{count:e.channels.unreadChats}})(te);function ne(){return{type:h.PUSH_RESET}}var re=a(6202),se=a(336),le=a.n(se),ie=a(690),oe=a.n(ie),ce=a(478),ue=a(5880),pe=a.n(ue),de=function(e){function r(){var e,s;babelHelpers.classCallCheck(this,r);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(r)).call.apply(e,[this].concat(a))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"handlePageAppLinkClick",function(e){ce.a.enterButtonClick(s.props.userId,"from_mini_messenger"),e.stopPropagation()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"handleToggle",function(e){e.stopPropagation();var t=s.props,a=t.isExpanded,n=t.setRoute,r=t.resetPush;if(a)return r(),void n({route:V.b.PUSH});n({route:V.b.CHANNELS})}),s}return babelHelpers.inherits(r,e),babelHelpers.createClass(r,[{key:"render",value:function(){var e=this.props,t=e.isExpanded,a=e.paramsChannelId,n=e.hidePageAppLink,r=e.top,s=e.right,l=e.expanderClassName,i=e.paths,o=Object(V.c)(Object(V.d)({route:a?V.b.CHANNEL:V.b.CHANNELS,params:{channelId:a},paths:i})),c=Object(Z.a)(pe.a.button,l);return d.a.createElement("div",{className:pe.a.root,style:{top:r,right:s}},!n&&d.a.createElement("div",{className:pe.a.button,title:"Во весь экран"},d.a.createElement("a",{onClick:this.handlePageAppLinkClick,className:pe.a.pageAppLink,href:o})),d.a.createElement("div",{className:c,onClick:this.handleToggle,title:t?"Свернуть":null},d.a.createElement("div",{className:Object(Z.a)(pe.a.toggler,babelHelpers.defineProperty({},pe.a.toggler_expanded,t))})))}}]),r}(d.a.Component);babelHelpers.defineProperty(de,"propTypes",{isExpanded:G.bool,setRoute:G.func.isRequired,paramsChannelId:G.string,hidePageAppLink:G.bool,resetPush:G.func,top:G.number,right:G.number,userId:Object(G.oneOfType)([G.number,G.string]),expanderClassName:G.string,paths:G.object.isRequired}),babelHelpers.defineProperty(de,"defaultProps",{top:20,right:16});var he=Object(i.b)(function(e){return{paramsChannelId:le()(e.router,"params.channelId"),userId:e.system.userId,paths:e.router.paths}},{resetPush:r.reset,setRoute:F.m.setRoute})(de),be=a(5881),me=a.n(be),fe=function(e){function s(){var e,r;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return r=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(a))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleClick",function(){var e=r.props,t=e.isExpanded,a=e.setRoute,n=e.resetPush;if(t)return n(),void a({route:V.b.PUSH});a({route:V.b.CHANNELS})}),r}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.className;return d.a.createElement("div",{className:Object(Z.a)(me.a.root,a),onClick:this.handleClick},t)}}]),s}(d.a.Component);babelHelpers.defineProperty(fe,"propTypes",{isExpanded:G.bool.isRequired,setRoute:G.func.isRequired,resetPush:G.func,children:G.any.isRequired,className:G.string});var ge=Object(i.b)(null,{resetPush:r.reset,setRoute:F.m.setRoute})(fe),ye=a(4770),Ie=a(694),Ce=function(e){function s(){var e,t;babelHelpers.classCallCheck(this,s);for(var a=arguments.length,n=new Array(a),r=0;r<a;r++)n[r]=arguments[r];return t=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(n))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handleChannelSelect",function(e){t.props.setRoute({route:V.b.CHANNEL,params:{channelId:e}})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"playSoundThrottled",oe()(function(){t.soundAudio&&t.soundAudio.play()},250)),t}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidMount",value:function(){this.soundAudio=!1,(0,this.props.resetPush)()}},{key:"componentDidUpdate",value:function(e){var t=this.props;t.channelId&&t.channelId!==e.channelId&&le()(t,"lastChannel.channelId")!==t.channelId?this.playSoundThrottled():t.messageId&&t.messageId!==e.messageId&&this.playSoundThrottled()}},{key:"render",value:function(){var e=this.props.typingTimestamp,t=this.getChannelForPush(),a=Boolean(t),n=Object(Z.a)(W.a.root,babelHelpers.defineProperty({},W.a.root_withPush,a));return d.a.createElement("div",{className:n},d.a.createElement(ge,{isExpanded:a,className:W.a.header},a?d.a.createElement(he,{isExpanded:!0,top:12,right:16}):d.a.createElement(he,{hidePageAppLink:!0,expanderClassName:W.a.togglerExpander,top:2,right:8}),d.a.createElement(ae,{noAccent:!a})),a&&d.a.createElement(l.Fragment,null,d.a.createElement(re.b,{channel:t,lastMessage:t.lastMessage,onSelect:this.handleChannelSelect,typingTimestamp:e}),d.a.createElement(ye.a,{users:t.users})))}},{key:"resolveAudioInterface",value:function(){var t;try{(t=new Audio).preload="auto",t.canPlayType("audio/ogg"),t.setAttribute("src",null)}catch(e){t={play:function(){}}}return t}},{key:"getChannelForPush",value:function(){var e=this.props,t=e.messageId,a=e.lastMessage,n=e.lastChannel;return t&&a&&a.id===t?n:null}}]),s}(d.a.Component);babelHelpers.defineProperty(Ce,"propTypes",{lastMessage:G.object,channelId:G.string,messageId:G.string,setRoute:G.func.isRequired,resetPush:G.func.isRequired,lastChannel:G.object,typingTimestamp:G.number});var ve=Object(i.b)(function(e){return{lastMessage:le()(e.channels,"list[0].lastMessage"),lastChannel:le()(e.channels,"list[0]"),channelId:e.push.channelId,messageId:e.push.messageId,typingTimestamp:e.eventsChatTyping[e.push.channelId]}},{setRoute:F.m.setRoute,resetPush:r.reset})(Object(Ie.a)(Ce,Ie.a.Screen.PUSH,Ie.a.App.MINI)),He=a(501),Ee=a(6033),Oe=Ee.a.date.getRelativeRules().map(function(e){return"today"===e.rule&&(e.output="В %H:%MM"),e});function Pe(e){var t=e.className,a=e.lastActionTime,n=e.timeCorrectionOffset,r=e.online,s=e.marker;if(!a)return null;var l=function(e,t){return e?1e3*e+t:0}(a,n),i=1e3<l-Date.now();return r||i?null:d.a.createElement("time",{"data-marker":s,className:t,dateTime:new Date(l).toISOString()},function(e){return 31<((new Date).setHours(0,0,0,0)-new Date(e).setHours(0,0,0,0))/864e5?"был(а) более месяца назад":"был(а) в сети ".concat(Ee.a.date.customRelative(Oe,e).toLowerCase())}(l))}Pe.propTypes={className:G.string,online:G.bool,timeCorrectionOffset:G.number,lastActionTime:G.number,marker:G.string};function Ne(e){var t=e.online,a=e.timeCorrectionOffset,n=e.lastActionTime,r=e.typingTimestamp,s=e.isMiniMode,l=e.marker;return d.a.createElement(ke.a,{eventTimestamp:r,actualityTime:Re.c},function(e){return e?t?d.a.createElement("div",{"data-marker":l,className:Object(Z.a)(Se.a.online,babelHelpers.defineProperty({},Se.a.online_miniMode,s))},d.a.createElement("div",{className:Se.a.onlineIndicator}),d.a.createElement("span",{className:Se.a.onlineText},"В сети")):d.a.createElement(Pe,{className:Se.a.text,marker:l,timeCorrectionOffset:a,lastActionTime:n,online:t}):d.a.createElement("div",{"data-marker":l,className:Se.a.typings},"печатает  ",d.a.createElement(Te.a,null))})}var ke=a(566),Re=a(433),Te=a(4783),Ae=a(479),je=a(5882),Se=a.n(je);Ne.propTypes={online:G.bool,timeCorrectionOffset:G.number,lastActionTime:G.number,typingTimestamp:G.number,isMiniMode:G.bool,marker:G.string};var Me=Object(i.b)(function(e){return{isMiniMode:e.system.appName===Ae.a.MINI}})(Ne),Le=a(447),xe=a(546),we=a(571),qe=a(431),Ue=a.n(qe),_e=a(5883),De=a.n(_e),ze=function(e){function r(){var e,i;babelHelpers.classCallCheck(this,r);for(var t=arguments.length,a=new Array(t),n=0;n<t;n++)a[n]=arguments[n];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(r)).call.apply(e,[this].concat(a))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleProfileLinkClick",function(){var e=i.props,t=e.appName,a=e.userId,n=e.profileUserId,r=e.channelId,s=e.itemId,l=e.itemOwnerId;n&&ce.a.profileClick({userId:a,channelId:r,appName:t,itemId:s,itemOwnerId:l,profileUserId:n})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleBackButtonClick",function(e){e.stopPropagation(),i.props.setRoute({route:V.b.CHANNELS})}),i}return babelHelpers.inherits(r,e),babelHelpers.createClass(r,[{key:"render",value:function(){var e=this.props,t=e.interlocutors,a=e.typingTimestamp,n=e.timeCorrectionOffset,r=e.name,s=e.status,l=e.link,i=Boolean(le()(l,"url"))?Object(V.c)(le()(l,"url")):null,o=Ue()(s),c=o&&Object(Le.e)(t),u=o?Object(Le.d)(t):null,p=d.a.createElement($.a,{size:"l"},r);return d.a.createElement("div",{className:De.a.root},d.a.createElement("div",{"data-marker":Object(xe.a)("navigation","back"),className:De.a.backButton,onClick:this.handleBackButtonClick}),d.a.createElement("div",{className:De.a.info},i?d.a.createElement(we.a,{marker:Object(xe.a)("channelHeader","name"),onClick:this.handleProfileLinkClick,className:De.a.name,href:i},p):d.a.createElement("span",{"data-marker":Object(xe.a)("channelHeader","name"),className:De.a.name},p),s?d.a.createElement("div",{"data-marker":Object(xe.a)("channelHeader","status"),className:De.a.status},s):d.a.createElement(Me,{typingTimestamp:a,online:c,lastActionTime:u,timeCorrectionOffset:n})))}}]),r}(d.a.Component);babelHelpers.defineProperty(ze,"propTypes",{appName:G.string.isRequired,userId:G.number,channelId:G.string,itemId:G.number,itemOwnerId:G.number,typingTimestamp:G.number,timeCorrectionOffset:G.number,setRoute:G.func.isRequired,interlocutors:G.array.isRequired,name:G.string,status:G.string,link:G.object,profileUserId:G.number});var Fe=Object(He.a)("ChannelHeader",Object(i.b)(function(e){return{appName:e.system.appName,userId:e.system.userId,channelId:le()(e,"channel.channel.channelId"),itemId:le()(e,"channel.channel.context.value.id"),itemOwnerId:le()(e,"channel.channel.context.value.userId"),interlocutors:Object(Le.c)(e,le()(e,"channel.channel.users")),typingTimestamp:e.eventsChatTyping[e.router.params.channelId],timeCorrectionOffset:e.system.timeCorrectionOffset,name:le()(e,"channel.channel.info.name"),status:le()(e,"channel.channel.info.status"),link:le()(e,"channel.channel.info.link"),profileUserId:le()(e,"channel.channel.info.userId")}},{setRoute:F.m.setRoute})(ze)),Be=a(559),Ve=a(4785),Ge=a(5884),Ke=a.n(Ge),We=function(e){function s(){var e,n;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(a))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"state",{isPopupVisible:!1}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleItemLinkClick",function(){var e=n.props,t=e.channelId,a=e.userId;ce.a.itemNavigate({userId:a,channelId:t})}),n}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"render",value:function(){var e=this.props,t=e.itemImages,a=e.itemTitle,n=e.price,r=e.priceString,s=e.dealAction,l=e.itemUrl,i=Object(V.c)(l),o=n?r:null;return d.a.createElement("div",{"data-marker":Object(xe.a)("channelItem"),className:Ke.a.root},d.a.createElement("div",{className:Ke.a.dynamicLayout},d.a.createElement(we.a,{className:Ke.a.title,title:a,href:i,onClick:this.handleItemLinkClick},d.a.createElement($.a,{size:"xs"},a)),d.a.createElement("div",{className:Ke.a.price},o),d.a.createElement(Ve.a,{dealAction:s,isMiniMode:!0})),d.a.createElement(Be.a,{images:t,link:i,width:60,height:40,onClick:this.handleItemLinkClick}))}}]),s}(d.a.Component);babelHelpers.defineProperty(We,"propTypes",{itemImages:G.object,itemTitle:G.string,channelId:G.string,userId:G.number,price:G.number,priceString:G.string,dealAction:G.object,itemUrl:G.string});var Je=Object(He.a)("ChannelItem",Object(i.b)(function(e){return{itemTitle:le()(e.channel,"channel.context.value.title"),itemUrl:le()(e.channel,"channel.context.value.urlPath"),price:le()(e.channel,"channel.context.value.price"),priceString:le()(e.channel,"channel.context.value.priceString"),itemImages:le()(e.channel,"channel.context.value.images.main"),channelId:le()(e.channel,"channel.channelId"),userId:e.system.userId,dealAction:le()(e.channel,"channel.dealAction")}})(We)),Qe=a(5943),Xe=a(6032),Ye=a(502),Ze=a(4791),$e=a(6210),et=a(4781),tt=a(390),at=a(5885),nt=a.n(at),rt=function(e){function s(){var e,n;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(a))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleImageUpload",function(e){var t=n.props,a=t.loadedChannelId;(0,t.uploadImage)(a,e).then(n.sendImageMessage)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"sendImageMessage",function(e){if(!n.imageUploadStateHasTruthyFlag("failed")){var t=n.props,a=t.loadedChannelId;(0,t.sendImageMessage)(a,Object.keys(e)[0])}}),n}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidUpdate",value:function(e){e.paramsChannelId!==this.props.paramsChannelId&&s.fetchInitialData(this.props)}},{key:"componentWillUnmount",value:function(){this.props.resetMessages(),this.props.resetChannel()}},{key:"render",value:function(){var e=this.props,t=e.loadedChannelId,a=e.fetching,n=e.users,r=e.channel,s=e.isPhoneVisible,l=Object(tt.h)(r),i=Object(Z.a)(nt.a.root,babelHelpers.defineProperty({},nt.a.root_system,l));return!t||a?d.a.createElement("div",{className:i},d.a.createElement(Ye.a,null)):d.a.createElement("div",{className:i},d.a.createElement(ye.a,{users:n}),d.a.createElement(ge,{isExpanded:!0,className:nt.a.header},d.a.createElement(he,{isExpanded:!0}),d.a.createElement(Fe,null)),!l&&d.a.createElement("div",{className:nt.a.item},d.a.createElement(Je,null)),d.a.createElement("div",{className:nt.a.messages},d.a.createElement(Qe.b,{channel:r,isChannelFetching:a,onSendImageMessage:this.sendImageMessage}),d.a.createElement(Ze.a,null,s&&d.a.createElement(et.a,{type:$e.a.SHOW_NUMBER,fromReplyTime:!0}))),this.renderReadonlyCause(),d.a.createElement("div",{className:nt.a.reply},this.renderReply(l)))}},{key:"renderReply",value:function(e){return this.props.isReadOnly?null:d.a.createElement(Xe.a,{isSystemChat:e,onImageUpload:this.handleImageUpload})}},{key:"renderReadonlyCause",value:function(){var e=this.props,t=e.readOnlyDescription,a=e.isReadOnly,n=e.paths,r=e.channel;if(!a)return null;var s=Object(tt.f)(r),l=Object(V.c)(Object(V.d)({route:V.b.BLACKLIST,paths:n}));return d.a.createElement("div",{"data-marker":Object(xe.a)("readOnly"),className:nt.a.readOnly},d.a.createElement($.a,{size:"xs"},s?"Вы заблокировали пользователя. ":t),s&&d.a.createElement(we.a,{noVisited:!0,marker:Object(xe.a)("readOnly","link"),href:l},"Перейти к заблокированным"))}},{key:"imageUploadStateHasTruthyFlag",value:function(e){var t=this.props,a=t.loadedChannelId,n=t.upload;return n.hasOwnProperty(a)&&n[a][e]}}],[{key:"fetchInitialData",value:function(e){return(0,e.getChannelInitialData)({channelId:e.paramsChannelId},{isApiFetchEvent:!0})}}]),s}(d.a.Component);babelHelpers.defineProperty(rt,"propTypes",{paramsChannelId:G.string.isRequired,resetMessages:G.func.isRequired,resetChannel:G.func.isRequired,loadedChannelId:G.string,readOnlyDescription:G.string,fetching:G.bool,isReadOnly:G.bool,isPhoneVisible:G.bool,sendImageMessage:G.func.isRequired,uploadImage:G.func.isRequired,upload:G.object.isRequired,userId:G.number.isRequired,users:G.array,channel:G.object.isRequired,getChannelInitialData:G.func.isRequired,isListFetched:G.bool.isRequired,paths:G.object.isRequired});var st=Object(i.b)(function(e){return{fetching:e.channel.fetching,paramsChannelId:e.router.params.channelId,paths:e.router.paths,loadedChannelId:e.channel.channel.channelId,upload:e.upload,isReadOnly:Boolean(le()(e.channel,"channel.readOnly")),readOnlyDescription:le()(e.channel,"channel.readOnly.description"),userId:e.system.userId,users:le()(e.channel,"channel.users"),list:e.channels.list,isPhoneVisible:!le()(e,"channel.channel.context.value.hidePhone",!1),isListFetched:e.channels.isListFetched,channel:e.channel.channel,isChatHasDraftMessage:Boolean(le()(e.draftMessages.hash,[e.channel.channelId,"text"]))}},{sendImageMessage:F.i.sendImageMessage,uploadImage:F.p.uploadImage,resetMessages:F.i.reset,resetChannel:F.e.reset,getChannelInitialData:F.e.getChannelInitialData})(Object(Ie.a)(rt,Ie.a.Screen.CHANNEL,Ie.a.App.MINI,function(e,t){if(!t.isError){var a=e.loadedChannelId,n=e.userId,r=e.list,s=e.isListFetched,l=e.isChatHasDraftMessage,i=r.findIndex(function(e){return e.channelId===a})+1;ce.a.channelShow({channelId:a,userId:n,source:"mini_messenger",channelNumber:s?i:void 0}),l&&ce.a.channelWithDraftOpen({userId:n,channelId:a})}})),lt=a(6048),it=a(6209),ot=a(5886),ct=a.n(ot),ut=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props,t=e.previousRoute,a=e.phoneVerifyItemId,n=e.defaultFilters,r=this.list,s=Object(Z.a)(ct.a.root,babelHelpers.defineProperty({},ct.a.root_expand,t===V.b.PUSH));return d.a.createElement("div",{className:s},d.a.createElement(ye.a,{users:Object(Le.b)(r)}),d.a.createElement(ge,{isExpanded:!0,className:ct.a.header},d.a.createElement(he,{isExpanded:!0}),d.a.createElement(ae,{isTogglerExpanded:!0})),d.a.createElement("div",{className:ct.a.list},d.a.createElement(it.a,{list:r,filters:n,className:ct.a.scroll})),a&&d.a.createElement(lt.a,{itemId:a}))}},{key:"list",get:function(){var e=this.props,t=e.channelsList,a=e.emptyChannels,n=e.canLoadMore,r=e.fetching;return Object(tt.e)({list:t,fetching:r,emptyChannels:a,canLoadMore:n})}}],[{key:"fetchInitialData",value:function(e){return(0,e.getChannels)({filters:e.defaultFilters},{isApiFetchEvent:!0})}}]),t}(d.a.Component);babelHelpers.defineProperty(ut,"propTypes",{fetching:G.bool,channelsList:G.array.isRequired,canLoadMore:G.bool,defaultFilters:G.object,getChannels:G.func.isRequired,previousRoute:G.string,phoneVerifyItemId:G.number,emptyChannels:G.array.isRequired,userId:G.number.isRequired});var pt,dt=Object(i.b)(function(e){return{previousRoute:le()(e.router,"previousState.route"),fetching:e.channels.fetching,channelsList:e.channels.list,canLoadMore:e.channels.canLoadMore,defaultFilters:e.options.defaultFilters,userId:e.system.userId,phoneVerifyItemId:e.router.query.create_chat,emptyChannels:e.draftMessages.emptyChannels}},{getChannels:F.f.getChannels})(Object(Ie.a)(ut,Ie.a.Screen.CHANNELS,Ie.a.App.MINI,function(e,t){if(!t.isError){var a=e.userId,n=Object(tt.d)(Object(xe.a)("channels","list"),Object(xe.a)("channels","channel"));ce.a.channelsShow({userId:a,source:"mini_messenger",channelsScreenCount:n})}})),ht=(pt={},babelHelpers.defineProperty(pt,V.b.PUSH,{component:ve}),babelHelpers.defineProperty(pt,V.b.CHANNEL,{path:V.a.CHANNEL,component:st}),babelHelpers.defineProperty(pt,V.b.CHANNELS,{path:V.a.CHANNELS,component:dt}),babelHelpers.defineProperty(pt,V.b.BLACKLIST,{path:V.a.BLACKLIST}),pt),bt=a(495),mt=a(5887),ft=a.n(mt),gt=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e,t=V.b.PUSH,a=this.props,n=a.userId,r=a.children,s=a.isAuthorized,l=a.previousRoute,i=a.route,o=Object(Z.a)(ft.a.content,(e={},babelHelpers.defineProperty(e,ft.a.content_fit,i===t),babelHelpers.defineProperty(e,ft.a.content_expand,i!==t&&l===t),babelHelpers.defineProperty(e,ft.a.content_collapse,i===t&&l&&l!==t),e));return n&&s?d.a.createElement("div",{className:o},d.a.createElement(bt.a,null,r)):null}}]),t}(d.a.Component);babelHelpers.defineProperty(gt,"propTypes",{children:G.element.isRequired,userId:G.number,isAuthorized:G.bool,previousRoute:G.string,route:G.string});var yt=Object(i.b)(function(e){return{userId:e.system.userId,isAuthorized:e.system.isAuthorized,previousRoute:le()(e.router,"previousState.route"),route:e.router.route}})(gt),It=a(141),Ct=a.n(It),vt=a(424);a.d(t,"b",function(){return Ot}),a.d(t,"a",function(){return Pt});var Ht=null,Et=F.m.setRoute,Ot={openChannel:function(e){Ht.dispatch(Et({route:V.b.CHANNEL,params:{channelId:e}}))},verifyPhone:function(e){Ht.dispatch(Et({route:V.b.CHANNELS,query:{create_chat:e}}))}},Pt=function(e){function a(e){var t;return babelHelpers.classCallCheck(this,a),t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(a).call(this,e)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"store",Object(o.a)("MINI_MESSENGER",{router:{route:V.b.PUSH,paths:z()(ht,"path")},system:{appName:Ae.a.MINI,appVersion:vt.version,isTabActive:!document.hidden}},n,Object(B.a)({appName:Ae.a.MINI,updateChatsCounter:Ct.a.get("updateChatsCounter"),getTransport:b.a.getTransport,getApiLogs:b.a.getLogs,getItems:F.i.getItems,getImages:F.i.getImages}))),_()(x.a,q.a.registerContextApp),Ht=t.store,t}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"render",value:function(){return d.a.createElement(i.a,{store:this.store},d.a.createElement(yt,null,d.a.createElement(L.a,{routerConfig:ht})))}}]),a}(l.Component)}}]);