(window.webpackJsonp=window.webpackJsonp||[]).push([["e5ba57c5"],{2393:function(e,t){e.exports={ITEM_OWNER_STATUS_URL:"/web/user/get-status",CODE_REQUEST_URL:"/code/request",CODE_CONFIRM_URL:"/code/confirm"}},2394:function(e,t,r){"use strict";r.d(t,"a",function(){return n});var a="undefined"==typeof window,n=function(){function n(e){var t=this,r=e.isMobile;babelHelpers.classCallCheck(this,n),babelHelpers.defineProperty(this,"counter",null),babelHelpers.defineProperty(this,"goalsQueue",[]),babelHelpers.defineProperty(this,"onDocumentLoaded",function(){t.initCounterInstance(),t.goalsQueue.forEach(function(e){return t.reachGoal.apply(t,babelHelpers.toConsumableArray(e))}),t.goalsQueue=[]}),this.isMobile=r,a||("complete"===window.document.readyState?this.initCounterInstance():window.addEventListener("load",this.onDocumentLoaded))}return babelHelpers.createClass(n,[{key:"reachGoal",value:function(e,t){this.counter?this.counter.reachGoal(e,t):"complete"!==window.document.readyState&&this.goalsQueue.push(arguments)}},{key:"initCounterInstance",value:function(){var e=this.isMobile?24618824:34241905;this.counter=window["yaCounter"+e]||null}},{key:"messageButtonShow",value:function(e){this.reachGoal(this.isMobile?40162780:40162666,{replyTimeText:e})}},{key:"channelOpen",value:function(e,t){this.reachGoal(this.isMobile?40115401:40115014,{replyTimeText:e,isMyItem:t})}},{key:"messageSend",value:function(e,t,r){this.reachGoal(this.isMobile?40115407:40113364,{replyTimeText:e,isMyItem:t,isFirstMessage:r})}},{key:"unsupportedWS",value:function(){this.reachGoal("unsupportedWS")}}]),n}()},2395:function(e,t,r){var n=r(2396);e.exports=function(e){return n(2,e)}},2396:function(e,t,r){var n=r(221);e.exports=function(e,t){var r;if("function"!=typeof t)throw new TypeError("Expected a function");return e=n(e),function(){return 0<--e&&(r=t.apply(this,arguments)),e<=1&&(t=void 0),r}}},2687:function(e,t,r){"use strict";r.d(t,"a",function(){return u}),r.d(t,"b",function(){return c}),r.d(t,"c",function(){return l}),r.d(t,"d",function(){return o});var n=r(2688);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function s(e,t){return t?n.a.fps(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({event:e},t)):Promise.resolve()}function i(){var n,a=[],t=Date.now(),s=0,i=!0;return requestAnimationFrame(function e(t){if(n){var r=t-n;50<r&&a.push(r)}s++,n=t,i&&requestAnimationFrame(e)}),function(){var e=Date.now();return i=!1,function(e,t,r){var n=e.sort(function(e,t){return t-e});return 3<n.length?{interval:r,avgFps:t/r*1e3,avgFrame:r/t,avgBigFrame:n.reduce(function(e,t){return e+t})/n.length,minFrame:n[n.length-1],percentile90Frame:n[Math.floor(n.length/10)],percentile99Frame:n[Math.floor(n.length/100)],percentile50Frame:n[Math.floor(n.length/2)],percentile10Frame:n[Math.floor(n.length-n.length/10)],updates:t,biggestFrame1:n[0],biggestFrame2:n[1],biggestFrame3:n[2],bigFrameSummary:n.reduce(function(e,t){return e+t}),bigFrameCount:n.length}:null}(a,s,e-t)}}var o=function(){var t,r;document.addEventListener("scroll",function(){t?clearTimeout(t):r=i(),t=setTimeout(function(){t=null;var e=r();s("scroll",e)},300)})},l=function e(t){var r=0<arguments.length&&void 0!==t?t:0,n=i();setTimeout(function(){s("permanently",n()),r<3&&e(r+1)},3e4)},c=function(){return new Promise(function(e){var t=i();window.addEventListener("load",function(){s("load",t()),e()})})},u=function(e){var t=i();return function(){return s(e||"custom",t())}}},2688:function(e,t,r){"use strict";function n(t,e){var r=1<arguments.length&&void 0!==e?e:1;return function(e){return fetch(s+"/api/".concat(r,"/stats/frontend/")+t,{method:"POST",body:JSON.stringify(function(e){var t=window.avito||{},r=t.pageId,n=t.platform;return{data:e,meta:{connection:Object(a.a)(),page:r||"unknown",platform:n||"unknown"}}}(e))}).catch(function(){})}}var a=r(6171),s=window.avito&&window.avito.statsHost&&window.avito.statsHost||"",i=n("fps"),o=n("load");t.a={fps:i,load:o}},2689:function(e,t,r){"use strict";r.d(t,"a",function(){return n}),r.d(t,"b",function(){return a});var n=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},s=1<arguments.length?arguments[1]:void 0;return Object.entries(e).reduce(function(e,t){var r=babelHelpers.slicedToArray(t,2),n=r[0],a=r[1];return e[n]=s(a,n),e},{})},a=function(e,t,r,n){var a=1<arguments.length&&void 0!==t?t:Object.keys(e[0]||{}),s=2<arguments.length?r:void 0,i=3<arguments.length?n:void 0;return e.reduce(function(e,r){return a.reduce(function(e,t){return!e[t]&&i&&i[t]&&(e[t]=i[t]),e[t]?e[t]=s(e[t],r[t]):e[t]=r[t],e},e)},{})}},2694:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n,a=r(742),s=r.n(a),i="last-ref-id",o=window.location.origin;window.performance&&window.performance.navigation&&1===window.performance.navigation.type||(n=o,window.document.referrer&&window.document.referrer.startsWith(n))||window.localStorage.removeItem(i),window.sessionStorage.tabId=window.sessionStorage.tabId||s()();var l=window.sessionStorage.tabId,c=function(){var e=window.localStorage.getItem(i),t=s()();return window.localStorage.setItem(i,t),{refId:t,parentRefId:e,tabId:l}};function u(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:"/clickstream/events/0/json";for(var r in e)e.hasOwnProperty(r)&&null===e[r]&&(e[r]=void 0);var n=c(),a=n.refId,s=n.parentRefId,i=n.tabId;return e.ref_id=a||"",e.parent_ref_id=s||"",e.tab_id=i||"",fetch(t,{method:"post",headers:{"Content-type":"application/json; charset=UTF-8","X-Requested-With":"XMLHttpRequest"},credentials:"include",body:JSON.stringify(e)}).then(function(e){return 400<=e.status?Promise.reject(e):{response:e,refId:a,parentRefId:s,tabId:i}})}},43:function(e,t,r){"use strict";t.__esModule=!0,t.connect=t.Provider=void 0;var n=s(r(44)),a=s(r(50));function s(e){return e&&e.__esModule?e:{default:e}}t.Provider=n.default,t.connect=a.default},44:function(e,t,r){"use strict";t.__esModule=!0,t.default=void 0;var n=r(35),a=i(r(45)),s=i(r(48));i(r(49));function i(e){return e&&e.__esModule?e:{default:e}}var o,l=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(c,o=n.Component),c.prototype.getChildContext=function(){return{store:this.store}},c.prototype.render=function(){return n.Children.only(this.props.children)},c);function c(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,o.call(this,e,t));return r.store=e.store,r}(t.default=l).propTypes={store:s.default.isRequired,children:a.default.element.isRequired},l.childContextTypes={store:s.default.isRequired}},4671:function(e,t,r){"use strict";var s=r(4672),n=r(336),i=r.n(n);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var l={channel:{},channelId:null,fetching:!1,error:!1};t.a=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:l,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case s.a.CHANNEL_RESET:return l;case s.a.CHANNEL_INITIAL_REQUEST:return o({},l,{fetching:!0,channelId:t.channelId,error:!1});case s.a.CHANNEL_INITIAL_REQUEST_FAIL:return o({},e,{fetching:!1,error:!0});case s.a.CHANNEL_REQUEST_SUCCESS:return t.channel.channelId!==e.channelId?e:o({},e,{fetching:!1,channel:t.channel});case s.a.EVENTS_CHANNELS_UPDATE:var r=i()(t,"response.channels",{}),n=i()(e,"channel.channelId");return r.hasOwnProperty(n)?o({},e,{channel:o({},e.channel,{},r[n])}):e;case s.a.BLACKLIST_REMOVE_USER_REQUEST_SUCCESS:return o({},e,{channel:o({},e.channel,{readOnly:!1})});case s.a.CHANNEL_READ_REQUEST_SUCCESS:if(e.channel.channelId!==t.channelId)return e;var a=i()(e,"channel.lastMessage");return o({},e,{channel:o({},e.channel,{lastMessage:a?a.assign({isRead:!0}):null,isRead:!0})});default:return e}}},4672:function(e,t,r){"use strict";var n,a=r(377),s=r(378),i=Object(s.a)((n={},babelHelpers.defineProperty(n,a.a.EVENTS_MESSAGE,null),babelHelpers.defineProperty(n,a.a.EVENTS_CHANNELS_UPDATE,null),babelHelpers.defineProperty(n,a.a.EVENTS_BLACKLIST_ADDED,null),babelHelpers.defineProperty(n,a.a.EVENTS_CHAT_REMOVED,null),babelHelpers.defineProperty(n,a.a.EVENTS_MESSAGES_READ,null),babelHelpers.defineProperty(n,a.a.EVENTS_MESSAGES_DELIVERED,null),babelHelpers.defineProperty(n,a.a.EVENTS_CHAT_READ,null),babelHelpers.defineProperty(n,a.a.EVENTS_CHAT_DELIVERED,null),babelHelpers.defineProperty(n,a.a.APP_ACTIVE_CHANGE,null),babelHelpers.defineProperty(n,a.a.MESSAGE_IMAGE_SEND,null),babelHelpers.defineProperty(n,a.a.MESSAGE_IMAGE_SEND_SUCCESS,null),babelHelpers.defineProperty(n,a.a.MESSAGE_IMAGE_SEND_FAIL,null),babelHelpers.defineProperty(n,a.a.MESSAGE_LINK_SEND,null),babelHelpers.defineProperty(n,a.a.MESSAGE_LINK_SEND_SUCCESS,null),babelHelpers.defineProperty(n,a.a.MESSAGE_LINK_SEND_FAIL,null),babelHelpers.defineProperty(n,a.a.MESSAGE_LOCATION_SEND,null),babelHelpers.defineProperty(n,a.a.MESSAGE_LOCATION_SEND_SUCCESS,null),babelHelpers.defineProperty(n,a.a.MESSAGE_LOCATION_SEND_FAIL,null),babelHelpers.defineProperty(n,a.a.CHANNEL_RESET,null),babelHelpers.defineProperty(n,a.a.CHANNEL_REQUEST,null),babelHelpers.defineProperty(n,a.a.CHANNEL_REQUEST_FAIL,null),babelHelpers.defineProperty(n,a.a.CHANNEL_REQUEST_SUCCESS,null),babelHelpers.defineProperty(n,a.a.MESSAGE_ITEM_SEND,null),babelHelpers.defineProperty(n,a.a.MESSAGE_ITEM_SEND_FAIL,null),babelHelpers.defineProperty(n,a.a.MESSAGE_ITEM_SEND_SUCCESS,null),babelHelpers.defineProperty(n,a.a.CHANNELS_REQUEST,null),babelHelpers.defineProperty(n,a.a.CHANNELS_REQUEST_FAIL,null),babelHelpers.defineProperty(n,a.a.CHANNELS_REQUEST_SUCCESS,null),babelHelpers.defineProperty(n,a.a.CHANNEL_READ_REQUEST,null),babelHelpers.defineProperty(n,a.a.CHANNEL_READ_REQUEST_FAIL,null),babelHelpers.defineProperty(n,a.a.CHANNEL_READ_REQUEST_SUCCESS,null),babelHelpers.defineProperty(n,a.a.MESSAGE_SEND,null),babelHelpers.defineProperty(n,a.a.MESSAGE_SEND_FAIL,null),babelHelpers.defineProperty(n,a.a.MESSAGE_SEND_SUCCESS,null),babelHelpers.defineProperty(n,a.a.CHANNELS_GET_COUNTERS,null),babelHelpers.defineProperty(n,a.a.CHANNELS_GET_COUNTERS_SUCCESS,null),babelHelpers.defineProperty(n,a.a.CHANNELS_GET_COUNTERS_FAIL,null),babelHelpers.defineProperty(n,a.a.CHANNEL_INITIAL_REQUEST,null),babelHelpers.defineProperty(n,a.a.CHANNEL_INITIAL_REQUEST_SUCCESS,null),babelHelpers.defineProperty(n,a.a.CHANNEL_INITIAL_REQUEST_FAIL,null),babelHelpers.defineProperty(n,a.a.BLACKLIST_ADD_USERS_REQUEST,null),babelHelpers.defineProperty(n,a.a.BLACKLIST_ADD_USERS_REQUEST_FAIL,null),babelHelpers.defineProperty(n,a.a.BLACKLIST_ADD_USERS_REQUEST_SUCCESS,null),babelHelpers.defineProperty(n,a.a.BLACKLIST_REMOVE_USER_REQUEST,null),babelHelpers.defineProperty(n,a.a.BLACKLIST_REMOVE_USER_REQUEST_FAIL,null),babelHelpers.defineProperty(n,a.a.BLACKLIST_REMOVE_USER_REQUEST_SUCCESS,null),babelHelpers.defineProperty(n,a.a.BLACKLIST_TOOLTIP_HIDE,null),babelHelpers.defineProperty(n,a.a.CHANNELS_REMOVE_REQUEST_SUCCESS,null),babelHelpers.defineProperty(n,a.a.CHANNELS_SET_COUNTERS,null),babelHelpers.defineProperty(n,a.a.MESSAGE_CONFIRM_SUSPECT_REQUEST_SUCCESS,null),babelHelpers.defineProperty(n,"FILTER_ITEMS_REQUEST",null),babelHelpers.defineProperty(n,"FILTER_ITEMS_REQUEST_FAIL",null),babelHelpers.defineProperty(n,"FILTER_ITEMS_REQUEST_SUCCESS",null),babelHelpers.defineProperty(n,"FILTER_ITEMS_RESET",null),n));t.a=i},4673:function(e,t,r){"use strict";var s=r(377);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var o={};t.a=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:o,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case s.a.EVENTS_CHAT_TYPING:var r=t.response.channelId;return i({},e,babelHelpers.defineProperty({},r,Number(new Date)));case s.a.EVENTS_MESSAGE:var n=babelHelpers.slicedToArray(t.messages,1)[0].channelId,a=i({},e);return delete a[n],a;default:return e}}},4674:function(e,t,r){"use strict";var a=r(377);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var i={error:null,loading:!1,list:[],firstQueryTotal:0,firstQuerySuccess:!1,canLoadMore:!0};t.a=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:i,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case a.a.ATTACH_ITEMS_REQUEST:return s({},e,{list:0===t.offset?[]:e.list,loading:!0,request:t.timestamp,canLoadMore:!0});case a.a.ATTACH_ITEMS_REQUEST_FAIL:return e.request!==t.timestamp?e:s({},e,{error:t.error,list:[],loading:!1});case a.a.ATTACH_ITEMS_REQUEST_SUCCESS:if(e.request!==t.timestamp)return e;var r=t.response.result,n=[].concat(babelHelpers.toConsumableArray(e.list),babelHelpers.toConsumableArray(r));return s({},e,{list:n,firstQueryTotal:e.firstQueryTotal||n.length,loading:!1,firstQuerySuccess:!0,canLoadMore:r.length===t.limit});case a.a.ATTACH_ITEMS_RESET:return i;default:return e}}},4675:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var s=r(377);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var o={filesBackup:{}};function a(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:o,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case s.a.IMAGE_UPLOAD:return i({},e,babelHelpers.defineProperty({filesBackup:i({},e.filesBackup,babelHelpers.defineProperty({},t.id,t.formData))},t.channelId,{fetching:!0,failed:!1}));case s.a.IMAGE_UPLOAD_SUCCESS:var r=i({},e.filesBackup);return delete r[t.id],i({},e,babelHelpers.defineProperty({filesBackup:r},t.channelId,{fetching:!1,failed:!1}));case s.a.IMAGE_UPLOAD_FAIL:return i({},e,babelHelpers.defineProperty({},t.channelId,{fetching:!1,failed:!0}));case s.a.MESSAGE_TEMP_REMOVE:var n=t.messageId;if(!e.filesBackup.hasOwnProperty(n))return e;var a=i({},e.filesBackup);return delete a[n],i({},e,{filesBackup:a});case s.a.IMAGE_UPLOAD_RESET:return o;default:return e}}},4676:function(e,t,r){"use strict";var n=r(377),a=r(4677),s=r.n(a),i=r(336),o=r.n(i);function l(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?l(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):l(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var u={defaultFilters:void 0};t.a=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:u,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case n.a.EVENTS_OPTIONS_UPDATE:return c({},e,{},s()(t.response.value,Object.keys(u)));case n.a.EVENTS_SESSION:return c({},e,{defaultFilters:o()(t.response,"options.defaultFilters")});default:return e}}},4677:function(e,t,r){var n=r(4678),a=r(354)(function(e,t){return null==e?{}:n(e,t)});e.exports=a},4678:function(e,t,r){var n=r(4679),a=r(347);e.exports=function(r,e){return n(r,e,function(e,t){return a(r,t)})}},4679:function(e,t,r){var l=r(337),c=r(414),u=r(338);e.exports=function(e,t,r){for(var n=-1,a=t.length,s={};++n<a;){var i=t[n],o=l(e,i);r(o,i)&&c(s,u(i,e),o)}return s}},4680:function(e,t,r){"use strict";var n=r(377);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function s(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var i={hash:{}};t.a=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:i,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case n.a.GEO_MESSAGES_MARKERS_SUCCESS:return s({},e,{hash:s({},e.hash,babelHelpers.defineProperty({},t.chunkId,t.response.result))});case n.a.GEO_MESSAGES_MARKERS_SET:return s({},e,{hash:s({},e.hash,babelHelpers.defineProperty({},t.chunkId,t.markers))});default:return e}}},4681:function(e,t,r){"use strict";var C=r(377),n=r(336),E=r.n(n),a=r(436),S=r.n(a),P=r(390);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function O(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var I={hash:{},emptyChannels:[]};t.a=function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:I,i=1<arguments.length?arguments[1]:void 0;switch(i.type){case C.a.SET_DRAFT_MESSAGES:var t=i.draftMessages,r=t.hash,n=t.emptyChannels;return{hash:r,emptyChannels:Object(P.b)(n||[])};case C.a.MESSAGE_DRAFT:var a=i.text,s=i.channelId,o=i.interlocutorId;return O({},e,{hash:O({},e.hash,babelHelpers.defineProperty({},s,a?{text:a,userId:o}:void 0))});case C.a.MESSAGE_SEND:var l=i.channelId;return O({},e,{hash:O({},e.hash,babelHelpers.defineProperty({},l,void 0))});case C.a.CHANNEL_REQUEST_SUCCESS:var c=i.channel,u=Boolean(c.lastMessage),p=Boolean(e.emptyChannels.find(function(e){return e.channelId===c.channelId})),d=babelHelpers.toConsumableArray(e.emptyChannels);return u?p&&(d=e.emptyChannels.filter(function(e){return e.channelId!==c.channelId})):d=S()([c],e.emptyChannels,"channelId"),O({},e,{emptyChannels:d,hash:O({},e.hash,babelHelpers.defineProperty({},c.channelId,c.readOnly?void 0:e.hash[c.channelId]))});case C.a.CHANNELS_REMOVE_REQUEST_SUCCESS:var h=i.channelIds.reduce(function(e,t){return e[t]=void 0,e},{}),b=e.emptyChannels.filter(function(e){return!i.channelIds.includes(e.channelId)});return O({},e,{hash:O({},e.hash,{},h),emptyChannels:b});case C.a.BLACKLIST_ADD_USERS_REQUEST_SUCCESS:var f=[],m=Object.entries(e.hash).reduce(function(n,e){var t=babelHelpers.slicedToArray(e,2),a=t[0],r=t[1],s=(r=void 0===r?{}:r).userId;return i.users.forEach(function(e){var t=e.itemId,r=e.userId;f.push(t),s===r&&(n[a]=void 0)}),n},O({},e.hash)),y=e.emptyChannels.filter(function(e){return!f.includes(E()(e,"context.value.id"))});return O({},e,{hash:m,emptyChannels:y});case C.a.EVENTS_BLACKLIST_ADDED:var v=E()(i,"response.userId"),g=E()(i,"response.context.itemId");return O({},e,{hash:Object.entries(e.hash).reduce(function(e,t){var r=babelHelpers.slicedToArray(t,2),n=r[0],a=r[1];return(a=void 0===a?{}:a).userId===v&&(e[n]=void 0),e},O({},e.hash)),emptyChannels:e.emptyChannels.filter(function(e){return!e.users.find(function(e){return e.id===v})||E()(e,"context.value.id")!==g})});default:return e}}},4682:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(377);function a(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var s={number:null,fetching:!1,error:!1};function i(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:s,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case n.a.PHONE_REQUEST:return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?a(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):a(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},e,{fetching:!0});case n.a.PHONE_SUCCESS:return{number:t.response.result.phone,fetching:!1,error:!1};case n.a.PHONE_FAIL:return{fetching:!1,error:!0};case n.a.PHONE_RESET:return s;default:return e}}},4685:function(e,t,r){var a=r(4686);e.exports=function(e,t,r){var n=null==e?void 0:a(e,t);return void 0===n?r:n}},4686:function(e,t,r){var a=r(4687),s=r(4736);e.exports=function(e,t){for(var r=0,n=(t=a(t,e)).length;null!=e&&r<n;)e=e[s(t[r++])];return r&&r==n?e:void 0}},4687:function(e,t,r){var n=r(4688),a=r(4689),s=r(4698),i=r(4733);e.exports=function(e,t){return n(e)?e:a(e,t)?[e]:s(i(e))}},4688:function(e,t){var r=Array.isArray;e.exports=r},4689:function(e,t,r){var n=r(4688),a=r(4690),s=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,i=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!a(e))||(i.test(e)||!s.test(e)||null!=t&&e in Object(t))}},4690:function(e,t,r){var n=r(4691),a=r(4697);e.exports=function(e){return"symbol"==typeof e||a(e)&&"[object Symbol]"==n(e)}},4691:function(e,t,r){var n=r(4692),a=r(4695),s=r(4696),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?a(e):s(e)}},4692:function(e,t,r){var n=r(4693).Symbol;e.exports=n},4693:function(e,t,r){var n=r(4694),a="object"==typeof self&&self&&self.Object===Object&&self,s=n||a||Function("return this")();e.exports=s},4694:function(r,e,t){(function(e){var t="object"==typeof e&&e&&e.Object===Object&&e;r.exports=t}).call(this,t(42))},4695:function(e,t,r){var n=r(4692),a=Object.prototype,s=a.hasOwnProperty,i=a.toString,o=n?n.toStringTag:void 0;e.exports=function(e){var t=s.call(e,o),r=e[o];try{var n=!(e[o]=void 0)}catch(e){}var a=i.call(e);return n&&(t?e[o]=r:delete e[o]),a}},4696:function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},4697:function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},4698:function(e,t,r){var n=r(4699),s=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=n(function(e){var a=[];return 46===e.charCodeAt(0)&&a.push(""),e.replace(s,function(e,t,r,n){a.push(r?n.replace(i,"$1"):t||e)}),a});e.exports=a},4699:function(e,t,r){var n=r(4700);e.exports=function(e){var t=n(e,function(e){return 500===r.size&&r.clear(),e}),r=t.cache;return t}},4700:function(e,t,r){var n=r(4701),o="Expected a function";function l(a,s){if("function"!=typeof a||null!=s&&"function"!=typeof s)throw new TypeError(o);var i=function(){var e=arguments,t=s?s.apply(this,e):e[0],r=i.cache;if(r.has(t))return r.get(t);var n=a.apply(this,e);return i.cache=r.set(t,n)||r,n};return i.cache=new(l.Cache||n),i}l.Cache=n,e.exports=l},4701:function(e,t,r){var n=r(4702),a=r(4727),s=r(4730),i=r(4731),o=r(4732);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=i,l.prototype.set=o,e.exports=l},4702:function(e,t,r){var n=r(4703),a=r(4718),s=r(4726);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(s||a),string:new n}}},4703:function(e,t,r){var n=r(4704),a=r(4714),s=r(4715),i=r(4716),o=r(4717);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=i,l.prototype.set=o,e.exports=l},4704:function(e,t,r){var n=r(4705);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},4705:function(e,t,r){var n=r(4706)(Object,"create");e.exports=n},4706:function(e,t,r){var n=r(4707),a=r(4713);e.exports=function(e,t){var r=a(e,t);return n(r)?r:void 0}},4707:function(e,t,r){var n=r(4708),a=r(4710),s=r(4709),i=r(4712),o=/^\[object .+?Constructor\]$/,l=Function.prototype,c=Object.prototype,u=l.toString,p=c.hasOwnProperty,d=RegExp("^"+u.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!s(e)||a(e))&&(n(e)?d:o).test(i(e))}},4708:function(e,t,r){var n=r(4691),a=r(4709);e.exports=function(e){if(!a(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},4709:function(e,t){e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},4710:function(e,t,r){var n,a=r(4711),s=(n=/[^.]+$/.exec(a&&a.keys&&a.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!s&&s in e}},4711:function(e,t,r){var n=r(4693)["__core-js_shared__"];e.exports=n},4712:function(e,t){var r=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return r.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},4713:function(e,t){e.exports=function(e,t){return null==e?void 0:e[t]}},4714:function(e,t){e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},4715:function(e,t,r){var n=r(4705),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return a.call(t,e)?t[e]:void 0}},4716:function(e,t,r){var n=r(4705),a=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:a.call(t,e)}},4717:function(e,t,r){var n=r(4705);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},4718:function(e,t,r){var n=r(4719),a=r(4720),s=r(4723),i=r(4724),o=r(4725);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=a,l.prototype.get=s,l.prototype.has=i,l.prototype.set=o,e.exports=l},4719:function(e,t){e.exports=function(){this.__data__=[],this.size=0}},4720:function(e,t,r){var n=r(4721),a=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():a.call(t,r,1),--this.size,!0)}},4721:function(e,t,r){var n=r(4722);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},4722:function(e,t){e.exports=function(e,t){return e===t||e!=e&&t!=t}},4723:function(e,t,r){var n=r(4721);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},4724:function(e,t,r){var n=r(4721);e.exports=function(e){return-1<n(this.__data__,e)}},4725:function(e,t,r){var a=r(4721);e.exports=function(e,t){var r=this.__data__,n=a(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}},4726:function(e,t,r){var n=r(4706)(r(4693),"Map");e.exports=n},4727:function(e,t,r){var n=r(4728);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},4728:function(e,t,r){var n=r(4729);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},4729:function(e,t){e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},4730:function(e,t,r){var n=r(4728);e.exports=function(e){return n(this,e).get(e)}},4731:function(e,t,r){var n=r(4728);e.exports=function(e){return n(this,e).has(e)}},4732:function(e,t,r){var a=r(4728);e.exports=function(e,t){var r=a(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}},4733:function(e,t,r){var n=r(4734);e.exports=function(e){return null==e?"":n(e)}},4734:function(e,t,r){var n=r(4692),a=r(4735),s=r(4688),i=r(4690),o=1/0,l=n?n.prototype:void 0,c=l?l.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(s(t))return a(t,e)+"";if(i(t))return c?c.call(t):"";var r=t+"";return"0"==r&&1/t==-o?"-0":r}},4735:function(e,t){e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}},4736:function(e,t,r){var n=r(4690);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},4750:function(e,t,r){(function(e){!function(){"use strict";var r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},n=function(){function n(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}}(),t=function(e){function t(){r(this,t);var e=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.aborted=!1,e.onabort=null,e}return function(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof t)}if(e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t)Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t}(t,e),n(t,[{key:"toString",value:function(){return"[object AbortSignal]"}},{key:"dispatchEvent",value:function(e){"abort"===e.type&&(this.aborted=!0,"function"==typeof this.onabort&&this.onabort.call(this,e)),function e(t,r,n){if(t===null)t=Function.prototype;var a=Object.getOwnPropertyDescriptor(t,r);if(a===undefined){var s=Object.getPrototypeOf(t);if(s===null){return undefined}else{return e(s,r,n)}}else if("value"in a){return a.value}else{var i=a.get;if(i===undefined){return undefined}return i.call(n)}}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"dispatchEvent",this).call(this,e)}}]),t}(function(){function e(){r(this,e),this.listeners={}}return n(e,[{key:"addEventListener",value:function(e,t){e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var r=this.listeners[e],n=0,a=r.length;n<a;n++)if(r[n]===t)return void r.splice(n,1)}},{key:"dispatchEvent",value:function(t){var r=this;if(t.type in this.listeners){for(var e=function(e){setTimeout(function(){return e.call(r,t)})},n=this.listeners[t.type],a=0,s=n.length;a<s;a++)e(n[a]);return!t.defaultPrevented}}}]),e}()),a=function(){function e(){r(this,e),this.signal=new t}return n(e,[{key:"abort",value:function(){var t=void 0;try{t=new Event("abort")}catch(e){"undefined"!=typeof document?(t=document.createEvent("Event")).initEvent("abort",!1,!1):t={type:"abort",bubbles:!1,cancelable:!1}}this.signal.dispatchEvent(t)}},{key:"toString",value:function(){return"[object AbortController]"}}]),e}();"undefined"!=typeof Symbol&&Symbol.toStringTag&&(a.prototype[Symbol.toStringTag]="AbortController",t.prototype[Symbol.toStringTag]="AbortSignal"),function(e){!function(e){return"function"==typeof e.Request&&!e.Request.prototype.hasOwnProperty("signal")||!e.AbortController}(e)||(e.AbortController=a,e.AbortSignal=t)}("undefined"!=typeof self?self:e)}()}).call(this,r(42))},4752:function(e,t,r){var n=r(320);e.exports=function(e,t){return n(e,t)}},4761:function(e,t,r){"use strict";r.d(t,"f",function(){return n}),r.d(t,"a",function(){return a}),r.d(t,"b",function(){return s}),r.d(t,"c",function(){return i}),r.d(t,"d",function(){return o}),r.d(t,"e",function(){return l});var n=function(e){var t=e.nativeEvent||e;return t.keyCode||t.which},a=40,s=38,i=13,o=27,l=114},4770:function(e,t,r){"use strict";var n=r(35),a=r.n(n),s=r(5963),i=r(45),o=r(5969),l=function(e){function a(){var e,u;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return u=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"render",function(){return null}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"update",function(){var e=u.props,t=e.isConnected,r=e.isTabActive,n=e.isAuthorized,a=e.userId,s=e.users,i=void 0===s?[]:s,o=e.getLastActionTimes,l=t&&r&&n,c=i.map(function(e){return e.id}).filter(function(e){return e!==a});l&&c.length&&o(c)}),u}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.interval;e.isTabActive&&(this.intervalId=setInterval(this.update,t))}},{key:"componentDidUpdate",value:function(e){var t=e.isTabActive,r=this.props,n=r.isTabActive,a=r.interval;t&&!n?clearInterval(this.intervalId):!t&&n&&(this.intervalId=setInterval(this.update,a),this.update())}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}}]),a}(a.a.Component);babelHelpers.defineProperty(l,"propTypes",{isConnected:i.bool.isRequired,isTabActive:i.bool.isRequired,isAuthorized:i.bool.isRequired,getLastActionTimes:i.func.isRequired,interval:i.number,userId:i.number,users:i.array}),babelHelpers.defineProperty(l,"defaultProps",{interval:6e4}),t.a=Object(s.b)(function(e){return{isConnected:e.system.isConnected,isTabActive:e.system.isTabActive,isAuthorized:e.system.isAuthorized,userId:e.system.userId}},{getLastActionTimes:o.q.getLastActionTimes})(l)},4774:function(e,t,r){"use strict";var n=r(35),l=r.n(n),a=r(45),s=r(5963),c=r(6176),i=r(5969),o=r(4775),u=r.n(o),p=function(e){function a(){var e,l;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return l=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(l),"handleClick",function(e){var t=l.props,r=t.route,n=t.query,a=t.params,s=t.setRoute,i=t.isHistoryVisible,o=t.onClick;e.metaKey||e.ctrlKey||1===e.button||(e.preventDefault(),s({route:r,query:n,params:a,isHistoryVisible:i})),o&&o(e)}),l}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"render",value:function(){var e=this.props,t=e.route,r=e.query,n=e.params,a=e.paths,s=e.children,i=e.marker,o=Object(c.d)({route:t,query:r,params:n,paths:a});return l.a.createElement("a",{"data-marker":i,className:u.a.root,href:o,onClick:this.handleClick},s)}}]),a}(n.Component);babelHelpers.defineProperty(p,"propTypes",{route:a.string.isRequired,query:a.object,params:a.object,paths:a.object.isRequired,isHistoryVisible:a.bool,children:a.any,onClick:a.func,setRoute:a.func.isRequired,marker:a.string}),t.a=Object(s.b)(function(e){return{paths:e.router.paths}},{setRoute:i.m.setRoute})(p)},4778:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(5963),a=r(419);function s(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var i=function(){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop},o=new Map,l=function(e){var t=e.route,r=e.params,n=e.query;return JSON.stringify({route:t,params:r,query:n})};function c(e){return Object(n.b)(function(e){return{route:e.router.route,params:e.router.params,query:e.router.query}},void 0,function(e,t,r){return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?s(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):s(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},r,{restorePageScrollPosition:function(){return Object(a.c)({top:o.get(l(e))})},savePageScrollPosition:function(){return o.set(l(e),i())}})})(e)}},4781:function(e,t,r){"use strict";var n=r(5963),a=r(336),s=r.n(a),i=r(6210);t.a=Object(n.b)(function(e){return{phone:e.phone,itemId:s()(e,"channel.channel.context.value.id",0),channelId:s()(e,"channel.channel.channelId",""),userId:e.system.userId}})(i.b)},4783:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(35),a=r.n(n),s=r(45),i=r(6178),o=r(4784),l=r.n(o),c=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props.isMobile,t=Object(i.a)(l.a.root,babelHelpers.defineProperty({},l.a.root_mobile,e));return a.a.createElement("div",{className:t},a.a.createElement("span",{className:l.a.dot}),a.a.createElement("span",{className:Object(i.a)(l.a.dot,l.a.dot_2)}),a.a.createElement("span",{className:Object(i.a)(l.a.dot,l.a.dot_3)}))}}]),t}(n.PureComponent);babelHelpers.defineProperty(c,"propTypes",{isMobile:s.bool})},4785:function(e,t,r){"use strict";r.d(t,"a",function(){return s});var n=r(35),d=r.n(n),a=r(45),h=r(595),b=r(552),i=r(569),f=r(5936),m=r(664),y=r(546),s=function(e){function s(){var e,t;babelHelpers.classCallCheck(this,s);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(n))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"state",{isPopupVisible:!1}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handleWrapClick",function(e){e.preventDefault()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handleButtonClick",function(){t.setState({isPopupVisible:!0})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handlePopupClose",function(){t.setState({isPopupVisible:!1})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"platformSupportHelper",new i.a({isMobile:t.props.isMobile})),t}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"render",value:function(){var e,t=this.props,r=t.dealAction,n=t.isMobile,a=t.isMiniMode,s=this.state.isPopupVisible;e=n?function(e){var t=e.children,r=babelHelpers.objectWithoutProperties(e,["children"]);return d.a.createElement("span",r,t)}:a?h.a:b.a;var i=n?m.a:f.a,o=Object(y.a)("deal-action","button"),l=!n&&!a&&{size:"s",design:"success"};if(r&&r.value&&this.platformSupportHelper.isSupported(r.platformSupport)){var c=r.value,u=c.title,p=c.componentData;return d.a.createElement("span",{onClick:this.handleWrapClick},d.a.createElement(e,babelHelpers.extends({onClick:this.handleButtonClick,marker:n?void 0:o,"data-marker":n?o:void 0},l),u),s&&d.a.createElement(i,{dataId:"dla-".concat(u),onClose:this.handlePopupClose,componentData:p}))}return null}}]),s}(n.Component);babelHelpers.defineProperty(s,"propTypes",{dealAction:a.object,isMobile:a.bool,isMiniMode:a.bool})},4791:function(e,t,r){"use strict";var n=r(35),u=r.n(n),a=r(5963),s=r(45),p=r(6178),i=r(501),o=r(336),l=r.n(o),c=r(479),d=r(4792),h=r.n(d),b=function(e){function a(){var e,c;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return c=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"render",function(){var e=c.props,t=e.itemOwnerId,r=e.userId,n=e.messagesListLength,a=e.messagesListFetching,s=e.children,i=n||t===r||a?null:c.props.replyTime;if(!i)return null;var o="call"===i.type,l=Object(p.a)(h.a.root,babelHelpers.defineProperty({},h.a.root_warning,o));return u.a.createElement("div",{className:l},u.a.createElement("div",{className:h.a.icon}),u.a.createElement("div",{className:h.a.text},i.text),u.a.createElement("div",{className:h.a.action},s))}),c}return babelHelpers.inherits(a,e),a}(u.a.Component);babelHelpers.defineProperty(b,"propTypes",{replyTime:s.object,children:s.node,itemOwnerId:Object(s.oneOfType)([s.string,s.number]),userId:Object(s.oneOfType)([s.string,s.number]),messagesListLength:s.number.isRequired,messagesListFetching:s.bool}),t.a=Object(i.a)("ReplyTime",Object(a.b)(function(e){var t=e.system.appName===c.a.MOBILE?l()(e.channel,"thread"):l()(e.channel,"channel");return{userId:e.system.userId,itemOwnerId:l()(t,"context.value.userId",0),messagesListLength:e.messages.list.length,messagesListFetching:e.messages.fetching,replyTime:l()(t,"context.value.replyTime")}})(b))},4798:function(e,t,r){"use strict";var n=r(35),a=r.n(n),s=r(5963),i=r(45),o=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props,t=e.route,r=(e.routerConfig[t]||{}).component;if(!r)throw new Error("Router: route ".concat(t," not found"));return a.a.createElement(r,null)}}]),t}(a.a.Component);babelHelpers.defineProperty(o,"propTypes",{route:i.string.isRequired,routerConfig:i.object.isRequired}),t.a=Object(s.b)(function(e){return{route:e.router.route}})(o)},48:function(e,t,r){"use strict";t.__esModule=!0;var n,a=r(45),s=(n=a)&&n.__esModule?n:{default:n};t.default=s.default.shape({subscribe:s.default.func.isRequired,dispatch:s.default.func.isRequired,getState:s.default.func.isRequired})},49:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e){"undefined"!=typeof console&&"function"==typeof console.error&&console.error(e);try{throw new Error(e)}catch(e){}}},50:function(e,t,r){"use strict";t.__esModule=!0;var m=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};t.default=function(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{},o=Boolean(e),l=e||c,u=void 0;u="function"==typeof t?t:t?(0,i.default)(t):S;var p=r||P,a=n.pure,d=void 0===a||a,s=n.withRef,h=void 0!==s&&s,b=d&&p!==P,f=I++;return function(c){var a="Connect("+function(e){return e.displayName||e.name||"Component"}(c)+")";var s,e=(function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(i,s=y.Component),i.prototype.shouldComponentUpdate=function(){return!d||this.haveOwnPropsChanged||this.hasStoreStateChanged},i.prototype.computeStateProps=function(e,t){if(!this.finalMapStateToProps)return this.configureFinalMapState(e,t);var r=e.getState();return this.doStatePropsDependOnOwnProps?this.finalMapStateToProps(r,t):this.finalMapStateToProps(r)},i.prototype.configureFinalMapState=function(e,t){var r=l(e.getState(),t),n="function"==typeof r;return this.finalMapStateToProps=n?r:l,this.doStatePropsDependOnOwnProps=1!==this.finalMapStateToProps.length,n?this.computeStateProps(e,t):r},i.prototype.computeDispatchProps=function(e,t){if(!this.finalMapDispatchToProps)return this.configureFinalMapDispatch(e,t);var r=e.dispatch;return this.doDispatchPropsDependOnOwnProps?this.finalMapDispatchToProps(r,t):this.finalMapDispatchToProps(r)},i.prototype.configureFinalMapDispatch=function(e,t){var r=u(e.dispatch,t),n="function"==typeof r;return this.finalMapDispatchToProps=n?r:u,this.doDispatchPropsDependOnOwnProps=1!==this.finalMapDispatchToProps.length,n?this.computeDispatchProps(e,t):r},i.prototype.updateStatePropsIfNeeded=function(){var e=this.computeStateProps(this.store,this.props);return!(this.stateProps&&(0,g.default)(e,this.stateProps)||(this.stateProps=e,0))},i.prototype.updateDispatchPropsIfNeeded=function(){var e=this.computeDispatchProps(this.store,this.props);return!(this.dispatchProps&&(0,g.default)(e,this.dispatchProps)||(this.dispatchProps=e,0))},i.prototype.updateMergedPropsIfNeeded=function(){var e=function(e,t,r){return p(e,t,r)}(this.stateProps,this.dispatchProps,this.props);return!(this.mergedProps&&b&&(0,g.default)(e,this.mergedProps)||(this.mergedProps=e,0))},i.prototype.isSubscribed=function(){return"function"==typeof this.unsubscribe},i.prototype.trySubscribe=function(){o&&!this.unsubscribe&&(this.unsubscribe=this.store.subscribe(this.handleChange.bind(this)),this.handleChange())},i.prototype.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null)},i.prototype.componentDidMount=function(){this.trySubscribe()},i.prototype.componentWillReceiveProps=function(e){d&&(0,g.default)(e,this.props)||(this.haveOwnPropsChanged=!0)},i.prototype.componentWillUnmount=function(){this.tryUnsubscribe(),this.clearCache()},i.prototype.clearCache=function(){this.dispatchProps=null,this.stateProps=null,this.mergedProps=null,this.haveOwnPropsChanged=!0,this.hasStoreStateChanged=!0,this.haveStatePropsBeenPrecalculated=!1,this.statePropsPrecalculationError=null,this.renderedElement=null,this.finalMapDispatchToProps=null,this.finalMapStateToProps=null},i.prototype.handleChange=function(){if(this.unsubscribe){var e=this.store.getState(),t=this.state.storeState;if(!d||t!==e){if(d&&!this.doStatePropsDependOnOwnProps){var r=function(e,t){try{return e.apply(t)}catch(e){return O.value=e,O}}(this.updateStatePropsIfNeeded,this);if(!r)return;r===O&&(this.statePropsPrecalculationError=O.value),this.haveStatePropsBeenPrecalculated=!0}this.hasStoreStateChanged=!0,this.setState({storeState:e})}}},i.prototype.getWrappedInstance=function(){return(0,E.default)(h,"To access the wrapped instance, you need to specify { withRef: true } as the fourth argument of the connect() call."),this.refs.wrappedInstance},i.prototype.render=function(){var e=this.haveOwnPropsChanged,t=this.hasStoreStateChanged,r=this.haveStatePropsBeenPrecalculated,n=this.statePropsPrecalculationError,a=this.renderedElement;if(this.haveOwnPropsChanged=!1,this.hasStoreStateChanged=!1,this.haveStatePropsBeenPrecalculated=!1,this.statePropsPrecalculationError=null,n)throw n;var s=!0,i=!0;d&&a&&(s=t||e&&this.doStatePropsDependOnOwnProps,i=e&&this.doDispatchPropsDependOnOwnProps);var o=!1,l=!1;return r?o=!0:s&&(o=this.updateStatePropsIfNeeded()),i&&(l=this.updateDispatchPropsIfNeeded()),(o||l||e)&&this.updateMergedPropsIfNeeded()||!a?(this.renderedElement=h?(0,y.createElement)(c,m({},this.mergedProps,{ref:"wrappedInstance"})):(0,y.createElement)(c,this.mergedProps),this.renderedElement):a},i);function i(e,t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,i);var r=function(e,t){if(e)return!t||"object"!=typeof t&&"function"!=typeof t?e:t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}(this,s.call(this,e,t));r.version=f,r.store=e.store||t.store,(0,E.default)(r.store,'Could not find "store" in either the context or props of "'+a+'". Either wrap the root component in a <Provider>, or explicitly pass "store" as a prop to "'+a+'".');var n=r.store.getState();return r.state={storeState:n},r.clearCache(),r}return e.displayName=a,e.WrappedComponent=c,e.contextTypes={store:v.default},e.propTypes={store:v.default},(0,C.default)(e,c)}};var y=r(35),v=n(r(48)),g=n(r(51)),i=n(r(52)),C=(n(r(49)),n(r(57)),n(r(67))),E=n(r(68));function n(e){return e&&e.__esModule?e:{default:e}}var c=function(e){return{}},S=function(e){return{dispatch:e}},P=function(e,t,r){return m({},r,e,t)};var O={value:null};var I=0},51:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(e,t){if(e===t)return!0;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(var a=Object.prototype.hasOwnProperty,s=0;s<r.length;s++)if(!a.call(t,r[s])||e[r[s]]!==t[r[s]])return!1;return!0}},52:function(e,t,r){"use strict";t.__esModule=!0,t.default=function(t){return function(e){return(0,n.bindActionCreators)(t,e)}};var n=r(6038)},56:function(e,r,t){"use strict";(function(e){var t="object"==typeof e&&e&&e.Object===Object&&e;r.a=t}).call(this,t(42))},57:function(e,t,r){var n=r(58),a=r(64),s=r(66),i=Function.prototype,o=Object.prototype,l=i.toString,c=o.hasOwnProperty,u=l.call(Object);e.exports=function(e){if(!s(e)||"[object Object]"!=n(e))return!1;var t=a(e);if(null===t)return!0;var r=c.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&l.call(r)==u}},58:function(e,t,r){var n=r(59),a=r(62),s=r(63),i=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":i&&i in Object(e)?a(e):s(e)}},59:function(e,t,r){var n=r(60).Symbol;e.exports=n},5932:function(e,t,i){"use strict";var r={};i.r(r),i.d(r,"core",function(){return m});var n=i(6038),a=i(35),p=i.n(a),s=i(43);function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function b(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function l(e){var h=e.dispatch;return function(d){return function(e){var t=e.fetching,r=e.types,n=e.sequence,a=e.callback,s=babelHelpers.objectWithoutProperties(e,["fetching","types","sequence","callback"]);if(!t)return d(e);var i=t;Array.isArray(t)&&(i=n?t.reduce(function(e,t){return e.then(t)},Promise.resolve()):Promise.all(t.map(function(e){return e()})));var o=babelHelpers.slicedToArray(r,4),l=o[0],c=o[1],u=o[2],p=o[3];return d(b({},s,{type:l})),i.then(function(e){if(d(b({},s,{response:e,type:c})),"function"==typeof a)try{a(e,h)}catch(e){}},function(t){var r={};if(p&&"AbortError"===t.name)d(b({},s,{error:t,type:p}));else{try{r=JSON.parse(t.originalResponse||null)}catch(e){r=t.originalResponse}d(b({},s,{error:t,response:r,type:u})),console.error("Fetching error",t)}})}}}var c="CORE_EVENT_MESSAGES_LOADED";function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var d={subtype:null,subtypeMessagesIds:[]};function h(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var f={fullMessagesHash:{},fullMessagesSortedIds:[]};var m=Object(n.combineReducers)({messagesNotifications:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:d,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case c:var r=t.data;return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},e,{subtype:r.subtype,subtypeMessagesIds:r.subtypeMessagesIds});default:return e}},messages:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:f,t=1<arguments.length?arguments[1]:void 0;switch(t.type){case c:var r=t.data;return function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?h(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):h(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},e,{fullMessagesHash:r.fullMessagesHash,fullMessagesSortedIds:r.fullMessagesSortedIds});default:return e}}}),y=Object(n.combineReducers)(r);var v=i(45),g=i.n(v),C=i(4685),E=i.n(C),S=i(875),P=i(874),O=i(882),I=i(4737),k=i.n(I),H=function(e){function s(){var e,n;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"state",{isTooltipShown:!1}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleToggleTooltip",function(){n.setState({isTooltipShown:!n.state.isTooltipShown})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleClickDocument",function(e){var t=e.target,r=babelHelpers.assertThisInitialized(n).rootNode;r===t||r.contains(t)||n.setState({isTooltipShown:!1})}),n}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidUpdate",value:function(e,t){var r=t.isTooltipShown,n=this.state.isTooltipShown;!r&&n&&document.documentElement.addEventListener("click",this.handleClickDocument),r&&!n&&document.documentElement.removeEventListener("click",this.handleClickDocument)}},{key:"componentWillUnmount",value:function(){document.documentElement.removeEventListener("click",this.handleClickDocument)}},{key:"render",value:function(){var t=this;return p.a.createElement("div",{ref:function(e){return t.rootNode=e},className:k.a.root},p.a.createElement("i",{className:k.a.icon,"data-marker":"message-tooltip-toggler",onClick:this.handleToggleTooltip}),this.renderTooltip())}},{key:"renderTooltip",value:function(){return p.a.createElement(P.a,{marker:"message-tooltip",className:k.a.container,placement:"top",open:this.state.isTooltipShown,content:this.renderTooltipContents()})}},{key:"renderTooltipContents",value:function(){return p.a.createElement(O.a,{href:"".concat("/dostavka","#").concat(this.props.userType),target:"_blank",rel:"noopener noreferrer"},"Как работает Авито Доставка")}}]),s}(a.PureComponent);babelHelpers.defineProperty(H,"propTypes",{userType:g.a.string.isRequired});var T=i(4738),w=i.n(T);function R(e){var t=e.title;return p.a.createElement("div",{className:w.a.root},t)}R.propTypes={title:g.a.string.isRequired};var j=i(497),_=i.n(j);var M=i(922);function N(e){var t=function(r){return r.value.split(/({{\w+}})/g).filter(function(e){return e}).map(function(e){var t=e.match(/{{\w+}}/g);return t?r.placeholders[t[0].match(/\w+/)[0]]:{type:"text",value:e}})}(e.data);return p.a.createElement("div",null,t.map(function(e,t){switch(e.type){case"link":return p.a.createElement(O.a,{key:t,href:e.href},e.value);case"price":return p.a.createElement(M.a,{key:t,value:e.value,precision:0,style:"currency"});default:return p.a.createElement("span",{key:t},e.value)}}))}N.propTypes={data:g.a.shape({value:g.a.string.isRequired,placeholder:g.a.object}).isRequired};var A=i(4739),x=i.n(A);function L(e){var t,r=e.data,n=e.isRoot,a=_()((t={},babelHelpers.defineProperty(t,x.a.root,n),babelHelpers.defineProperty(t,x.a.root_subtext,"subtext"===r.type),t));return p.a.createElement("div",{className:a},p.a.createElement(N,{data:r}))}L.propTypes={data:g.a.shape({value:g.a.string.isRequired,placeholder:g.a.object}).isRequired,isRoot:g.a.bool};var D=i(4740),q=i.n(D);function z(e){var t=e.data,r=t.property,n=t.value;return p.a.createElement("div",{className:q.a.root},p.a.createElement("div",{className:q.a.property},r),p.a.createElement("div",null,n.map(function(e,t){return p.a.createElement(L,{key:t,data:e})})))}z.propTypes={data:g.a.shape({property:g.a.string.isRequired,value:g.a.arrayOf(g.a.shape({type:g.a.string.isRequired,value:g.a.string.isRequired}))}).isRequired};var U=i(4741),F=i.n(U);function B(e){var t=e.data;return p.a.createElement("div",{className:F.a.highlight},t.value.map(function(e,t){return p.a.createElement(L,{key:t,data:e})}))}B.propTypes={data:g.a.shape({value:g.a.arrayOf(g.a.shape({value:g.a.string.isRequired,placeholder:g.a.object})),placeholder:g.a.object}).isRequired};var G=i(905),V=i(865),Q=i(4742),W=i.n(Q);function K(e){var t=e.actions,r=e.onClickAction;return t.length?p.a.createElement("div",{className:W.a.root},p.a.createElement(G.a,{spaced:!0},t.map(function(e){return p.a.createElement(V.a,{key:e.type,design:e.design,onClick:function(){return r(e.type)}},e.value)}))):null}K.propTypes={actions:g.a.arrayOf(g.a.shape({type:g.a.string.isRequired,value:g.a.string.isRequired,design:g.a.string})).isRequired,onClickAction:g.a.func.isRequired};var J;function Y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var $=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Y(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Y(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},babelHelpers.defineProperty({},"seller/payoutFailure",function(){return{title:"Не удалось вывести деньги",body:[{type:"text",value:"Попробуйте позже или введите данные другой карты."}]}}),{},(J={},babelHelpers.defineProperty(J,"buyer/expired",function(){return{title:"Заказ отменён",body:[{type:"text",value:"Продавец не отнёс товар в пункт приёма. Деньги за товар и доставку уже вернулись на вашу карту. Проверьте баланс — банк мог не прислать уведомление о возврате и не отразить его в истории операций."}]}}),babelHelpers.defineProperty(J,"seller/expired",function(){return{title:"Заказ отменён",body:[{type:"text",value:"Вы не принесли товар в пункт приёма."}]}}),J));var X=i(4743),Z=i.n(X),ee=function(e){function s(){var e,t;babelHelpers.classCallCheck(this,s);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(n))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handleClickAction",function(){}),t}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"render",value:function(){var e=this.props,t=e.isLast,r=e.message,n=function(e){var t=$[e.body.type];return"function"==typeof t?t(e.body.params):{title:e.body.text}}(r),a=E()(r,"body.type"),s=a?a.split("/")[0]:"buyer";return p.a.createElement("div",{className:Z.a.root},p.a.createElement(S.a,{size:"s"},p.a.createElement(H,{isLastMessage:t,userType:s}),p.a.createElement(R,{title:n.title}),this.renderBody(n.body),this.renderActions(n.actions)))}},{key:"renderTitle",value:function(e){return p.a.createElement("div",{className:Z.a.header},e)}},{key:"renderActions",value:function(e){return e?p.a.createElement(K,{actions:e,onClickAction:this.handleClickAction}):null}},{key:"renderBody",value:function(e){return e?e.map(function(e,t){switch(e.type){case"table":return p.a.createElement(z,{key:t,data:e});case"highlight":return p.a.createElement(B,{key:t,data:e});default:return p.a.createElement(L,{key:t,data:e,isRoot:!0})}}):null}}]),s}(a.PureComponent);babelHelpers.defineProperty(ee,"propTypes",{message:g.a.object.isRequired,isLast:g.a.bool.isRequired});var te=Object(s.connect)(function(e,t){return{isLast:function(e,t){var r=e.core.messages.fullMessagesSortedIds,n=r[r.length-1];return t.message.id===n}(e,t)}})(ee);var re=Object(n.createStore)(y,Object(n.compose)(Object(n.applyMiddleware)(l),function(e){return e}));var ne=null;var ae=i(6025),se=i(2694),ie={seller:[{id:1,caption:"Товар уже продан"},{id:2,caption:"Неудобно нести товар в пункт приёма"},{id:3,caption:"Не понимаю как работает услуга"},{id:4,caption:"Долго ждать денег на карту"},{id:5,caption:"Другая причина",withComments:!0}],buyer:[{id:1001,caption:"Товар уже продан"},{id:1002,caption:"Продавец не отвечает"},{id:10003,caption:"Продавец отказался отправлять"},{id:1004,caption:"Нашёл другой товар"},{id:1005,caption:"Другая причина",withComments:!0}]},oe=new(function(){function a(e){var t=e.server,r=e.seqId,n=e.token;babelHelpers.classCallCheck(this,a),this.server=t,this.seqId=r||1,this.odd=r%2,this.token=n}return babelHelpers.createClass(a,[{key:"request",value:function(e,t){return this.fetching({method:e,params:t})}},{key:"notify",value:function(e,t){return this.fetching({method:e,params:t},!0)}},{key:"abortableRequest",value:function(e,t){var r=window.AbortController?new window.AbortController:{},n=r.signal;return{abort:function(){r.abort&&r.abort()},fetching:this.fetching({method:e,params:t,signal:n})}}},{key:"fetching",value:function(e,t){var n=this,r=e.method,a=e.signal,s=e.params,i=void 0===s?{}:s,o={jsonrpc:"2.0",method:r.replace(/\//g,"."),params:i};return t||(o.id=this.generateId(),o.uid=Date.now()+"-"+Math.random().toString(36).substring(0,10)),this.token&&(o.params.token=this.token),new Promise(function(r,t){fetch(n.server,{method:"post",credentials:"same-origin",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(o),signal:a}).then(function(e){if(200<=e.status&&e.status<300)return-1!==e.headers.get("content-type").indexOf("application/json")?e.json():e.text();var t=new Error(e.statusText);throw t.responseOriginal=e,t}).then(function(e){e.error||(n.checkToken(e),r(e.result));var t=new Error(e.statusText);throw t.response=e,t}).catch(function(e){"AbortError"!==e.name?e.responseOriginal?e.responseOriginal.json().then(function(e){n.checkToken(e),t(e.error)}).catch(function(){t({})}):e.response?t(e.response.error):t({}):t(e)})})}},{key:"checkToken",value:function(e){e.token&&(this.token=e.token)}},{key:"setToken",value:function(e){this.token=e}},{key:"generateId",value:function(){var e=this.seqId;return this.seqId+=2,this.seqId>Number.MAX_SAFE_INTEGER&&(this.seqId=Number.MIN_SAFE_INTEGER+(this.odd?0:1)),e}}]),a}())({server:"/delivery"}),le=[5,1005],ce=function(e){function a(){var e,i;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"state",{reasonId:null,comments:"",error:null,isLoading:!1}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleRadioChange",function(e){var t=e.value,r=e.name;i.setState(babelHelpers.defineProperty({},r,Number(t)))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleInputChange",function(e){var t=e.value,r=e.name;i.setState(babelHelpers.defineProperty({},r,t))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleSubmit",function(e){var t=i.props,r=t.orderId,n=t.onLoadingStateChange,a=t.onClose,s=i.state.reasonId;e.preventDefault(),i.setState({isLoading:!0}),n(!0),oe.request("item.cancel",{orderId:r}).then(function(){s&&i.sendClickStreamEvent(),a()}).catch(function(){n(!1),i.setState({isLoading:!1,error:"Что-то пошло не так, повторите попытку позднее."})})}),i}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"render",value:function(){var n=this,e=this.props.onClose,t=this.state,r=t.reasonId,a=t.comments,s=t.isLoading,i=t.error,o=le.includes(r);return p.a.createElement(ae.g,{error:i,layout:"narrow",size:"m",onSubmit:this.handleSubmit},p.a.createElement(ae.g.Fieldset,{label:"Укажите причину"},p.a.createElement(ae.z,{name:"reasonId",value:r,marker:"reasons"},this.reasonsList.map(function(e){var t=e.id,r=e.caption;return p.a.createElement(ae.y,{key:t,value:t,marker:"reason",markerId:t,onChange:n.handleRadioChange},r)}))),o&&p.a.createElement(ae.g.Fieldset,null,p.a.createElement(ae.F,{name:"comments",value:a,placeholder:"Комментарий",maxLength:1e3,rows:3,maxRows:5,autoResize:!0,autoFocus:!0,marker:"comments",onChange:this.handleInputChange})),p.a.createElement(ae.g.Action,null,p.a.createElement(ae.i,{spaced:!0},p.a.createElement(ae.b,{size:"m",design:"primary",loading:s,type:"submit",marker:"buttonSubmit"},"Отменить заказ"),p.a.createElement(ae.b,{size:"m",disabled:s,marker:"buttonCancel",onClick:e},"Не отменять"))))}},{key:"sendClickStreamEvent",value:function(){var e=this.props,t=e.orderId,r=e.itemId,n=this.state,a=n.reasonId,s=n.comments,i=this.reasonsList.find(function(e){return e.id===a}).caption;Object(se.a)({eid:2828,version:2,orderid:t,iid:r,order_cancel_cause:a,order_cancel_cause_info:i,order_cancel_cause_txt:s})}},{key:"reasonsList",get:function(){return this.props.isSeller?ie.seller:ie.buyer}}]),a}(a.PureComponent);babelHelpers.defineProperty(ce,"propTypes",{orderId:g.a.number.isRequired,itemId:g.a.number.isRequired,isSeller:g.a.bool.isRequired,onClose:g.a.func.isRequired,onLoadingStateChange:g.a.func.isRequired});var ue=[{id:"s1",question:"Что такое доставка на Авито?",link:"/articles/115002227767",userType:"seller",orderStatus:"confirmed"},{id:"s2",question:"Какие есть требования к товару для отправки?",link:"/articles/723",userType:"seller",orderStatus:"confirmed"},{id:"s3",question:"Как получить деньги за отправленный товар?",link:"/articles/700",userType:"seller",orderStatus:"confirmed"},{id:"s4",question:"Может ли кто-то отнести заказ за меня?",link:"/articles/840",userType:"seller",orderStatus:"confirmed"},{id:"s5",question:"Как и когда я получу деньги за товар?",link:"/articles/700",userType:"seller",orderStatus:"performed"},{id:"s6",question:"Что делать, если товар не доставили вовремя?",link:"/articles/115002227867",userType:"seller",orderStatus:"performed"},{id:"s7",question:"Как узнать, что происходит с заказом?",link:"/articles/115002227867",userType:"seller",orderStatus:"performed"},{id:"s8",question:"Как и когда я получу деньги за товар?",link:"/articles/700",userType:"seller",orderStatus:"provided"},{id:"s9s",question:"Почему банку нужны полные данные карты?",link:"/articles/700",userType:"seller",orderStatus:"accepted"},{id:"b1",question:"Как получить и проверить заказ?",link:"/articles/115002227947",userType:"buyer",orderStatus:"provided"},{id:"b2",question:"Что делать, если товар пришёл с повреждениями?",link:"/articles/115002227897",userType:"buyer",orderStatus:"provided"},{id:"b3",question:"Как отменить заказ?",link:"/articles/115002227967",userType:"buyer",orderStatus:"provided"},{id:"b4",question:"Что делать, если продавец не отправляет заказ?",link:"/articles/697",userType:"buyer",orderStatus:"confirmed"},{id:"b5",question:"Как изменить данные в заказе?",link:"/articles/115002227957",userType:"buyer",orderStatus:"confirmed"},{id:"b6",question:"Как вернутся деньги при отмене заказа?",link:"/articles/115002227807",userType:"buyer",orderStatus:"confirmed"},{id:"b7",question:"Как узнать, где заказ?",link:"/articles/115002227867",userType:"buyer",orderStatus:"performed"},{id:"b8",question:"Как отменить заказ?",link:"/articles/115002227967",userType:"buyer",orderStatus:"performed"},{id:"b9",question:"Как изменить контактные данные покупателя?",link:"/articles/115002227957",userType:"buyer",orderStatus:"performed"},{id:"b10",question:"Как вернутся деньги при отмене заказа?",link:"/articles/115002227807",userType:"buyer",orderStatus:"performed"}],pe=i(4744),de=i.n(pe);function he(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var be="https://support.avito.ru",fe=function(e){function a(){var e,s;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"logEvent",function(e){var t=s.props,r=t.userId,n=t.itemId,a=t.chatId;Object(se.a)(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?he(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):he(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({uid:r,iid:n,chatid:a,version:0},e))}),s}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"componentDidMount",value:function(){this.logEvent({eid:3286})}},{key:"render",value:function(){var t=this,e=this.props,r=e.userType,n=e.orderStatus,a=void 0===n?"seller"===r?"confirmed":"provided":n,s=ue.filter(function(e){return e.userType===r&&e.orderStatus===a}),i="seller"===r&&"confirmed"===a||"buyer"===r&&"provided"===a||0===s.length;return p.a.createElement(p.a.Fragment,null,0<s.length&&p.a.createElement(p.a.Fragment,null,p.a.createElement(ae.q,null,s.map(function(e){return p.a.createElement(ae.o,{key:e.id,href:be+e.link,target:"_blank",noVisited:!0,onClick:function(){t.logEvent({eid:3287,version:1,delivery_help_question:e.id})}},e.question)})),p.a.createElement("hr",{className:de.a.hr})),p.a.createElement(ae.w,null,p.a.createElement(ae.o,{href:be+"/request/251?eventData[contextId]=117",target:"_blank",noVisited:!0,onClick:function(){t.logEvent({eid:3288})}},"Задать вопрос")),i&&p.a.createElement(ae.w,null,"Поддержка Авито: 8 800 600-00-01.",p.a.createElement("br",null),"По будням с 8:00 до 20:00 по московскому времени."))}}]),a}(p.a.PureComponent);babelHelpers.defineProperty(fe,"propTypes",{userId:g.a.string.isRequired,userType:g.a.string.isRequired,itemId:g.a.string.isRequired,chatId:g.a.string.isRequired,orderStatus:g.a.string});function me(){return p.a.createElement("div",{className:Se.a.root},p.a.createElement("img",{className:Se.a.img,src:Ce.a,alt:"",width:"90",height:"53"}),p.a.createElement(ae.D,{size:"xxl",tagName:"h2",bold:!0,align:"center"},"Доставка Авито"))}function ye(){return p.a.createElement("ul",{className:Oe.a.list},p.a.createElement("li",{className:"".concat(Oe.a.item," ").concat(Oe.a.item_1)},"Выберите пункт выдачи."),p.a.createElement("li",{className:"".concat(Oe.a.item," ").concat(Oe.a.item_2)},"Оплатите картой товар и доставку. Когда продавец отправит посылку, вы получите номер для отслеживания."),p.a.createElement("li",{className:"".concat(Oe.a.item," ").concat(Oe.a.item_3)},"Проверьте товар при получении. Если что-то не понравится, вы сможете отказаться от заказа — оплата вернётся на карту."),p.a.createElement("li",{className:"".concat(Oe.a.item," ").concat(Oe.a.item_4)},"Продавец получит деньги, только когда вы проверите товар."))}function ve(e){var t=e.next;return p.a.createElement("div",{className:ke.a.root},p.a.createElement(ae.p,{href:t,design:"primary",size:"l",width:12},"Показать пункты выдачи"))}var ge=i(4745),Ce=i.n(ge),Ee=i(4746),Se=i.n(Ee),Pe=i(4747),Oe=i.n(Pe),Ie=i(4748),ke=i.n(Ie);ve.propTypes={next:g.a.string.isRequired};function He(e){var t=e.next;return p.a.createElement("div",{className:Re.a.root},p.a.createElement(me,null),p.a.createElement(ye,null),p.a.createElement(Te,{next:t}))}var Te=Object(a.memo)(ve),we=i(4749),Re=i.n(we);He.propTypes={next:g.a.string.isRequired};function je(e){var t,r=e.children,n=e.mobile,a=Object(Ne.a)(Le.a.layout,(t={},babelHelpers.defineProperty(t,Le.a.layout_mobile,n),babelHelpers.defineProperty(t,Le.a.layout_empty,!r),t));return p.a.createElement("div",{className:a},r||p.a.createElement(Ae.a,{size:"s"}))}var _e=Object(a.memo)(He),Me={onSocketAPIReady:function(e){if(ne)throw new Error("Can't be initialized twice");ne=e},systemMessages:[{subtype:"delivery",onLoaded:Object(n.bindActionCreators)({handleMessagesLoaded:function(e){return{type:c,data:e}}},re.dispatch).handleMessagesLoaded,components:{message:function(e){return p.a.createElement(s.Provider,{store:re},p.a.createElement(te,e))}}}],popupComponents:[{id:"deliveryCancellation",contentComponent:ce,popupParams:{width:"narrow",padding:"normal"}},{id:"deliveryHelp",contentComponent:fe,popupParams:{width:"narrow"}},{id:"deliveryHowItWorks",contentComponent:_e,popupParams:{width:"narrow"}}]},Ne=(i(4750),i(6178)),Ae=i(866),xe=i(4751),Le=i.n(xe);je.propTypes={children:g.a.oneOfType([g.a.element,g.a.node,g.a.string]),mobile:g.a.bool},je.defaultProps={children:null,mobile:!1};var De=je,qe=function(e){function s(){var e,n;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"state",{JobMap:null}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"loadJobMap",babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([i.e("e43c263f"),i.e("0ab3d117"),i.e("21e34959")]).then(i.bind(null,5964));case 2:t=e.sent,r=t.default,n.setState({JobMap:r});case 5:case"end":return e.stop()}},e)}))),n}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidMount",value:function(){this.loadJobMap()}},{key:"render",value:function(){var e=this.state.JobMap,t=e?p.a.createElement(e,this.props):null;return p.a.createElement(De,{mobile:this.props.mobile},t)}}]),s}(a.PureComponent);qe.propTypes={mobile:g.a.bool},qe.defaultProps={mobile:!1};var ze={popupComponents:[{id:"job-map",contentComponent:qe}]},Ue=i(678),Fe=i(5963),Be=i(478),Ge=i(479),Ve=i(4752),Qe=i.n(Ve),We=i(546),Ke=i(4753),Je=i.n(Ke);function Ye(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var $e="//enterprise.api-maps.yandex.ru/2.1/?apikey=".concat("1220b4af-ae8e-4506-ab3a-c6329234066f","&lang=ru_RU&onload=ymapsReady"),Xe=("".concat($e,"&mode=debug"),{type:"yandex#map",controls:[],center:[65.5,108],zoom:3,maxZoom:18}),Ze={suppressMapOpenBlock:!0,yandexMapDisablePoiInteractivity:!1},et={clusterIcons:[{href:"",size:[60,60],offset:[-30,-30]}],zoomMargin:30},tt=function(e){function s(){var e,a;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleMapReady",function(){a.initMap(),a.trySetPlacemarkState(a.props.selectedMarkerIndex,!0),a.props.onReady()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handlePlacemarkClick",function(e){var t=a.props.selectedMarkerIndex,r=e.get("target");if(a.isCluster(r))a.map.setBounds(r.getBounds());else{var n=r.properties.get("index");n!==t&&a.props.onSelect(n)}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleLocationControlClick",function(){var e=a.props,t=e.userId,r=e.channelId,n=e.appName;Be.a.detectLocationClick({userId:t,channelId:r,appName:n})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"initMap",function(){var e=window.ymaps,t=e.Map,r=e.Clusterer;a.ymap=new t(a.nodes.map,Xe,Ze),a.projection=a.ymap.options.get("projection"),a.initControls();var n=a.buildClusterLayout();a.clusterer=new r(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ye(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ye(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({clusterIconContentLayout:n},et)),a.initEvents(),a.tryInitMarkers(),a.setInitialBoundary()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"initEvents",function(){var e=a.props,t=e.onClick,r=e.onBoundsChanged,n=a.ymap.events;t&&n.add("click",function(){return t()}),r&&n.add("boundschange",function(){return r({center:a.ymap.getCenter()})})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"nodes",{}),a}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidMount",value:function(){this.fetchYmaps().then(this.handleMapReady)}},{key:"shouldComponentUpdate",value:function(e){var t=this.props,r=t.selectedMarkerIndex,n=t.center,a=t.centerShift;return r!==e.selectedMarkerIndex&&(this.trySetPlacemarkState(r,!1),this.trySetPlacemarkState(e.selectedMarkerIndex,!0)),Qe()(n,e.center)&&Qe()(a,e.centerShift)||this.setCenter(e.center,e),!1}},{key:"componentWillUnmount",value:function(){this.ymap&&this.ymap.destroy()}},{key:"render",value:function(){var t=this;return p.a.createElement("div",{"data-marker":Object(We.a)("yandexMap"),ref:function(e){return t.nodes.map=e},className:this.props.className})}},{key:"fetchYmaps",value:function(){return new Promise(function(e,t){if(window.ymaps)e();else{window.ymapsReady=e;var r=document.createElement("script");r.onerror=t,r.src=$e;var n=document.getElementsByTagName("script")[0];n?n.before(r):document.head.appendChild(r)}})}},{key:"isCluster",value:function(e){return Boolean(e.getGeoObjects)}},{key:"setCenter",value:function(e,t){var r=1<arguments.length&&void 0!==t?t:this.props,n=r.centerShift,a=r.markers;if(this.ymap&&e){var s=1<a.length?{duration:250}:void 0;if(n){var i=this.projection.toGlobalPixels([e.lat,e.lon],14,s),o=babelHelpers.slicedToArray(i,2),l=o[0],c=o[1];this.ymap.setGlobalPixelCenter([l-n.x,c-n.y],14,s)}else this.ymap.setCenter([e.lat,e.lon],14)}}},{key:"setInitialBoundary",value:function(){var e=this.props,t=e.markers,r=e.center;t.length?1===t.length?this.setCenter(t[0]):this.ymap.setBounds(this.clusterer.getBounds(),{checkZoomRange:!0,zoomMargin:30}):this.setCenter(r)}},{key:"trySetPlacemarkState",value:function(t,r){if(this.placemarkLayouts){var e=this.placemarkLayouts,n=e.active,a=e.common;this.clusterer.getGeoObjects().forEach(function(e){e.properties.get("index")!==t||e.options.set("iconContentLayout",r?n:a)})}}},{key:"tryInitMarkers",value:function(){var s=this,e=window.ymaps,i=e.Placemark,t=e.templateLayoutFactory,r=this.props,n=r.markers,a=r.onSelect;if(n.length){this.placemarkLayouts={common:t.createClass("<div class='".concat(Je.a.placemark,"'/>")),active:t.createClass("<div class='".concat(Je.a.placemark_active,"'/>"))};var o=n.map(function(e,t){var r=e.lon,n=e.lat,a=new i([n,r],{index:t},{iconLayout:"default#imageWithContent",iconImageHref:"",iconImageSize:[24,36],iconImageOffset:[-12,-34],iconContentLayout:s.placemarkLayouts.common});return a.events.add("click",s.handlePlacemarkClick),a});this.clusterer.add(o),this.ymap.geoObjects.add(this.clusterer),1===o.length&&a(0)}}},{key:"initControls",value:function(){var t=this,e=window.ymaps.control,r=e.ZoomControl,n=e.GeolocationControl,a=e.SearchControl,s=this.props,i=s.isMobile,o=s.isSearchControlEnabled,l=new n(i?void 0:{options:{position:{top:20,left:20}}});l.events.add("click",this.handleLocationControlClick);var c=[l,new r({options:{size:"small",position:i?void 0:{top:68,left:20}}})];if(o){var u=new a({options:{size:i?"medium":"large",provider:"yandex#search",position:i?void 0:{top:20,left:68}}});c.push(u)}c.forEach(function(e){return t.ymap.controls.add(e)})}},{key:"buildClusterLayout",value:function(){var n=this;return window.ymaps.templateLayoutFactory.createClass("<div class='".concat(Je.a.cluster,"'>\n                   <span>\n                       {{ properties.geoObjects.length }}\n                   </span>\n             </div>"),{build:function(){var t=this;this.constructor.superclass.build.call(this);var e=this.getData().properties.get("geoObjects"),r=n.props.selectedMarkerIndex;r<0||e.forEach(function(e){e.properties.get("index")===r&&t.getParentElement().querySelector("div").classList.add(Je.a.cluster_active)})}})}}]),s}(a.Component);babelHelpers.defineProperty(tt,"propTypes",{markers:Object(v.arrayOf)(Object(v.shape)({lon:v.number.isRequired,lat:v.number.isRequired})),appName:v.string.isRequired,selectedMarkerIndex:v.number,className:v.string,onSelect:v.func,onBoundsChanged:v.func,onReady:v.func,isMobile:v.bool,isSearchControlEnabled:v.bool,onClick:v.func,center:Object(v.shape)({lon:v.number.isRequired,lat:v.number.isRequired}),channelId:v.string.isRequired,userId:Object(v.oneOfType)([v.string,v.number]).isRequired,centerShift:Object(v.shape)({x:v.number,y:v.number})}),babelHelpers.defineProperty(tt,"defaultProps",{markers:[]});function rt(e){var t,r=e.className,n=e.marker,a=e.onClose,s=e.onTitleClick,i=e.articlesMaxHeight,o=e.isMobile,l=e.isCrossButtonVisible,c=n.description||[],u=Object(Ne.a)(r,babelHelpers.defineProperty({},ot.a._mobile,o));return p.a.createElement("div",{className:u},p.a.createElement("div",{className:ot.a.content},l&&p.a.createElement("div",{"data-marker":Object(We.a)("map-place-card","close-button"),className:ot.a.cross,onClick:a}),p.a.createElement("span",{"data-marker":Object(We.a)("map-place-card","title"),onClick:s,className:Object(Ne.a)((t={},babelHelpers.defineProperty(t,ot.a.title,!0),babelHelpers.defineProperty(t,ot.a.title_clickable,o&&s),t))},n.title),p.a.createElement("div",{key:n.title,style:{maxHeight:i},className:ot.a.articles},c.map(function(e){var t=e.text,r=e.attributes;return p.a.createElement(at.a,{className:ot.a.article,key:t,text:t,attributes:r})}))))}var nt=Object(Fe.b)(function(e){return{appName:e.system.appName,isMobile:e.system.appName===Ge.a.MOBILE,channelId:e.channel.channelId,userId:e.system.userId}})(tt),at=i(570),st=i(501),it=i(4754),ot=i.n(it);rt.propTypes={marker:Object(v.shape)({title:v.string,description:Object(v.arrayOf)(Object(v.shape)({text:v.string.isRequired,attributes:v.object}))}).isRequired,articlesMaxHeight:v.number,onClose:v.func,onTitleClick:v.func,className:v.string,isMobile:v.bool,isCrossButtonVisible:v.bool.isRequired};var lt=Object(st.a)("MapPlaceCard",rt),ct=i(552),ut=(i(420),i(408));function pt(e){var t=e.lon,r=e.lat,n=Object(ut.a)({ll:"".concat(t,",").concat(r),mode:"routes",rtext:"~".concat(r,",").concat(t),rtt:"auto",z:13});return"//yandex.ru/maps/?".concat(n)}var dt=i(5969),ht=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentDidMount",value:function(){var e=this.props.markers;e&&e.length||this.prepareMarkers()}},{key:"render",value:function(){var e=this.props,t=e.children,r=e.markers,n=void 0===r?[]:r,a=e.preloadedMarkers;return t(e.markersRequest?n:a)}},{key:"prepareMarkers",value:function(){var e=this.props,t=e.markersRequest,r=e.preloadedMarkers,n=e.getMarkers,a=e.chunkId,s=e.setMarkers;t&&(r&&s(a,r),n(a,t.method,t.params))}}]),t}(a.Component);babelHelpers.defineProperty(ht,"propTypes",{chunkId:v.string,markers:v.array,preloadedMarkers:v.array,getMarkers:v.func.isRequired,setMarkers:v.func.isRequired,markersRequest:Object(v.shape)({method:v.string,params:v.object}),children:v.func.isRequired});var bt=Object(Fe.b)(function(e,t){return{markers:e.geoMessagesMarkers.hash[t.chunkId]}},{getMarkers:dt.h.getMarkers,setMarkers:dt.h.setMarkers})(ht),ft=i(4755),mt=i.n(ft),yt=function(e){function s(){var e,n;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"state",{selectedMarkerIndex:-1}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleRouteButtonClick",function(r){return function(){var e=pt(r[n.state.selectedMarkerIndex]),t=window.open();t.opener=null,t.location=e}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handlePlaceCardClose",function(){n.setState({selectedMarkerIndex:-1})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleMarkerSelect",function(e){n.setState({selectedMarkerIndex:e})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleMapReady",function(){(0,n.props.onLoadingStateChange)(!1)}),n}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidMount",value:function(){(0,this.props.onLoadingStateChange)(!0)}},{key:"render",value:function(){var t=this,r=this.state.selectedMarkerIndex,e=this.props,n=e.markers,a=void 0===n?[]:n,s=e.title,i=e.markersRequest,o=e.dataId,l=Object(Ne.a)(mt.a.root,babelHelpers.defineProperty({},mt.a.root_cover,Boolean(s)));return p.a.createElement(bt,{markersRequest:i,preloadedMarkers:a,chunkId:o},function(e){return p.a.createElement("div",{className:l},e.length&&p.a.createElement(nt,{isSearchControlEnabled:!0,markers:e,className:mt.a.map,selectedMarkerIndex:r,onSelect:t.handleMarkerSelect,onReady:t.handleMapReady}),0<=r&&p.a.createElement("div",{className:mt.a.placeCardContainer},p.a.createElement(lt,{className:mt.a.placeCard,marker:e[r],onClose:t.handlePlaceCardClose,isCrossButtonVisible:1<e.length,articlesMaxHeight:420}),p.a.createElement(ct.a,{size:"s",width:12,onClick:t.handleRouteButtonClick(e)},"Построить маршрут")))})}}]),s}(a.Component);babelHelpers.defineProperty(yt,"propTypes",{title:v.string,markers:v.array,markersRequest:v.object,dataId:v.string,onLoadingStateChange:v.func.isRequired});function vt(e){var t=e.refCallback,r=e.value,n=e.placeholder,a=e.maxLength,s=e.onClick,i=e.onChange,o=e.onSearchButtonClick;return p.a.createElement("div",{className:It.a.inputContainer},p.a.createElement("input",{ref:t,type:"text",className:It.a.input,value:r,autoComplete:"off",maxLength:a,placeholder:n,onClick:s,onChange:i}),p.a.createElement("i",{className:It.a.searchButton,onClick:o}))}var gt=Object(st.a)("MapPopup",yt),Ct=i(6214),Et=i(502),St=i(4756),Pt=i.n(St),Ot=i(4757),It=i.n(Ot);vt.propTypes={refCallback:g.a.func,value:g.a.string,placeholder:g.a.string,maxLength:g.a.number,onClick:g.a.func,onChange:g.a.func,onSearchButtonClick:g.a.func},vt.defaultProps={placeholder:"Поиск"};var kt=vt,Ht=function(e){function a(){var e,s;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"renderSuggestion",function(e){var t=e.name,r=e.description,n=e.lon,a=e.lat;return p.a.createElement("div",{onClick:function(){return s.props.onSuggestionClick(e)},className:Pt.a.suggestion,key:"".concat(n,"_").concat(a)},p.a.createElement("div",{className:Pt.a.suggestionName},t),p.a.createElement("div",{className:Pt.a.suggestionDescription},r))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"handleTextChange",function(e){s.props.onTextChange({event:e})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"input",null),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"refInput",function(e){return s.input=e}),s}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"componentDidMount",value:function(){this.input&&this.input.focus()}},{key:"render",value:function(){var e=this.props,t=e.onClose,r=e.isLoaderVisible,n=e.text,a=e.suggestions,s=e.className,i=e.onInputClick;return p.a.createElement(Ct.a,{onBackClick:t},p.a.createElement("div",{className:Object(Ne.a)(Pt.a.searchControl,s)},p.a.createElement(kt,{refCallback:this.refInput,onClick:i,placeholder:"Поиск",value:n,onChange:this.handleTextChange})),p.a.createElement("div",{className:Pt.a.content},a.map(this.renderSuggestion),!a.length&&p.a.createElement("div",{className:Pt.a.empty},"Ничего не найдено"),r&&p.a.createElement("div",{className:Pt.a.overlay},p.a.createElement("div",{className:Pt.a.empty},p.a.createElement(Et.a,null)))))}}]),a}(a.PureComponent);babelHelpers.defineProperty(Ht,"propTypes",{isLoaderVisible:v.bool,text:v.string,onInputClick:v.func.isRequired,className:v.string,suggestions:Object(v.arrayOf)(Object(v.shape)({name:v.string,description:v.string,lon:v.number,lat:v.number})).isRequired,onClose:v.func.isRequired,onSuggestionClick:v.func.isRequired,onTextChange:v.func.isRquired});var Tt=i(578),wt=i(672),Rt=i(4758),jt=i.n(Rt),_t=function(e){function a(){var e,s;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"renderSuggestion",function(e){var t=e.name,r=e.description,n=e.lon,a=e.lat;return p.a.createElement("div",{onClick:function(){return s.props.onSuggestionClick(e)},className:jt.a.suggestion,key:"".concat(n,"_").concat(a)},p.a.createElement("div",{className:jt.a.suggestionName},t),p.a.createElement("div",{className:jt.a.suggestionDescription},r))}),s}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"render",value:function(){var e=this.props,t=e.onTextChange,r=e.text,n=e.isLoaderVisible,a=e.suggestions,s=e.isSearchActive,i=e.className,o=e.onInputClick;return p.a.createElement("div",{className:Object(Ne.a)(jt.a.root,i)},p.a.createElement("div",{className:jt.a.input,onClick:o},p.a.createElement(Tt.a,{placeholder:"Поиск",type:"search",value:r,onChange:t,clearable:!0})),s&&p.a.createElement("div",{className:jt.a.content},a.map(this.renderSuggestion),n&&p.a.createElement(wt.a,null),!a.length&&p.a.createElement("div",{className:jt.a.empty},"Ничего не найдено")))}}]),a}(a.PureComponent);babelHelpers.defineProperty(_t,"propTypes",{isLoaderVisible:v.bool,isSearchActive:v.bool,onInputClick:v.func.isRequired,text:v.string,suggestions:Object(v.arrayOf)(Object(v.shape)({name:v.string,description:v.string,lon:v.number,lat:v.number})).isRequired,className:v.string,onSuggestionClick:v.func.isRequired,onTextChange:v.func.isRquired});var Mt=i(493),Nt=i.n(Mt),At=function(e){function a(){var e,u;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return u=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"state",{isLoaderVisible:!1,text:u.props.initialText,searchResults:[],favoritePlaces:[]}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"handleSuggestionClick",function(e){var t=e.title.trim();if(u.sendSuggestionClickReport(e),u.isPartialSuggestion(e.kind))return u.setState({text:"".concat(t,", ")}),void u.search(t);u.setState({text:t}),u.props.onSelect(e)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"handleTextChange",function(e){var t=e.event;u.setState({text:t.target.value},u.searchDebounced)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"sendSuggestionClickReport",function(e){var t=u.props,r=t.userId,n=t.channelId,a=t.appName,s="search result";u.state.searchResults.length||(s="previous geo suggest"),e.fromItem&&(s="item suggest"),Be.a.geoSuggestionClick({userId:r,channelId:n,suggestionType:s,appName:a})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"search",function(){var e=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,a,s,i,o,l,c=arguments;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=0<c.length&&void 0!==c[0]?c[0]:u.state.text,r=u.props,n=r.geoSearch,a=r.channelId,s=r.mapCenter,(i=(t||"").trim()).length){e.next=6;break}return u.setState({searchResults:[]}),e.abrupt("return");case 6:return u.setState({isLoaderVisible:!0}),e.next=9,n({query:i,channelId:a,mapCenter:s});case 9:o=e.sent,l=o.result.suggests,u.setState({searchResults:l,isLoaderVisible:!1});case 12:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(u),"searchDebounced",Nt()(u.search)),u}var t;return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"componentDidMount",value:function(){this.loadInitialItems()}},{key:"render",value:function(){var e=this.state,t=e.isLoaderVisible,r=e.text,n=e.searchResults,a=e.favoritePlaces;return(0,this.props.children)({isLoaderVisible:t,text:r,suggestions:r?n:a,handleSuggestionClick:this.handleSuggestionClick,handleTextChange:this.handleTextChange})}},{key:"isPartialSuggestion",value:function(e){return"street"===e||"country"===e}},{key:"loadInitialItems",value:(t=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,a,s,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,r=t.channelId,n=t.getFavoritePlaces,a=t.sharedLocation,s=t.initialText,this.setState({isLoaderVisible:!0}),e.next=4,n(a,r);case 4:i=e.sent,o=i.result,this.setState({favoritePlaces:o.suggests,isLoaderVisible:!1}),s&&this.setState({text:s},this.search);case 8:case"end":return e.stop()}},e,this)})),function(){return t.apply(this,arguments)})}]),a}(a.Component);babelHelpers.defineProperty(At,"propTypes",{getFavoritePlaces:v.func.isRequired,geoSearch:v.func.isRequired,channelId:v.string.isRequired,sharedLocation:Object(v.shape)({lon:v.number,lat:v.number}).isRequired,mapCenter:Object(v.shape)({lon:v.number,lat:v.number}).isRequired,onSelect:v.func.isRequired,initialText:v.string,userId:Object(v.oneOfType)([v.string,v.number]).isRequired,children:v.func.isRequired,appName:v.string.isRequired});var xt=Object(Fe.b)(function(e){return{appName:e.system.appName,channelId:e.channel.channelId,userId:e.system.userId}},{getFavoritePlaces:dt.h.getFavoritePlaces,geoSearch:dt.h.geoSearch})(At),Lt=i(336),Dt=i.n(Lt),qt=i(490),zt=i(4759),Ut=i.n(zt),Ft=function(e){function r(e){var c;babelHelpers.classCallCheck(this,r),c=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(r).call(this,e)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"handleTitleClick",function(){var e=c.props,t=e.userId,r=e.channelId,n=e.appName;e.isMobile&&(c.openSearch(),c.setState({initialSearchText:c.state.selectedLocation.title}),Be.a.searchLocation({userId:t,channelId:r,isEdit:!0,appName:n}))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"handleSearchClick",function(){var e=c.props,t=e.userId,r=e.channelId,n=e.appName;c.openSearch(),Be.a.searchLocation({userId:t,channelId:r,appName:n})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"handleSearchClose",function(){c.setState({isSearchActive:!1,initialSearchText:null})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"handleChooseButtonClick",function(){var e,t=c.props,r=t.sendLocationMessage,n=t.onClose,a=t.channelId,s=t.userId,i=t.isMobile,o=t.appName,l=c.state.selectedLocation;r({channelId:a,lon:l.lon,lat:l.lat,title:l.title,kind:l.kind}),n(),i||(e=o===Ge.a.MINI?qt.b:qt.a),Be.a.sendMessage({userId:s,channelId:a,messageType:qt.d,source:e})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"handleSelectLocationFromSearch",function(e){c.handleSearchClose(),c.setState({selectedLocation:e,mapCenter:e})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"handleBoundsChanged",function(){var t=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(t){var r,n,a,s,i,o,l;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.center,n=babelHelpers.slicedToArray(r,2),a=n[0],s=n[1],i=c.state.selectedLocation||{},[a,s].toString()===[i.lat,i.lon].toString())return e.abrupt("return");e.next=5;break;case 5:return c.setState({isReverseGeoInProgress:!0}),e.next=8,c.props.getGeoReverse({lon:s,lat:a});case 8:o=e.sent,l=o.result,c.setState({selectedLocation:l,isReverseGeoInProgress:!1});case 11:case"end":return e.stop()}},e)}));return function(e){return t.apply(this,arguments)}}()),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"handleMapReady",function(){var e=c.props.onLoadingStateChange;c.setState({isMapReady:!0}),e(!1)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(c),"openSearch",function(){c.setState({isSearchActive:!0})});var t=e.sharedLocation;return c.state={isMapReady:!1,selectedLocation:null,isReverseGeoInProgress:null,isSearchActive:null,initialSearchText:"",mapCenter:t||void 0},c}return babelHelpers.inherits(r,e),babelHelpers.createClass(r,[{key:"componentDidMount",value:function(){(0,this.props.onLoadingStateChange)(!0)}},{key:"render",value:function(){var e=this.props.isMobile,t=this.state,r=t.selectedLocation,n=t.isReverseGeoInProgress,a=t.mapCenter,s=t.isMapReady,i=r?{lon:r.lon,lat:r.lat,title:r.title}:null;return p.a.createElement("div",{className:Ut.a.mapContainer},p.a.createElement(nt,{isMobile:e,onClick:this.handleSearchClose,center:a,className:e?Ut.a.map_mobile:Ut.a.map_desktop,onReady:this.handleMapReady,onBoundsChanged:this.handleBoundsChanged}),i&&i.title&&p.a.createElement("div",{className:e?Ut.a.placeCardContainer_mobile:Ut.a.placeCardContainer_desktop},p.a.createElement(lt,{className:e?"":Ut.a.placeCard_desktop,isMobile:e,isCrossButtonVisible:!1,marker:i,onTitleClick:this.handleTitleClick,onClose:this.handlePlaceCardClose,articlesMaxHeight:300}),p.a.createElement("div",{className:Ut.a.buttonWrapper},p.a.createElement(ct.a,{disabled:n,onClick:this.handleChooseButtonClick,className:e?void 0:Ut.a.button_desktop,width:12,fullWidth:e,size:e?"m":"s",design:"primary"},"Отправить место"))),this.renderSearchLocation(),s&&p.a.createElement("i",{className:Ut.a.mapCursor}),e&&p.a.createElement("i",{className:Ut.a.searchButton,onClick:this.handleSearchClick}))}},{key:"renderSearchLocation",value:function(){var i=this,e=this.props,o=e.isMobile,t=e.sharedLocation,r=this.state,n=r.selectedLocation,l=r.isSearchActive,a=r.initialSearchText;if(!n||o&&!l)return null;var c=o?Ht:_t;return p.a.createElement(xt,{initialText:a,mapCenter:n,sharedLocation:t,onSelect:this.handleSelectLocationFromSearch},function(e){var t=e.isLoaderVisible,r=e.text,n=e.suggestions,a=e.handleSuggestionClick,s=e.handleTextChange;return p.a.createElement(c,{className:!o&&Ut.a.searchLocationDesktop,onClose:i.handleSearchClose,isSearchActive:l,onInputClick:i.handleSearchClick,isLoaderVisible:t,text:r,suggestions:n,onSuggestionClick:a,onTextChange:s})})}}]),r}(a.Component);babelHelpers.defineProperty(Ft,"propTypes",{isMobile:v.bool,channelId:v.string.isRequired,onLoadingStateChange:v.func.isRequired,onClose:v.func.isRequired,getGeoReverse:v.func.isRequired,sendLocationMessage:v.func.isRequired,sharedLocation:Object(v.shape)({lon:v.number,lat:v.number}),userId:Object(v.oneOfType)([v.string,v.number]).isRequired,appName:v.string.isRequired});var Bt=Object(Fe.b)(function(e){return{appName:e.system.appName,isMobile:e.system.appName===Ge.a.MOBILE,channelId:e.channel.channelId,userId:e.system.userId,sharedLocation:e.system.appName===Ge.a.MOBILE?Dt()(e.channel,"thread.context.value.sharedLocation"):Dt()(e.channel,"channel.context.value.sharedLocation")}},{getGeoReverse:dt.h.getGeoReverse,sendLocationMessage:dt.i.sendLocationMessage})(Ft),Gt={popupComponents:[{id:Ue.a.MAP_POPUP,contentComponent:gt},{id:Ue.a.CHOOSE_LOCATION,contentComponent:Bt}]};t.a={DELIVERY:Me,JOB:ze,PLATFORM:Gt}},5987:function(e,t,r){"use strict";var l=r(6122),u=r(6200);function n(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function c(e){var c=e.dispatch;return function(l){return function(e){var t=e.waitAll,r=e.types,n=babelHelpers.objectWithoutProperties(e,["waitAll","types"]);if(t){var a=babelHelpers.slicedToArray(r,3),s=a[0],i=a[1],o=a[2];return c(p({},n,{type:s})),function(a){var s=[];return new Promise(function(n){function t(e){var t=e.resolution,r=e.isError;s.push({resolution:t,isError:r}),s.length===a.length&&n(s)}a.map(function(e){return e.then(function(e){return t({resolution:e})},function(e){return t({resolution:e,isError:!0})})})})}(t.map(u.a).map(function(e){return c(e)})).then(function(e){e.every(function(e){return!e.isError})?c(p({},n,{type:i,response:e.map(function(e){return e.resolution})})):c(p({},n,{type:o}))})}return l(e)}}}var d=r(6201);var h=r(377),b=r(6176);var f=r(6078),m=r(6062),y=r(5969),v=r(450),g=r(476);function C(e){var c=e.getState,u=e.dispatch;return function(l){return function(e){var t=l(e),r=e.type,n=c(),a=n.system.eventCode;if(r===h.a.EVENTS_SYSTEM_RECONNECTED&&a===v.g){var s=n.router,i=s.route,o=s.params;Object(b.g)(i)&&u(y.f.getChannels({filters:n.options.defaultFilters})),Object(b.f)(i)&&u(y.i.getMessages({channelId:o.channelId},{isPatch:!0})),Object(b.e)(i)&&u(y.d.getBlacklist({offset:0,limit:g.q})),u(y.f.getChannelsCounters())}return t}}}var E=r(451),a="messenger-unauthorized-reloaded";function S(){return function(r){return function(e){var t=r(e);switch(e.type){case h.a.EVENTS_SYSTEM_CLOSE:Object(E.a)(e)!==v.i||sessionStorage.getItem(a)||(sessionStorage.setItem(a,"1"),window.location.reload())}return t}}}var s=r(336),i=r.n(s),o=r(402),P=r(390);function O(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function I(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?O(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function k(e){var s=e.getState;return function(a){return function(e){if(e.type!==h.a.SEARCH_REQUEST_SUCCESS)return a(e);var t=i()(e,"response.result.documents",[]),r=s().system.userId,n=t.map(function(e){return I({},e,{channel:Object(P.i)(e.channel,r),message:e.message?Object(o.d)(e.message).message:null})});return a(I({},e,{results:n}))}}}var H=r(721);function T(e){var p=e.dispatch,d=e.getState;return function(u){return function(e){var t=u(e);switch(e.type){case h.a.EVENTS_SESSION:if(!d().system.isAuthorized)break;try{var r=JSON.parse(H.b.getItem(H.a.DRAFT_MESSAGES));r&&p(y.i.setDraftMessages(r))}catch(e){}break;case h.a.APP_ACTIVE_CHANGE:var n=d(),a=n.draftMessages,s=n.system.isTabActive;if(!n.system.isAuthorized)break;if(s)try{var i=JSON.parse(H.b.getItem(H.a.DRAFT_MESSAGES));i&&p(y.i.setDraftMessages(i))}catch(e){}else H.b.setItem(H.a.DRAFT_MESSAGES,JSON.stringify(a));break;case h.a.MESSAGE_DRAFT:case h.a.MESSAGE_SEND:case h.a.CHANNELS_REMOVE_REQUEST_SUCCESS:case h.a.BLACKLIST_ADD_USERS_REQUEST_SUCCESS:case h.a.EVENTS_BLACKLIST_ADDED:case h.a.CHANNEL_REQUEST_SUCCESS:var o=d(),l=o.draftMessages,c=o.system.isTabActive;if(!o.system.isAuthorized||!c)break;H.b.setItem(H.a.DRAFT_MESSAGES,JSON.stringify(l));break;case h.a.EVENTS_SYSTEM_CLOSE:Object(E.a)(e)===v.i&&H.b.removeItem(H.a.DRAFT_MESSAGES)}return t}}}var w=r(5977);function R(e){var t=e.dispatch,r=(0,e.getState)().system.appName;return w.a.connect(function(e){t(y.o.serverEvent(e))},r),window.addEventListener("focus",function(){t(y.a.setAppActive(!0))}),window.addEventListener("blur",function(){t(y.a.setAppActive(!1))}),function(t){return function(e){return t(e)}}}var j=r(492);function _(e){var t=e.dispatch;return j.a.onSync(function(e){t(y.a.tabsSync(e))}),function(t){return function(e){return t(e)}}}var M=r(479),N=r(141),A=r.n(N);function x(){var r=!1;return function(t){return function(e){switch(e.type){case h.a.CHANNEL_INITIAL_REQUEST_SUCCESS:case h.a.CHANNELS_REQUEST_SUCCESS:r||(A.a.get("showPushSubscriptionDialog")(),r=!0)}t(e)}}}function L(e){var t=e.browserHistory,r=e.appName,n=e.updateChatsCounter,a=e.getTransport,s=e.getApiLogs,i=e.getItems,o=e.getImages;return[function(e){var i=e.getTransport,o=e.getApiLogs;return function(e){var t=e.getState,r=t().system,n=r.appName,a=r.appVersion,s=new d.a({appName:n,appVersion:a,getUserId:function(){return t().system.userId},getTransport:i,getApiLogs:o});return function(e){return function(t){try{return e(t)}catch(e){return s.captureActionException(e,t.type),s.throw(e)}}}}}({getTransport:a,getApiLogs:s}),c,Object(l.a)({getTransport:a,getApiLogs:s})].concat(t?function(e){var u=e.push,p=e.replace;return function(e){var c=e.getState;return function(l){return function(e){switch(e.type){case h.a.ROUTER_SET:var t=e.route,r=e.params,n=e.query,a=e.isHistoryVisible,s=e.isLocationChanged,i=c().router.paths;if(!i[t])break;var o=Object(b.d)({route:t,params:r,query:n,paths:i});if(!s)return void(a?u(o):p(o))}return l(e)}}}}(t):[],function(e){var t=e.appName,r=e.updateChatsCounter,n=e.getItems,a=e.getImages,s=e.getTransport;return[].concat(babelHelpers.toConsumableArray(Object(f.a)({getImages:a,getItems:n,getTransport:s,appName:t})),babelHelpers.toConsumableArray(Object(m.a)({updateChatsCounter:r,appName:t})),[C,k]).concat(t!==M.a.MODERATION?R:[],t!==M.a.MINI?S:[],[M.a.MINI,M.a.DESKTOP].includes(t)?_:[],T,t===M.a.DESKTOP?x:[])}({appName:r,updateChatsCounter:n,getImages:o,getItems:i,getTransport:a}))}r.d(t,"a",function(){return L})},60:function(e,t,r){var n=r(61),a="object"==typeof self&&self&&self.Object===Object&&self,s=n||a||Function("return this")();e.exports=s},6018:function(e,t,r){"use strict";var n=r(56),a="object"==typeof self&&self&&self.Object===Object&&self,s=(n.a||a||Function("return this")()).Symbol,i=Object.prototype,o=i.hasOwnProperty,l=i.toString,c=s?s.toStringTag:void 0;var u=function(e){var t=o.call(e,c),r=e[c];try{var n=!(e[c]=void 0)}catch(e){}var a=l.call(e);return n&&(t?e[c]=r:delete e[c]),a},p=Object.prototype.toString;var d=function(e){return p.call(e)},h=s?s.toStringTag:void 0;var b=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":h&&h in Object(e)?u(e):d(e)};var f=function(t,r){return function(e){return t(r(e))}}(Object.getPrototypeOf,Object);var m=function(e){return null!=e&&"object"==typeof e},y=Function.prototype,v=Object.prototype,g=y.toString,C=v.hasOwnProperty,E=g.call(Object);t.a=function(e){if(!m(e)||"[object Object]"!=b(e))return!1;var t=f(e);if(null===t)return!0;var r=C.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&g.call(r)==E}},6032:function(e,t,r){"use strict";var n=r(35),u=r.n(n),a=r(5963),o=r(479),s=r(5969),i=r(45),p=r(6178),d=r(697),h=r(595),l=r(4787),b=r.n(l),f=r(546),c=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props,t=e.isImageDisabled,r=e.onHideAttachList,n=e.onImageAttachClick,a=e.onItemAttachClick,s=e.isAttachmentShown,i=e.isGeoOnboardingEnabled,o=e.onGeoAttachClick,l=e.children,c=Object(p.a)(b.a.root,babelHelpers.defineProperty({},b.a.root_geoOnboarding,i));return u.a.createElement(d.a,{cover:!0,usePortal:!1,open:s,placement:"top-start",onOutsideClick:r,content:u.a.createElement("div",{className:c},!t&&u.a.createElement("div",{className:b.a.attachItem,onClick:n},u.a.createElement(h.a,null,"Отправить фото")),u.a.createElement("div",{className:b.a.attachItem,onClick:a},u.a.createElement(h.a,null,"Прикрепить объявление")),u.a.createElement("div",{className:b.a.attachItem,"data-marker":Object(f.a)("attachTooltip","geoAttach"),onClick:o},u.a.createElement(h.a,null,"Указать место встречи"),u.a.createElement("div",{className:b.a.attachItem_new},"Новое")))},l)}}]),t}(u.a.Component);babelHelpers.defineProperty(c,"propTypes",{isAttachmentShown:i.bool,onHideAttachList:i.func.isRequired,onImageAttachClick:i.func.isRequired,onItemAttachClick:i.func.isRequired,onGeoAttachClick:i.func.isRequired,isImageDisabled:i.bool,isGeoOnboardingEnabled:i.bool,children:i.any});var m=r(336),y=r.n(m),v=r(501),g=r(580),C=r(476),E=r(4761),S=r(433),P=r(578),O=r(646),I=r(500),k=r(559),H=r(502),T=r(493),w=r.n(T),R=r(4788),j=r.n(R),_=function(e){function s(){var e,r;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];return r=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(n))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"state",{query:""}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handlePopupClose",function(){r.hide()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleKeyUp",function(e){e.keyCode===E.d&&r.hide(!0)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleClickItem",function(e){r.props.onSendItem(e),r.hide(!0)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleQueryChange",function(e){var t=e.value;t!==r.state.query&&(r.setState({query:t}),r.loadItemsDebounced(t))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleLoadMoreItems",function(){return r.loadItems(r.state.query,!1)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"loadItemsDebounced",w()(r.loadItems,500)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"hide",function(e){(0,r.props.handleClose)(e),r.handleQueryChange({value:""})}),r}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidMount",value:function(){this.loadItems()}},{key:"componentWillUnmount",value:function(){this.props.resetItems()}},{key:"render",value:function(){var e=this.props,t=e.canLoadMore,r=e.list,n=e.firstQuerySuccess,a=e.loading,s=!r.length&&n&&!a;return u.a.createElement(O.a,{marker:Object(f.a)("itemsPopup"),width:"narrow",title:"Отправить объявление",responsive:!1,padding:"normal",onClose:this.handlePopupClose},u.a.createElement("div",{className:j.a.root},this.renderSearchBar(),u.a.createElement("div",{className:j.a.scroll},s?u.a.createElement("div",{className:j.a.noItems},u.a.createElement("div",{className:j.a.noItemsText},"Ничего не найдено")):u.a.createElement(I.a,{scrollNodeSelector:".".concat(j.a.scroll),canLoadMore:t,onLoadMore:this.handleLoadMoreItems},this.renderList(),this.renderSpinner()))))}},{key:"renderSearchBar",value:function(){var e=this.props,t=e.firstQuerySuccess,r=e.firstQueryTotal;return!t||t&&r<=6?null:u.a.createElement("div",{className:j.a.inputContainer},u.a.createElement(P.a,{value:this.state.query,placeholder:"Поиск по моим объявлениям",type:"search",onChange:this.handleQueryChange,onKeyUp:this.handleKeyUp,autoFocus:!0}))}},{key:"renderSpinner",value:function(){var e=this.props,t=e.firstQuerySuccess,r=e.firstQueryTotal;return!e.loading||t&&r<=6?null:u.a.createElement(H.a,null)}},{key:"renderList",value:function(){var i=this;return this.props.list.map(function(e){var t=e.value,r=t.priceString,n=t.id,a=t.title,s=t.images;return u.a.createElement("div",{className:j.a.item,onClick:function(){return i.handleClickItem(e)},key:n},u.a.createElement(k.a,{width:85,height:65,images:y()(s,"main")}),u.a.createElement("div",{className:j.a.itemInfo},u.a.createElement("div",null,a),u.a.createElement("div",{className:j.a.itemPrice},r)))})}},{key:"loadItems",value:function(e,t){var r=0<arguments.length&&void 0!==e?e:"",n=!(1<arguments.length&&void 0!==t)||t,a=this.props,s=a.getItemsForAttach,i=a.itemId,o=a.list;return s({limit:20,itemId:i,offset:n?0:o.length,q:r})}}]),s}(n.Component);babelHelpers.defineProperty(_,"propTypes",{resetItems:i.func.isRequired,getItemsForAttach:i.func.isRequired,handleClose:i.func.isRequired,itemId:i.number.isRequired,onSendItem:i.func.isRequired,loading:i.bool.isRequired,list:i.array.isRequired,firstQuerySuccess:i.bool.isRequired,firstQueryTotal:i.number.isRequired,canLoadMore:i.bool.isRequired});function M(){return JSON.stringify(function(e,t){switch(e){case V.SYSTEM_MESSAGE:var r=new G.a({channelId:t.channelId,subtype:"simpleSystemMessage"});return delete r.id,delete r.created,delete r.sendingStatus,r;case V.DEAL_ACTION:return{platformSupport:{platforms:["web","mav"]},value:{title:"Сделка",componentData:{id:"map-popup",params:{title:"Попап сделки он же попап карты для примера",markersRequest:{method:"messenger.testGeoMarkersRequest.v1"}}}}};case V.CONTEXT_ACTIONS:var n=new G.a({channelId:t.channelId,subtype:"platform",body:{flow:"devtool",contextActions:{platformSupport:{platforms:["web","mav"]},value:{expandable:{titleShort:"Разверни меня"},actions:[{text:"Открыть карту",type:"primary",handler:{type:"link",value:{url:"#",componentData:{id:"map-popup",params:{title:"Место встречи",markersRequest:{method:"messenger.testGeoMarkersRequest.v1"}}}}},confirmation:{title:"title",description:"description",confirmText:"ok",cancelText:"!ok"},analytics:"bla-bla"}]},messageId:"msg-id"},chunks:[]}});return delete n.id,delete n.created,delete n.sendingStatus,n;default:return null}}.apply(void 0,arguments),null,2)}var N=Object(v.a)("ItemsPopup",Object(a.b)(function(e){return{itemId:y()(e,"channel.channel.context.value.id"),loading:e.attachItems.loading,list:e.attachItems.list,firstQuerySuccess:e.attachItems.firstQuerySuccess,firstQueryTotal:e.attachItems.firstQueryTotal,canLoadMore:e.attachItems.canLoadMore}},{resetItems:s.b.resetItems,getItemsForAttach:s.b.getItemsForAttach})(_)),A=r(690),x=r.n(A),L=r(404),D=r(429),q=r(141),z=r.n(q),U=r(2394),F=r(478),B=r(678),G=r(426),V={SYSTEM_MESSAGE:"system-message",DEAL_ACTION:"deal-action",CONTEXT_ACTIONS:"context-actions"};var Q=r(2395),W=r.n(Q),K=r(388),J=r.n(K),Y=r(658),$=r(552),X=r(6137),Z=r(555),ee=r(4789),te=r.n(ee),re=r(6214),ne=function(e){function a(){var e,s;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return s=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"state",{text:M(V.SYSTEM_MESSAGE,s.props),type:V.SYSTEM_MESSAGE,error:""}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"handlePushClick",function(){var e=s.state.type,t=s.props,r=t.pushMessageToState,n=t.channelUpdate,a=t.channel;e===V.DEAL_ACTION?n(a,s.buildDataFromInput()):r(s.buildMessageFromInput())}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"handleSelectChange",function(e){var t=e.value;s.setState({type:t,text:M(t,s.props),error:""})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"handleTextChange",function(e){var t=e.value;s.setState({text:t,error:""})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"pushSystemFromConsole",function(e){var t=s.props,r=t.pushMessageToState,n=t.channelId;e.channelId=n,r(new G.a(e))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"updateDealAction",function(e){var t=s.props,r=t.channel;(0,t.channelUpdate)(r,e)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(s),"tryInitConsoleModeOnce",W()(function(){s.props.consoleMode&&(window.pushSystemMessage=s.pushSystemFromConsole,window.updateDealAction=s.updateDealAction,console.log("%cPushMessageDevTool was initialized in console mode!","color:green; font-style: italic;"))})),s}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"componentDidMount",value:function(){this.tryInitConsoleModeOnce(),this.props.isMobile&&document.activeElement.blur()}},{key:"render",value:function(){var e=this.props,t=e.isMobile,r=e.onBackClick;return t?u.a.createElement(re.a,{title:"PushMessageDevtool",onBackClick:r},this.renderContent()):this.renderContent()}},{key:"renderContent",value:function(){var e=this.state,t=e.text,r=e.type,n=e.error,a=Boolean(n);return u.a.createElement("div",{className:te.a.root},u.a.createElement("div",{className:te.a.input},u.a.createElement(Y.a,{onChange:this.handleTextChange,rows:"4",maxRows:10,autoResize:!0,value:t})),a&&u.a.createElement("div",{className:te.a.error},u.a.createElement(Z.a,{size:"s"},n)),u.a.createElement("div",{className:te.a.controls},u.a.createElement("div",{className:te.a.dealAction},u.a.createElement(Z.a,null,"Type")," ",u.a.createElement(X.a,{onChange:this.handleSelectChange,value:r},J()(V).map(function(e){return u.a.createElement(X.a.Option,{value:e,key:e},e)}))),u.a.createElement($.a,{title:"Пушим в клиентский стейт",design:"primary",onClick:this.handlePushClick},"Push")))}},{key:"buildMessageFromInput",value:function(){var e=this.parseStr(this.state.text);return delete e.id,new G.a(e)}},{key:"buildDataFromInput",value:function(){var e=this.state.type,t=this.parseStr(this.state.text);return e===V.DEAL_ACTION?{dealAction:t}:{}}},{key:"parseStr",value:function(e){try{var t=JSON.parse(e);return this.setState({error:""}),t}catch(e){throw this.setState({error:e.message}),e}}}]),a}(n.Component);babelHelpers.defineProperty(ne,"propTypes",{channelId:i.string.isRequired,channel:i.object.isRequired,pushMessageToState:i.func.isRequired,channelUpdate:i.func.isRequired,consoleMode:i.bool,onBackClick:i.func,isMobile:i.bool});function ae(){return null}var se=r(6215),ie=r(703),oe=r(403);function le(e,n){var t=new se.a({text:e,urlsAreTrusted:!0}),a=ie.a.URL,s=ie.a.ANY,i=ie.a.DELIMITER;if(function(e){var t=ie.a.URL,r=ie.a.DELIMITER,n=e.first.type===t,a=e.last.type===t;if(1===e.phrases.length)return!n;if(!n&&!a)return!0;for(var s=e.first.type,i=!1,o=1;o<e.phrases.length;o++){var l=e.phrases[o].type;if(l!==r){if(i&&l===s)return!0;l!==s&&(i=!0)}}return!1}(t))return[new oe.a({channelId:n,body:{text:t.toString()}})];var o=[],l="";t.phrases.forEach(function(e){var t=e.type,r=e.text;switch(t){case a:o.push(new D.a({channelId:n,body:{url:r}}));break;case i:case s:l+=r}});var r=[];return(l=l.trim())&&r.push(new oe.a({channelId:n,body:{text:l}})),t.first.type===a?[].concat(o,r):[].concat(r,o)}var ce=r(490),ue=r(721),pe=r(693),de=r(4790),he=r.n(de),be=r(504);Object(be.a)({name:"messenger-send",originalWidth:20,originalHeight:20,svg:u.a.createElement("path",{fillRule:"nonzero",d:"M4.518 8.63L2.072 3.127c-.305-.686.417-1.376 1.088-1.04l14.398 7.197a.8.8 0 0 1 0 1.43L3.16 17.912c-.67.336-1.393-.354-1.088-1.04l2.446-5.501L10 10 4.518 8.63z",fill:"currentColor"})});var fe=ue.a.GEO_ONBOARDING,me="undefined"==typeof window,ye=new U.a({isMobile:!1}),ve=!me&&/Trident.*rv[ :]11[^\d]/.test(navigator.userAgent),ge=z.a.get("trackCriteoTransaction"),Ce=function(e){function a(){var e,i;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"state",{text:"",isPushMessageEnabled:!1,isItemsAttachmentsShow:!1,isAttachmentShown:!1,isMessageTypingLogged:!1,isGeoOnboardingEnabled:!1,isGeoAttachmentShow:!1,isImageAttachTooltipVisible:!1}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"nodes",{}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"refUploadInput",function(e){return i.nodes.uploadInput=e}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"refTextarea",function(e){return i.nodes.textarea=e}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"sendTypingEvent",x()(function(){var e=i.props,t=e.sendTyping,r=e.channelId,n=e.users,a=e.userId;t(r,n.filter(function(e){return e.id!==a}).map(function(e){return e.id}))},S.d,{leading:!0,trailing:!1})),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"logMessageTypingStart",function(){var e=i.props,t=e.userId,r=e.channelId;i.state.isMessageTypingLogged||(F.a.messageTypingStart({userId:t,channelId:r}),i.setState({isMessageTypingLogged:!0}))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handlePopupBackClick",function(){i.setState({isPushMessageEnabled:!1})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleInputDoubleClick",function(){i.setState({isPushMessageEnabled:!i.state.isPushMessageEnabled})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleGeoAttachmentToggle",function(){var e=i.state.isGeoAttachmentShow;if(ue.b.setItem(fe,!0),i.setState({isGeoAttachmentShow:!e,isGeoOnboardingEnabled:!1}),i.hideAttachList(),!e){var t=i.props,r=t.channelId,n=t.userId,a=t.channelContext,s=t.appName;F.a.geoAttachmentClick({channelId:r,userId:n,itemId:a.value.id,appName:s})}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleInputChange",function(e){var t=Object(E.f)(e),r=e.target.value,n=e.altKey||e.shiftKey;if(!i.props.isMobile&&t===E.c&&!n)return e.preventDefault(),void i.handleSubmit();r!==i.state.text&&(i.setState({text:r}),i.saveDraftMessage(r.trim()),i.updateTextareaHeight(),r&&(i.sendTypingEvent(),i.logMessageTypingStart()))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleSendItem",function(e){var t=i.props;(0,t.sendItemMessage)(t.channelId,e),i.trackSendMessageToClickStream(ce.f)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleSubmit",function(e){e&&e.preventDefault();var t=i.props,r=t.channelId,n=t.isMobile,a=i.state.text.trim();a?(i.setState({text:"",isMessageTypingLogged:!1}),i.saveDraftMessage(""),i.sendMessagesQueue(r,a),i.trackMessageSend(),i.updateTextareaHeight()):n&&i.setState({isPushMessageEnabled:!0})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"hideAttachList",function(){i.setState({isAttachmentShown:!1})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"showAttachList",function(){if(!i.props.isSystemChat){i.setState({isAttachmentShown:!0});var e=i.props,t=e.channelId,r=e.userId,n=e.appName;F.a.attachmentsClick({userId:r,channelId:t,appName:n})}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleImageAttach",function(){if(!i.getAttachmentDisableReason()){var e=i.nodes.uploadInput;e&&(e.value="",e.click()),i.hideAttachList()}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleImageAttachMouseEnter",function(){i.setState({isImageAttachTooltipVisible:Boolean(i.getAttachmentDisableReason())})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleImageAttachMouseLeave",function(){i.setState({isImageAttachTooltipVisible:!1})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleImageUpload",function(){var e=i.nodes.uploadInput,t=i.props.onImageUpload;if(e.files.length&&FormData){var r=e.files[0],n=new FormData;n.append("uploadfile[]",r,r.name),t&&(t(n),i.trackSendMessageToClickStream(ce.e))}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleItemsPopupClose",function(e){i.setState({isItemsAttachmentsShow:!1}),e&&i.focus()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleShowItemsAttach",function(){i.hideAttachList(),i.setState({isItemsAttachmentsShow:!0})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"saveDraftMessage",w()(function(e){var t=i.props,r=t.channelId,n=t.setDraftMessage,a=t.blockUserId;n({channelId:r,text:e,interlocutorId:a&&Number(a)})},250,{leading:!0,trailing:!0})),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"sendMessage",function(e){var t=i.props,r=t.sendTextMessage,n=t.sendLinkMessage;return e instanceof D.a?n(e.channelId,e.body.url):r(e.channelId,e.body.text)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"updateTextareaHeight",function(){var t=i.nodes.textarea;t&&window.requestAnimationFrame(function(){t.style.height="auto",i.context.scrollApi.restorePositionAfterResize();var e=t.scrollHeight;e&&(t.style.height="".concat(e,"px"),i.context.scrollApi.restorePositionAfterResize())})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"focus",function(){var e=i.nodes.textarea;e&&e.focus()}),i}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"componentDidMount",value:function(){var e=this.props,t=e.draftMessage,r=e.isMobile;this.setState({isGeoOnboardingEnabled:!ue.b.getItem(fe),text:t||"",isMessageTypingLogged:Boolean(t)}),this.updateTextareaHeight(),r||this.focus()}},{key:"render",value:function(){var e,t=this.props,r=t.isMiniMode,n=t.isMobile,a=this.state,s=a.isItemsAttachmentsShow,i=a.isPushMessageEnabled,o=this.getAttachmentDisableReason();return u.a.createElement("div",{className:Object(p.a)((e={},babelHelpers.defineProperty(e,he.a.root,!0),babelHelpers.defineProperty(e,he.a.root_mobile,n),babelHelpers.defineProperty(e,he.a.root_mini,r),e)),"data-marker":Object(f.a)("reply")},u.a.createElement("form",{className:he.a.form,onSubmit:this.handleSubmit},u.a.createElement("div",{className:he.a.attachWrap},this.renderAttach(o),this.renderAttachImageButton(o)),u.a.createElement("input",{type:"file","data-marker":Object(f.a)("reply","imageInput"),accept:"image/gif,image/png,image/jpeg,image/pjpeg",className:he.a.attachImageInput,ref:this.refUploadInput,onChange:this.handleImageUpload}),this.renderTextarea(),this.renderSendButton()),i&&u.a.createElement(ae,{consoleMode:!0,onBackClick:this.handlePopupBackClick}),s&&u.a.createElement(N,{onSendItem:this.handleSendItem,handleClose:this.handleItemsPopupClose}),this.renderGeoAttachmentPopup())}},{key:"renderAttach",value:function(e){var t,r=this.props,n=r.isSystemChat,a=r.attachListComponent,s=this.state,i=s.isAttachmentShown,o=s.isGeoOnboardingEnabled;return u.a.createElement("div",{className:he.a.attachBlock},u.a.createElement(a,{isImageDisabled:Boolean(e),isGeoOnboardingEnabled:o,isAttachmentShown:i,onGeoAttachClick:this.handleGeoAttachmentToggle,onImageAttachClick:this.handleImageAttach,onItemAttachClick:this.handleShowItemsAttach,onHideAttachList:this.hideAttachList},u.a.createElement("div",{"data-marker":Object(f.a)("reply","toggleButton"),onClick:i?this.hideAttachList:this.showAttachList,className:Object(p.a)((t={},babelHelpers.defineProperty(t,he.a.attachIcon,!0),babelHelpers.defineProperty(t,he.a.attachIcon_disabled,n),t))},o&&!n&&u.a.createElement("div",{"data-marker":Object(f.a)("reply","pulseCircle"),className:he.a.pulseCircle}))))}},{key:"renderAttachImageButton",value:function(e){var t;return u.a.createElement(g.a,{inline:!0,placement:"top-start",open:this.state.isImageAttachTooltipVisible,content:e},u.a.createElement("span",{className:Object(p.a)((t={},babelHelpers.defineProperty(t,he.a.attachImage,!0),babelHelpers.defineProperty(t,he.a.attachImage_disabled,Boolean(e)),t)),"data-marker":Object(f.a)("reply","attachImage"),onMouseEnter:this.handleImageAttachMouseEnter,onMouseLeave:this.handleImageAttachMouseLeave,onClick:this.handleImageAttach}))}},{key:"renderGeoAttachmentPopup",value:function(){var e=this.props,t=e.platformPopupComponent,r=e.isMobile;if(!this.state.isGeoAttachmentShow)return null;var n={id:B.a.CHOOSE_LOCATION,params:r?{title:"Место встречи"}:{}};return u.a.createElement(t,{onClose:this.handleGeoAttachmentToggle,componentData:n})}},{key:"renderTextarea",value:function(){var e=this.props,t=e.onTextareaFocus,r=e.onTextareaBlur,n=this.state.text;return u.a.createElement("div",{className:he.a.inputWrap},u.a.createElement("textarea",{"data-marker":Object(f.a)("reply","input"),onDoubleClick:this.handleInputDoubleClick,className:he.a.input,placeholder:"Написать сообщение",rows:"1",maxLength:C.s,onFocus:t,onBlur:r,onChange:ve?null:this.handleInputChange,onInput:ve?this.handleInputChange:null,onKeyDown:this.handleInputChange,value:n,ref:this.refTextarea}))}},{key:"renderSendButton",value:function(){var e,t=this.state.text,r=!!t&&Boolean(t.trim());return u.a.createElement("button",{type:"button",className:Object(p.a)((e={},babelHelpers.defineProperty(e,he.a.sendButton,!0),babelHelpers.defineProperty(e,he.a.sendButton_disabled,!r),babelHelpers.defineProperty(e,he.a.sendButton_active,r),e)),"data-marker":Object(f.a)("reply","send"),onMouseDown:this.handleSubmit},u.a.createElement(be.b,{name:"messenger-send",className:he.a.sendButtonIcon}),u.a.createElement("span",{className:he.a.sendButtonText},"Отправить"))}},{key:"imageUploadStateHasTruthyFlag",value:function(e){var t=this.props,r=t.channelId,n=t.upload;return n.hasOwnProperty(r)&&n[r][e]}},{key:"getAttachmentDisableReason",value:function(){var e=this.props,t="";return!function(e,t){return e&&e.some(function(e){return e.fromUid!==t})}(e.messages,e.userId)?t="Отправлять фото можно после ответа собеседника":this.imageUploadStateHasTruthyFlag("fetching")&&(t="Выполняется отправка"),t}},{key:"sendMessagesQueue",value:function(e,t){var r=le(t,e),n=this.sendMessage;r.reduce(function(e,t){return e.then(function(){return n(t)},function(){return n(t)})},Promise.resolve())}},{key:"trackSendMessageToClickStream",value:function(e){var t,r=this.props,n=r.userId,a=r.channelId,s=r.appName,i=(t={},babelHelpers.defineProperty(t,o.a.MOBILE,ce.c),babelHelpers.defineProperty(t,o.a.MINI,ce.b),t)[s]||ce.a;F.a.sendMessage({userId:n,channelId:a,messageType:e,source:i})}},{key:"trackMessageSend",value:function(){var e=this.props,t=e.channelContext,r=e.userId,n=e.messages,a=void 0===n?[]:n,s=y()(t,"value.replyTime.text","unknown"),i=y()(t,"value.userId")===r,o=0===a.length;this.tryTrackCriteoTransatction(),ye.messageSend(s,i,o),this.trackSendMessageToClickStream(ce.g)}},{key:"tryTrackCriteoTransatction",value:function(){var e=this.props,t=e.channelContext.value,r=e.messages;ge&&!r.length&&t&&t.id&&t.price&&ge("email",t.id,t.price)}}]),a}(n.Component);babelHelpers.defineProperty(Ce,"propTypes",{channelId:i.string.isRequired,userId:Object(i.oneOfType)([i.string,i.number]).isRequired,messages:Object(i.arrayOf)(Object(i.instanceOf)(L.a)).isRequired,users:Object(i.arrayOf)(i.object).isRequired,blockUserId:i.string,upload:i.object.isRequired,sendTextMessage:i.func.isRequired,sendItemMessage:i.func.isRequired,sendTyping:i.func.isRequired,onImageUpload:i.func,channelContext:i.object,isMiniMode:i.bool,isMobile:i.bool,appName:i.string,sendLinkMessage:i.func.isRequired,setDraftMessage:i.func.isRequired,draftMessage:i.string,isSystemChat:i.bool,attachListComponent:i.func.isRequired,platformPopupComponent:i.func.isRequired,onTextareaBlur:i.func,onTextareaFocus:i.func}),babelHelpers.defineProperty(Ce,"contextType",pe.a);var Ee=Ce,Se=r(5936),Pe=r(434),Oe=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){return u.a.createElement(Ee,babelHelpers.extends({},this.props,{attachListComponent:c,platformPopupComponent:Se.a}))}}]),t}(u.a.Component);t.a=Object(v.a)("Reply",Object(a.b)(function(e){return{isMiniMode:e.system.appName===o.a.MINI,isMobile:e.system.appName===o.a.MOBILE,appName:e.system.appName,userId:e.system.userId,channelId:e.messages.channelId,messages:e.messages.list,upload:e.upload,users:e.channel.channel.users,channelContext:e.channel.channel.context,draftMessage:y()(e.draftMessages.hash,[e.messages.channelId,"text"]),blockUserId:y()(e,["channel","channel","chatActions",Pe.a.CHANNEL_BLOCK,"query","userId"])}},{sendLinkMessage:s.i.sendLinkMessage,sendTextMessage:s.i.sendMessage,sendItemMessage:s.i.sendItemMessage,sendTyping:s.g.sendTyping,setDraftMessage:s.i.setDraftMessage})(Oe))},6038:function(e,t,r){"use strict";r.r(t);var h=r(6018),b=r(53),v={INIT:"@@redux/INIT"};function f(e,t,r){var n;if("function"==typeof t&&void 0===r&&(r=t,t=void 0),void 0!==r){if("function"!=typeof r)throw new Error("Expected the enhancer to be a function.");return r(f)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var a=e,s=t,i=[],o=i,l=!1;function c(){o===i&&(o=i.slice())}function u(){return s}function p(t){if("function"!=typeof t)throw new Error("Expected listener to be a function.");var r=!0;return c(),o.push(t),function(){if(r){r=!1,c();var e=o.indexOf(t);o.splice(e,1)}}}function d(e){if(!Object(h.a)(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,s=a(s,e)}finally{l=!1}for(var t=i=o,r=0;r<t.length;r++)t[r]();return e}return d({type:v.INIT}),(n={dispatch:d,subscribe:p,getState:u,replaceReducer:function(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");a=e,d({type:v.INIT})}})[b.a]=function(){var e,r=p;return(e={subscribe:function(e){if("object"!=typeof e)throw new TypeError("Expected the observer to be an object.");function t(){e.next&&e.next(u())}return t(),{unsubscribe:r(t)}}})[b.a]=function(){return this},e},n}function n(e){for(var t=Object.keys(e),f={},r=0;r<t.length;r++){var n=t[r];0,"function"==typeof e[n]&&(f[n]=e[n])}var m,y=Object.keys(f);try{!function(r){Object.keys(r).forEach(function(e){var t=r[e];if(void 0===t(void 0,{type:v.INIT}))throw new Error('Reducer "'+e+'" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined.');if(void 0===t(void 0,{type:"@@redux/PROBE_UNKNOWN_ACTION_"+Math.random().toString(36).substring(7).split("").join(".")}))throw new Error('Reducer "'+e+"\" returned undefined when probed with a random type. Don't try to handle "+v.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined.')})}(f)}catch(e){m=e}return function(e,t){var r=arguments.length<=0||void 0===e?{}:e,n=t;if(m)throw m;for(var a,s,i,o=!1,l={},c=0;c<y.length;c++){var u=y[c],p=f[u],d=r[u],h=p(d,n);if(void 0===h){var b=(a=u,i=void 0,"Given action "+((i=(s=n)&&s.type)&&'"'+i.toString()+'"'||"an action")+', reducer "'+a+'" returned undefined. To ignore an action, you must explicitly return the previous state.');throw new Error(b)}l[u]=h,o=o||h!==d}return o?l:r}}function o(e,t){return function(){return t(e.apply(void 0,arguments))}}function a(e,t){if("function"==typeof e)return o(e,t);if("object"!=typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var r=Object.keys(e),n={},a=0;a<r.length;a++){var s=r[a],i=e[s];"function"==typeof i&&(n[s]=o(i,t))}return n}function c(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];if(0===t.length)return function(e){return e};if(1===t.length)return t[0];var n=t[t.length-1],a=t.slice(0,-1);return function(){return a.reduceRight(function(e,t){return t(e)},n.apply(void 0,arguments))}}var u=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e};function s(){for(var e=arguments.length,l=Array(e),t=0;t<e;t++)l[t]=arguments[t];return function(o){return function(e,t,r){var n,a=o(e,t,r),s=a.dispatch,i={getState:a.getState,dispatch:function(e){return s(e)}};return n=l.map(function(e){return e(i)}),s=c.apply(void 0,n)(a.dispatch),u({},a,{dispatch:s})}}}r.d(t,"createStore",function(){return f}),r.d(t,"combineReducers",function(){return n}),r.d(t,"bindActionCreators",function(){return a}),r.d(t,"applyMiddleware",function(){return s}),r.d(t,"compose",function(){return c})},6048:function(e,t,r){"use strict";var n=r(35),p=r.n(n),a=r(45),s=r(646),i=r(5963),o=r(5969),l=r(6176),d=r(552),h=r(578),b=r(6084),c=r(595),f=r(644),m=r(610),u=r(405),y=r.n(u),v=function(e){function s(){var e,t;babelHelpers.classCallCheck(this,s);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(n))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"state",{timer:t.props.timer}),t}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidMount",value:function(){this.startTimer(this.props.timer)}},{key:"componentWillUnmount",value:function(){this.clearTimer()}},{key:"render",value:function(){return this.state.timerValue<1?this.props.placeholder:this.getTimerCaption()}},{key:"getTimerCaption",value:function(){var e=this.state.timerValue,t=new Date;t.setHours(0),t.setMinutes(0),t.setSeconds(e);var r=360<e?"%HH:%MM:%ss":"%MM:%ss";return"Получить новый код можно через "+y.a.format(t.getTime(),r)}},{key:"clearTimer",value:function(){clearInterval(this.timerId),this.timerId=0,this.setState({timerValue:0})}},{key:"startTimer",value:function(e){var t=this;this.setState({timerValue:e}),this.timerId=setInterval(function(){var e=t.state.timerValue;0<e?t.setState({timerValue:e-1}):t.clearTimer()},1e3)}}]),s}(n.PureComponent);babelHelpers.defineProperty(v,"propTypes",{timer:a.number,placeholder:Object(a.oneOfType)([a.string,a.node,a.element])});var g=r(336),C=r.n(g),E=r(478),S=r(6178),P=r(4771),O=r.n(P),I=function(e){function s(){var e,t;babelHelpers.classCallCheck(this,s);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(n))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handleResendCode",function(){(0,t.props.onResendCode)()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handleSubmit",function(e){e.preventDefault(),t.isCodeValid()&&t.props.onNextClick()}),t}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidMount",value:function(){E.a.showConfirmPhoneCodeScreen(this.props.phoneValue)}},{key:"render",value:function(){var e=this.props,t=e.onNextClick,r=e.onBackClick,n=e.onChange,a=e.codeValue,s=e.codeConfirmResponse,i=e.isCodeConfirmFetching,o=e.phoneValue,l=e.isMobile,c=C()(s,"errors.code")||C()(s,"data.result.message"),u=Object(S.a)(O.a.root,babelHelpers.defineProperty({},O.a.root_mobile,l));return p.a.createElement("div",{className:u},p.a.createElement("div",{className:O.a.formWrap},p.a.createElement(b.a,{title:{text:o,align:l?"left":"center"},layout:"narrow",onSubmit:this.handleSubmit},p.a.createElement("div",{className:O.a.inputWrap},p.a.createElement(f.a,{size:"s",align:l?"left":"center"},"В течение 1–2 минут вы получите SMS с кодом для подтверждения номера телефона."),p.a.createElement(b.a.Fieldset,{error:c,hint:this.renderTimer()},p.a.createElement(h.a,{size:"m",error:Boolean(c),autoFocus:!0,required:!0,minLength:5,value:a,placeholder:"Код подтверждения",onChange:n}))))),p.a.createElement("div",{className:O.a.buttonsWrap},p.a.createElement(m.a,{orientation:l?"vertical":"horizontal",spaced:!0,width:12},p.a.createElement(d.a,{loading:i,width:12,disabled:!this.isCodeValid(),size:"m",design:"primary",onClick:t},"Подтвердить"),!l&&p.a.createElement("div",{className:O.a.changeNumberButtonWrap},p.a.createElement(d.a,{width:12,size:"m",onClick:r},"Изменить номер")))))}},{key:"renderTimer",value:function(){var e=this.props,t=e.codeRequestResponse,r=e.isCodeRequestFetching,n=C()(t,"data.result")||{},a=n.nextTryTime,s=n.lastTryTime,i=C()(t,"timer")||(a||s?a-s:180);return!r&&i&&p.a.createElement(v,{timer:i,placeholder:p.a.createElement(c.a,{onClick:this.handleResendCode},"Получить новый код")})}},{key:"isCodeValid",value:function(){return 5<=this.props.codeValue.length}}]),s}(n.Component);babelHelpers.defineProperty(I,"propTypes",{codeValue:a.string.isRequired,onNextClick:a.func.isRequired,onBackClick:a.func.isRequired,onChange:a.func.isRequired,onResendCode:a.func.isRequired,isCodeRequestFetching:a.bool.isRequired,isCodeConfirmFetching:a.bool.isRequired,codeConfirmResponse:a.object,codeRequestResponse:a.object,phoneValue:a.string.isRequired,isMobile:a.bool});var k=r(616),H=r(4772),T=r.n(H),w=function(e){function s(){var e,t;babelHelpers.classCallCheck(this,s);for(var r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(n))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handleSubmit",function(e){e.preventDefault(),t.isPhoneValid()&&t.props.onNextClick()}),t}return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"componentDidMount",value:function(){E.a.showConfirmPhoneInputScreen(this.props.userId)}},{key:"render",value:function(){var e=this.props,t=e.onNextClick,r=e.onChange,n=e.value,a=e.codeRequestResponse,s=e.isCodeRequestFetching,i=e.isMobile,o=C()(a,"errors")||C()(a,"data.result.messages")||{},l=o.login||o.isUserBlockedByModerator&&o.reasonBlockedText,c=Object(S.a)(T.a.root,babelHelpers.defineProperty({},T.a.root_mobile,i));return p.a.createElement("div",{className:c},p.a.createElement("div",{className:T.a.formWrap},p.a.createElement(b.a,{title:{text:"Подтвердите номер телефона",align:i?"left":"center"},layout:"narrow",onSubmit:this.handleSubmit},p.a.createElement("div",{className:T.a.inputWrap},!i&&p.a.createElement(f.a,{size:"s",align:i?"left":"center"},"Писать сообщения могут только пользователи с подтвержденным номером. Ваш собеседник его не увидит."),p.a.createElement(b.a.Fieldset,{error:l,label:i?"Номер мобильного телефона":""},p.a.createElement(k.a,{size:"m",error:Boolean(l),autoFocus:!0,required:!0,value:n,mask:"phone",placeholder:"+7 ___ ___-__-__",onChange:r}))))),p.a.createElement("div",{className:T.a.buttonWrap},p.a.createElement(d.a,{width:i&&12,loading:s,disabled:!this.isPhoneValid(),size:"m",design:"primary",onClick:t},"Продолжить")))}},{key:"isPhoneValid",value:function(){var e=this.props.value;return e.length&&!e.includes("_")}}]),s}(n.Component);babelHelpers.defineProperty(w,"propTypes",{value:a.string.isRequired,onNextClick:a.func.isRequired,onChange:a.func.isRequired,isCodeRequestFetching:a.bool.isRequired,codeRequestResponse:a.object,isMobile:a.bool,userId:a.number.isRequired});var R=r(4773),j=r.n(R),_=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentDidMount",value:function(){E.a.showConfirmPhoneStartScreen(this.props.userId)}},{key:"render",value:function(){return p.a.createElement("div",{className:j.a.root},p.a.createElement("div",{className:j.a.formWrap},p.a.createElement(b.a,{title:"Подтвердите номер телефона",layout:"narrow",onSubmit:function(e){return e.preventDefault()}},p.a.createElement(f.a,{size:"s"},"Писать сообщения могут только пользователи с подтвержденным номером. Ваш собеседник его не увидит."))),p.a.createElement("div",{className:j.a.buttonWrap},p.a.createElement(d.a,{width:12,size:"m",design:"primary",onClick:this.props.onNextClick},"Продолжить")))}}]),t}(n.Component);babelHelpers.defineProperty(_,"propTypes",{userId:a.number.isRequired,onNextClick:a.func.isRequired});var M=r(479),N=r(2393),A=r(141),x=r.n(A),L=r(5993);function D(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function q(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?D(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):D(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function z(){return U.apply(this,arguments)}function U(){return(U=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(t,r){var n,a,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=x.a.get("csrfToken"),e.next=3,fetch(t,{method:"POST",credentials:"include",headers:{"X-Requested-With":"XMLHttpRequest"},body:Object(L.objectToFormData)(q({},r,babelHelpers.defineProperty({},n.name(),n.val())))});case 3:return a=e.sent,e.next=6,a.json();case 6:return(s=e.sent).tokenName&&s.token&&n.update(s.tokenName,s.token),e.abrupt("return",s);case 9:case"end":return e.stop()}},e)}))).apply(this,arguments)}function F(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}var B="start",G="phone",V="code",Q=function(e){function s(){var e,a;babelHelpers.classCallCheck(this,s);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return a=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(s)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"state",a.getInitialState()),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleNextClick",babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=function(e){return C()(e,"success")||"ok"===C()(e,"data.status")},e.t0=a.state.step,e.next=e.t0===B?4:e.t0===G?6:e.t0===V?12:17;break;case 4:return a.setState({step:G}),e.abrupt("break",17);case 6:return e.next=8,a.requestPhoneCode();case 8:return r=e.sent,"confirmed"===C()(r,"data.status")&&a.createChat(),t(r)&&a.setState({step:V}),e.abrupt("break",17);case 12:return e.next=14,a.confirmPhoneCode();case 14:return n=e.sent,t(n)&&a.createChat(),e.abrupt("break",17);case 17:case"end":return e.stop()}},e)}))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleBackClick",function(){switch(a.state.step){case V:a.setState(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?F(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):F(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},a.getInitialState(),{step:G,phoneValue:a.state.phoneValue}));break;case G:a.setState(a.getInitialState());break;default:a.hidePopup()}}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleResendCode",function(){a.requestPhoneCode(!0)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handleCodeChange",function(e){var t=e.value;a.setState({codeValue:t})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"handlePhoneChange",function(e){var t=e.value;a.setState({phoneValue:t})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(a),"hidePopup",function(){var e=a.props;(0,e.setRoute)({route:e.route,query:{},isHistoryVisible:!1})}),a}var t,r,n;return babelHelpers.inherits(s,e),babelHelpers.createClass(s,[{key:"getInitialState",value:function(){return{step:this.props.isMobile?B:G,isCodeRequestFetching:!1,isCodeConfirmFetching:!1,codeRequestResponse:null,codeConfirmResponse:null,phoneValue:"",codeValue:""}}},{key:"render",value:function(){return(0,this.props.children)({navigateBack:this.handleBackClick,closePopup:this.hidePopup,content:this.renderContent()})}},{key:"renderContent",value:function(){var e=this.props,t=e.userId,r=e.isMobile,n=this.state,a=n.phoneValue,s=n.codeValue,i=n.step,o=n.isCodeRequestFetching,l=n.isCodeConfirmFetching,c=n.codeConfirmResponse,u=n.codeRequestResponse;switch(i){case G:return p.a.createElement(w,{isMobile:r,userId:t,value:a,isCodeRequestFetching:o,codeRequestResponse:u,onNextClick:this.handleNextClick,onChange:this.handlePhoneChange});case V:return p.a.createElement(I,{isMobile:r,userId:t,phoneValue:a,codeValue:s,codeConfirmResponse:c,codeRequestResponse:u,isCodeRequestFetching:o,isCodeConfirmFetching:l,onResendCode:this.handleResendCode,onBackClick:this.handleBackClick,onNextClick:this.handleNextClick,onChange:this.handleCodeChange});case B:default:return p.a.createElement(_,{userId:t,onNextClick:this.handleNextClick})}}},{key:"createChat",value:(n=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(){var t,r,n,a,s,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.props,r=t.createChannel,n=t.setRoute,a=t.itemId,this.hidePopup(),e.next=4,r(a);case 4:s=e.sent,i=s.result,n({route:l.b.CHANNEL,params:{channelId:i.channelId},isHistoryVisible:!1});case 7:case"end":return e.stop()}},e,this)})),function(){return n.apply(this,arguments)})},{key:"requestPhoneCode",value:(r=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(i){var o,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.props.isMobile,l=this.state.phoneValue,this.setState({isCodeRequestFetching:!0}),e.prev=3,e.next=6,s=void 0,r=(t={phone:l,isMobile:o,isRetry:i}).phone,n=t.isRetry,a=t.isMobile,(s=x.a.get("phoneCodeApi"))?s.requestCode({login:r,retry:n,src:"msg_phone_confirm"}):z(N.CODE_REQUEST_URL,{mobile:a,login:r,retry:n,src:"msg_phone_confirm"});case 6:return c=e.sent,this.setState({isCodeRequestFetching:!1,codeRequestResponse:c}),e.abrupt("return",c);case 11:e.prev=11,e.t0=e.catch(3),this.setState({isCodeRequestFetching:!1,codeRequestResponse:null});case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}var t,r,n,a,s},e,this,[[3,11]])})),function(e){return r.apply(this,arguments)})},{key:"confirmPhoneCode",value:(t=babelHelpers.asyncToGenerator(regeneratorRuntime.mark(function e(){var i,o,l,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.props.isMobile,o=this.state,l=o.codeValue,c=o.phoneValue,this.setState({isCodeConfirmFetching:!0}),e.prev=3,e.next=6,s=void 0,r=(t={code:l,phone:c,isMobile:i}).code,n=t.phone,a=t.isMobile,(s=x.a.get("phoneCodeApi"))?s.confirmCode({login:n,code:r}):z(N.CODE_CONFIRM_URL,{mobile:a,login:n,code:r});case 6:return u=e.sent,this.setState({isCodeConfirmFetching:!1,codeConfirmResponse:u}),e.abrupt("return",u);case 11:e.prev=11,e.t0=e.catch(3),this.setState({isCodeConfirmFetching:!1,codeConfirmResponse:null});case 14:return e.abrupt("return",null);case 15:case"end":return e.stop()}var t,r,n,a,s},e,this,[[3,11]])})),function(){return t.apply(this,arguments)})}]),s}(n.Component);babelHelpers.defineProperty(Q,"propTypes",{isMobile:a.bool,children:a.func.isRequired,createChannel:a.func.isRequired,setRoute:a.func.isRequired,userId:a.number.isRequired,itemId:a.string.isRequired,route:a.string.isRequired});function W(e){var t=e.itemId;return p.a.createElement(K,{itemId:t},function(e){var t=e.content,r=e.closePopup;return p.a.createElement(s.a,{width:"narrow",responsive:!1,onClose:r},t)})}var K=Object(i.b)(function(e){return{isMobile:e.system.appName===M.a.MOBILE,route:e.router.route,userId:e.system.userId}},{createChannel:o.e.createChannel,setRoute:o.m.setRoute})(Q);W.propTypes={itemId:a.string.isRequired};t.a=W},61:function(r,e,t){(function(e){var t="object"==typeof e&&e&&e.Object===Object&&e;r.exports=t}).call(this,t(42))},6171:function(e,t,r){"use strict";function n(e){return e.reduce(function(e,t){return e+t},0)}r(2689);r.d(t,"b",function(){return o}),r.d(t,"a",function(){return l});var a=Object.entries({unknown:0,gprs:.5,regular2G:.25,good2G:.45,regular3G:.75,good3G:1.4,regular4G:4,wifi:8}),s=[],i=window.navigator.connection||window.navigator.mozConnection||window.navigator.webkitConnection,o=function(){if(i){var e=setInterval(function(){i.downlink&&s.push(i.downlink)},250);window.addEventListener("load",function(){clearInterval(e)})}},l=function(){var r=s.sort(function(e,t){return e-t})[Math.floor(s.length/2)]||0,e=function(e){return e&&e.length?n(e)/e.length:0}(s),t=a.reduceRight(function(e,t){return r<=t[1]?t:e});return{type:babelHelpers.slicedToArray(t,1)[0],speed:{median:r,average:e}}}},62:function(e,t,r){var n=r(59),a=Object.prototype,s=a.hasOwnProperty,i=a.toString,o=n?n.toStringTag:void 0;e.exports=function(e){var t=s.call(e,o),r=e[o];try{var n=!(e[o]=void 0)}catch(e){}var a=i.call(e);return n&&(t?e[o]=r:delete e[o]),a}},6209:function(e,t,r){"use strict";function s(e){var t=e.children;return f.a.createElement("div",{className:b.a.root},f.a.createElement("div",{className:b.a.wrap},f.a.createElement("div",{className:b.a.placeholder}),t))}var n=r(35),f=r.n(n),a=r(45),i=r(5963),o=r(500),m=r(6202),l=r(692),y=r(694),v=r(546),c=r(5969),g=r(6176),C=r(502),u=r(555),p=r(4776),d=r.n(p),h=r(4777),b=r.n(h);s.propTypes={children:Object(a.oneOfType)([Object(a.arrayOf)(a.node),a.node])};function E(){return f.a.createElement("div",{className:b.a.root},f.a.createElement("div",{className:b.a.wrap},f.a.createElement("div",{className:b.a.title,"data-marker":Object(v.a)("empty","title")},f.a.createElement(u.a,{size:"l"},"Пока нет сообщений")),f.a.createElement("div",{className:b.a.image,"data-marker":Object(v.a)("empty","image")}),f.a.createElement(u.a,{size:"s",tagName:"div",marker:Object(v.a)("empty","text")},"Начните разговор с продавцом, не выходя из сайта")))}function S(){return f.a.createElement("div",{className:b.a.mobileEmpty},f.a.createElement("h2",{className:b.a.mobileTitle},"У вас пока нет сообщений"),f.a.createElement("img",{className:b.a.mobileImage,src:d.a,alt:"Начните разговор с продавцом, не выходя с сайта."}),f.a.createElement("p",{className:b.a.mobileCaption},"Начните разговор с продавцом, не выходя с сайта."))}var P=r(149),O=r.n(P),I=r(479),k=r(4778),H=r(4774),T=r(141),w=r.n(T),R=r(4779),j=r.n(R),_=r(419),M=Object(l.a)(o.a),N=function(e){function a(){var e,l;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return l=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(l),"handleChannelSelect",function(){var e=l.props,t=e.isMiniMode,r=e.savePageScrollPosition;t||(r(),Object(_.c)({top:0}))}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(l),"handleLoadMore",function(){var e=l.props,t=e.itemId,r=e.fetching,n=e.error,a=e.offset,s=e.filters,i=e.getChannels,o=e.paramsList;return r||n?Promise.resolve():i({offset:a,paramsList:o,itemId:t,filters:s})}),l}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"render",value:function(){var e=this.props,t=e.list,r=e.fetching,n=e.error;return!r&&!n&&!t.length?this.renderEmptyContent():this.renderList()}},{key:"renderList",value:function(){var t=this,e=this.props,r=e.list,n=e.canLoadMore,a=e.fetching,s=e.checkedChannelIds,i=e.selectedChannelId,o=e.eventsChatTyping,l=e.onChannelCheckChange,c=e.isMiniMode,u=e.isMobile,p=e.isProDesktop,d=e.className,h=s&&s.length?m.a.ALWAYS:m.a.ON_HOVER,b=d?".".concat(d):void 0;return p&&(b=w.a.get("chatsScrollNodeSelector")),f.a.createElement("div",{className:d,"data-marker":Object(v.a)("channels","list")},a&&!r.length?f.a.createElement(C.a,null):null,f.a.createElement(M,{withLoader:!0,scrollNodeSelector:b,eventName:y.a.Screen.CHANNELS,onLoadMore:this.handleLoadMore,canLoadMore:n&&!a},r.map(function(e){return f.a.createElement(H.a,{key:e.channelId,route:g.b.CHANNEL,params:{channelId:e.channelId},marker:Object(v.a)("channels","channelLink")},f.a.createElement(m.b,{lastMessage:e.lastMessage,showBulkAction:c||u?void 0:h,channel:e,onSelect:t.handleChannelSelect,onCheckChange:l,checked:s&&-1!==s.indexOf(e.channelId),selectedChannelId:i,typingTimestamp:o[e.channelId]}))})))}},{key:"renderEmptyContent",value:function(){var e=this.props,t=e.itemId,r=e.paramsList,n=e.isMiniMode,a=e.isMobile;return t||r?f.a.createElement("div",{className:a?j.a.noResultsMobile:j.a.noResults},"Нет чатов с такими параметрами"):n?f.a.createElement(s,null,f.a.createElement("div",{className:j.a.empty},f.a.createElement(u.a,{size:"xs",tagName:"div"},"Пока нет сообщений"))):a?f.a.createElement(S,null):f.a.createElement(E,null)}}]),a}(n.Component);babelHelpers.defineProperty(N,"propTypes",{paramsList:a.array.isRequired,filters:a.object.isRequired,list:a.array.isRequired,offset:a.number.isRequired,error:a.any.isRequired,canLoadMore:a.bool.isRequired,fetching:a.bool.isRequired,selectedChannelId:a.string,itemId:a.string,getChannels:a.func.isRequired,eventsChatTyping:a.object.isRequired,onChannelCheckChange:a.func,checkedChannelIds:a.array,isMiniMode:a.bool,isMobile:a.bool,className:a.string,savePageScrollPosition:a.func.isRequired,isProDesktop:a.bool});t.a=O()(Object(i.b)(function(e){return{fetching:e.channels.fetching,canLoadMore:e.channels.canLoadMore,error:e.channels.error,offset:e.channels.list.length,selectedChannelId:e.router.params.channelId,eventsChatTyping:e.eventsChatTyping,isMiniMode:e.system.appName===I.a.MINI,isMobile:e.system.appName===I.a.MOBILE,isProDesktop:e.system.appName===I.a.PRO_DESKTOP}},{getChannels:c.f.getChannels}),k.a)(N)},6210:function(e,t,r){"use strict";function s(e){return e&&e.replace(/^8/,"+7")}var n=r(35),i=r.n(n),a=r(45),o=r.n(a),l=r(552),c=r(5963),u=r(478),p=r(501),d=r(5969),h="call",b="show-number";var f=function(r){var e=function(e){function a(){var e,i;babelHelpers.classCallCheck(this,a);for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return i=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(a)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleClickShowNumber",function(){i.trackEvent(b),i.getPhone()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"handleClickCall",function(){i.trackEvent(h),i.getPhone().then(function(e){var t=e.result;i.makeCall(s(t.phone))})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"getPhone",function(){var e=i.props,t=e.itemId,r=e.channelId;return(0,e.getPhoneByItemId)({itemId:t,channelId:r})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(i),"trackEvent",function(e){var t=i.props,r=t.fromReplyTime,n=t.itemId,a=t.channelId,s=t.userId;(e===b?r?u.a.phoneShowNumberReplyTime:u.a.phoneShowNumber:r?u.a.phoneCallReplyTime:u.a.phoneCall)({itemId:n,channelId:a,userId:s})}),i}return babelHelpers.inherits(a,e),babelHelpers.createClass(a,[{key:"componentWillUnmount",value:function(){this.props.resetPhone()}},{key:"render",value:function(){var e=this,t=function(e){return e&&s(e).replace(/[\s-]/g,"")}(this.props.phone.number);return i.a.createElement(r,babelHelpers.extends({},this.props,{onShowNumberClick:this.handleClickShowNumber,onCallClick:t?function(){return e.makeCall(t)}:this.handleClickCall}))}},{key:"makeCall",value:function(e){window.location.href="tel:".concat(e)}}]),a}(i.a.Component);return babelHelpers.defineProperty(e,"propTypes",{itemId:Object(a.oneOfType)([a.string,a.number]).isRequired,userId:Object(a.oneOfType)([a.string,a.number]).isRequired,channelId:a.string.isRequired,phone:a.object.isRequired,getPhoneByItemId:a.func.isRequired,resetPhone:a.func.isRequired,fromReplyTime:a.bool}),Object(p.a)("ActionPhone",Object(c.b)(function(e){return{userId:e.system.userId}},{getPhoneByItemId:d.j.getPhoneByItemId,resetPhone:d.j.resetPhone})(e))},m=r(4782),y=r.n(m);r.d(t,"a",function(){return v});var v={CALL:"call",SHOW_NUMBER:"show-number"},g=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){return i.a.createElement("div",{className:y.a.root},this.renderAction())}},{key:"renderAction",value:function(){switch(this.props.type){case v.SHOW_NUMBER:return this.renderShowNumber();case v.CALL:return this.renderCall();default:return null}}},{key:"renderShowNumber",value:function(){var e=this.props,t=e.phone.number,r=e.onShowNumberClick,n=s(t);return n?i.a.createElement("div",{className:y.a.result},n):i.a.createElement(l.a,{size:"s",onClick:r},"Показать телефон")}},{key:"renderCall",value:function(){var e=this.props.onCallClick;return i.a.createElement("div",{className:y.a.button},i.a.createElement(l.a,{size:"s",onClick:e},"Позвонить"))}}]),t}(i.a.Component);babelHelpers.defineProperty(g,"propTypes",{type:o.a.string.isRequired,phone:o.a.object.isRequired,onShowNumberClick:o.a.func,onCallClick:o.a.func});t.b=f(g)},63:function(e,t){var r=Object.prototype.toString;e.exports=function(e){return r.call(e)}},64:function(e,t,r){var n=r(65)(Object.getPrototypeOf,Object);e.exports=n},65:function(e,t){e.exports=function(t,r){return function(e){return t(r(e))}}},66:function(e,t){e.exports=function(e){return null!=e&&"object"==typeof e}},67:function(e,t,r){"use strict";var c={childContextTypes:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},u={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},p=Object.defineProperty,d=Object.getOwnPropertyNames,h=Object.getOwnPropertySymbols,b=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,m=f&&f(Object);e.exports=function e(t,r,n){if("string"==typeof r)return t;if(m){var a=f(r);a&&a!==m&&e(t,a,n)}var s=d(r);h&&(s=s.concat(h(r)));for(var i=0;i<s.length;++i){var o=s[i];if(!(c[o]||u[o]||n&&n[o])){var l=b(r,o);try{p(t,o,l)}catch(e){}}}return t}}}]);