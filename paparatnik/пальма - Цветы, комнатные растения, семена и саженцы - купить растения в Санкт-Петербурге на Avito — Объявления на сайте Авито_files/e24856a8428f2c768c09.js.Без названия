(window.webpackJsonp=window.webpackJsonp||[]).push([["4a45a229"],{6183:function(e,t,r){"use strict";var v=r(35),a=r(45),n=r.n(a),i=r(822),y=r(893),k=r(820),O=r(872),o=r(6178),l=r(875),s=r(938),p=r.n(s),d=function(e){function t(){return babelHelpers.classCallCheck(this,t),babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).apply(this,arguments))}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"render",value:function(){var e=this.props,t=e.option,r=e.size,a=e.aria,n=e.onClick,i=babelHelpers.objectWithoutProperties(e,["option","size","aria","onClick"]),s=Object(o.a)(p.a.option,p.a["size-".concat(r)]);return v.createElement("div",babelHelpers.extends({className:s},Object(o.b)(i),a,{onClick:n}),v.createElement(l.a,{size:r},t.text))}}]),t}(v.Component);babelHelpers.defineProperty(d,"propTypes",{option:n.a.object,index:n.a.number,aria:n.a.shape({id:n.a.string,role:n.a.string,"aria-selected":n.a.bool}),selected:n.a.bool,size:n.a.oneOf(["s","m","l"]),marker:n.a.string,markerId:n.a.oneOfType([n.a.string,n.a.number]),onClick:n.a.func});var H=d;function u(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function P(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?u(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):u(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var c=function(e){function i(){var e,n;babelHelpers.classCallCheck(this,i);for(var t=arguments.length,r=new Array(t),a=0;a<t;a++)r[a]=arguments[a];return n=babelHelpers.possibleConstructorReturn(this,(e=babelHelpers.getPrototypeOf(i)).call.apply(e,[this].concat(r))),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"state",{open:!1}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"inputRef",null),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleToggleVisible",function(){n.props.disabled||n.setState(function(e){return{open:!e.open}})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleInputKeyDown",function(e){var t=e.event;t.preventDefault(),"Enter"!==t.key&&" "!==t.key||n.setState({open:!0})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"handleOnChange",function(e){var t=n.props,r=t.name,a=t.onChange;n.setState({open:!1}),a&&a({name:r,value:e.value.value}),n.inputRef.focus()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"setInputRef",function(e){n.inputRef=e}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(n),"getValue",function(){var e=n.props,t=e.value;return e.options.find(function(e){return e.value===t})||null}),n}return babelHelpers.inherits(i,e),babelHelpers.createClass(i,[{key:"render",value:function(){var r=this,e=this.props,t=(e.value,e.options),a=e.loading,n=e.error,i=e.size,s=e.marker,o=(e.markerId,e.stick),l=(e.theme,e.name),p=e.height,d=e.width,u=e.disabled,c=e.reactListType,b=(babelHelpers.objectWithoutProperties(e,["value","options","loading","error","size","marker","markerId","stick","theme","name","height","width","disabled","reactListType"]),this.state.open),f=this.getValue(),h=P({value:f,item:v.createElement(H,{size:i}),name:l,options:t,disabled:u,open:b,height:p,reactListType:c},s&&{marker:"".concat(s,"-dropdown")},{onChange:this.handleOnChange,onClose:this.handleToggleVisible,onOutsideClick:this.handleToggleVisible}),g=P({value:f?f.text:"",width:d,loading:a,error:n,size:i,stick:o,disabled:u,readOnly:!0},s&&{marker:"".concat(s,"-input")},{onKeyDown:this.handleInputKeyDown,onClick:this.handleToggleVisible}),m={ariaExpanded:b};return v.createElement(y.a,h,function(e){var t=e.ref;return v.createElement(O.a,babelHelpers.extends({layoutRef:t,getInputNode:r.setInputRef},g,m,{after:v.createElement(k.b,{name:"select-arrow"})}))})}}]),i}(v.Component);babelHelpers.defineProperty(c,"propTypes",{value:n.a.oneOfType([n.a.string,n.a.number]),options:n.a.array,loading:n.a.bool,error:n.a.bool,marker:n.a.string,markerId:n.a.oneOfType([n.a.string,n.a.number]),size:n.a.oneOf(["s","m","l"]),stick:n.a.oneOf(["before","both-horizontal","both-vertical","after","above","below"]),width:n.a.oneOfType([n.a.string,n.a.number]),height:n.a.string,reactListType:n.a.oneOf(["variable","uniform","simple"]),onChange:n.a.func,autoFocus:n.a.bool,disabled:n.a.bool,id:n.a.string,name:n.a.string,required:n.a.bool,theme:n.a.object}),babelHelpers.defineProperty(c,"defaultProps",{size:"s",height:"100px",width:12,reactListType:"simple"});t.a=Object(i.a)(c)},912:function(e,t,a){"use strict";var r=a(35),n=a.n(r),i=a(45),s=a.n(i),o=a(872),l=a(861);function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}var d,u={phone:"+7 999 999-99-99"},c=function(e){function r(e){var t;return babelHelpers.classCallCheck(this,r),t=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(r).call(this,e)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"handleChange",function(e){t.props.onChange&&t.props.onChange(e)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(t),"setInputRef",function(e){t.nodes.input=e}),t.nodes={},t}return babelHelpers.inherits(r,e),babelHelpers.createClass(r,[{key:"componentDidMount",value:function(){d=a(617);var e=this.props,t=e.mask,r=e.disabled;this.addMask(t),!r&&this.nodes.input&&this.nodes.input.addEventListener("input",this.handleChange)}},{key:"componentWillReceiveProps",value:function(e){var t=this.props,r=t.mask,a=t.disabled;e.mask!==r&&(this.removeMask(),this.addMask(e.mask)),e.disabled&&!a&&this.nodes.input.removeEventListener("input",this.handleChange),!e.disabled&&a&&this.nodes.input.addEventListener("input",this.handleChange)}},{key:"componentWillUnmount",value:function(){this.removeMask(),this.nodes.input.removeEventListener("input",this.handleChange)}},{key:"render",value:function(){var e=this.props,t=(e.mask,babelHelpers.objectWithoutProperties(e,["mask"]));return n.a.createElement(o.a,babelHelpers.extends({},t,{type:"text",onChange:function(){},getInputNode:this.setInputRef}))}},{key:"addMask",value:function(e){var t=this.nodes.input;if(t){var r=e;"string"==typeof e&&(r={mask:u[e]||e}),d(function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}({},r,{oncleared:this.handleChange})).mask(t)}}},{key:"removeMask",value:function(){var e=this.nodes.input;e.inputmask&&e.inputmask.remove()}}]),r}(r.PureComponent);babelHelpers.defineProperty(c,"eventHandlers",["onChange","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur"]),babelHelpers.defineProperty(c,"propTypes",{className:s.a.string,mask:s.a.oneOfType([s.a.string,s.a.object,s.a.oneOf(Object.keys(u))]),clearable:s.a.bool,size:s.a.oneOf(["s","m","l"]),width:s.a.oneOfType([s.a.string,s.a.number]),stick:s.a.oneOf(["before","both-horizontal","both-vertical","after","above","below"]),marker:s.a.string,markerId:s.a.oneOfType([s.a.string,s.a.number]),error:s.a.oneOfType([s.a.bool,s.a.string]),id:s.a.string,name:s.a.string,type:s.a.string,value:s.a.oneOfType([s.a.string,s.a.number]),disabled:s.a.bool,autoComplete:s.a.string,autoFocus:s.a.bool,placeholder:s.a.string,readOnly:s.a.bool,required:s.a.bool,tabIndex:s.a.oneOfType([s.a.string,s.a.number]),textAlign:s.a.oneOf(["left","right"]),onChange:s.a.func,onKeyDown:s.a.func,onKeyPress:s.a.func,onKeyUp:s.a.func,onFocus:s.a.func,onBlur:s.a.func}),babelHelpers.defineProperty(c,"defaultProps",{value:"",width:12,mask:"phone"}),t.a=Object(l.a)(c)},913:function(e,t,r){"use strict";var a=r(35),n=r.n(a),i=r(45),s=r.n(i),o=r(872),l=r(861),p=r(6115),d=function(e){function t(e){var l;return babelHelpers.classCallCheck(this,t),l=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(t).call(this,e)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(l),"handleKeyDown",function(e){var t=l.props.onKeyDown;l.updateCursorPosition(),t&&t(e)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(l),"handleFocus",function(e){var t=l.props.onFocus;l.updateCursorPosition(),t&&t(e)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(l),"handleClick",function(){l.updateCursorPosition()}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(l),"handleChange",function(e){var t=e.event,r=l.props.onChange,a=t.target,n=l.formatNumber(a.value),i=l.props.dischargeSeparator?n.replace(/\s/g,""):n,s=i&&!isNaN(Number(i))?Number(i):void 0,o=l.state.value;l.setState({value:n},function(){n===o?requestAnimationFrame(function(){a.selectionStart=l.cursorPosition,a.selectionEnd=l.cursorPosition}):l.cursorPosition=a.selectionStart}),r&&r(t,{value:n,valueNumber:s})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(l),"setInputRef",function(e){l.nodes.input=e}),l.state={value:l.formatNumber(l.props.value)},l.nodes={},l.cursorPosition=0,l.updateCursorPosition=l.updateCursorPosition.bind(babelHelpers.assertThisInitialized(l)),l}return babelHelpers.inherits(t,e),babelHelpers.createClass(t,[{key:"componentWillReceiveProps",value:function(e){this.setState({value:this.formatNumber(e.value)})}},{key:"render",value:function(){var e=this.props,t=(e.positiveOnly,e.maxIntegerLength,e.maxFractionLength,e.dischargeSeparator,babelHelpers.objectWithoutProperties(e,["positiveOnly","maxIntegerLength","maxFractionLength","dischargeSeparator"])),r=this.state.value;return n.a.createElement(o.a,babelHelpers.extends({},t,{type:"text",value:r,getInputNode:this.setInputRef,onKeyDown:this.handleKeyDown,onFocus:this.handleFocus,onClick:this.handleClick,onChange:this.handleChange}))}},{key:"formatNumber",value:function(e){var t=this.props,r=t.maxIntegerLength,a=t.maxFractionLength,n=this.props.positiveOnly,i=(this.state||{}).value;e=String(e),r=Number(r),a=Number(a);var s=!n&&e.startsWith("-")?"-":"",o=(e=e.replace(/(,|ю|б|\?|\/)/gi,".").replace(/[^\d\.]/g,"")).split("."),l=babelHelpers.slicedToArray(o,3),p=l[0],d=l[1],u=void 0===d?"":d;return l[2]?void 0!==i?i:"":void 0!==i&&(p.length>r||u.length>a)?i:(p=(p=p.replace(/^0+(\d+)$/,"$1")).slice(0,r),u=u.slice(0,a),this.props.dischargeSeparator&&(p=p.replace(/\B(?=(?:\d{3})+(?!\d))/g," ")),/\d\./.test(e)&&a?"".concat(s).concat(p,".").concat(u):"".concat(s).concat(p))}},{key:"updateCursorPosition",value:function(){var e=this.nodes.input;e&&(this.cursorPosition=e.selectionStart)}}]),t}(a.PureComponent);babelHelpers.defineProperty(d,"eventHandlers",["onChange","onKeyDown","onKeyPress","onKeyUp","onFocus","onBlur"]),babelHelpers.defineProperty(d,"propTypes",{maxIntegerLength:s.a.oneOfType([s.a.string,s.a.number]),maxFractionLength:s.a.oneOfType([s.a.string,s.a.number]),className:s.a.string,loading:s.a.bool,error:s.a.oneOfType([s.a.bool,s.a.string]),clearable:s.a.bool,positiveOnly:s.a.bool,dischargeSeparator:s.a.bool,textAlign:s.a.oneOf(["left","right"]),size:s.a.oneOf(["s","m","l"]),width:s.a.oneOfType([s.a.string,s.a.number]),stick:o.a.propTypes.stick,marker:s.a.string,markerId:s.a.oneOfType([s.a.string,s.a.number]),id:s.a.string,name:s.a.string,value:s.a.oneOfType([s.a.string,s.a.number]),disabled:s.a.bool,autoComplete:s.a.string,autoFocus:s.a.bool,inputMode:s.a.oneOf(["verbatim","numeric","tel","email","url"]),maxLength:s.a.oneOfType([s.a.string,s.a.number]),minLength:s.a.oneOfType([s.a.string,s.a.number]),pattern:s.a.string,placeholder:s.a.string,readOnly:s.a.bool,required:s.a.bool,tabIndex:s.a.oneOfType([s.a.string,s.a.number]),onChange:s.a.func,onKeyDown:s.a.func,onKeyPress:s.a.func,onKeyUp:s.a.func,onFocus:s.a.func,onBlur:s.a.func,clear:Object(p.a)(s.a.bool,"Use `clearable` instead"),invalid:Object(p.a)(s.a.bool,"Use `error` instead")}),babelHelpers.defineProperty(d,"defaultProps",{maxIntegerLength:15,maxFractionLength:2,dischargeSeparator:!1,value:"",width:12}),t.a=Object(l.a)(d)},950:function(e,t,r){"use strict";var a=r(35),u=r.n(a),n=r(45),i=r.n(n),c=r(6178),p=r(865),l=r(866),s=r(822),o=r(951),b=r.n(o);function d(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)}return r}function f(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?d(r,!0).forEach(function(e){babelHelpers.defineProperty(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):d(r).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}var g=["photo","file"],m=["Б","КБ","МБ","ГБ","ТБ"],h=function(e){function h(e){var r;return babelHelpers.classCallCheck(this,h),r=babelHelpers.possibleConstructorReturn(this,babelHelpers.getPrototypeOf(h).call(this,e)),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleInputChange",function(e){r.handleFilesAdd(e.target.files)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleFileRemove",function(t){r.files.find(function(e){return e.id===t})&&r.props.onChange({type:"remove",files:[t]})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleDragOver",function(e){e.preventDefault(),r.sorting||r.setState({dragOver:!0})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleDropList",function(e){e.preventDefault(),r.setState({dragOver:!1}),r.handleFilesAdd(e.dataTransfer.files)}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleDragLeave",function(e){e.preventDefault(),r.setState({dragOver:!1})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleDragEndMove",function(e){e.preventDefault(),r.sorting=!1,r.setState({draggingPreviewId:null}),r.props.onChange({type:"move",files:r.files.map(function(e){return e.id})})}),babelHelpers.defineProperty(babelHelpers.assertThisInitialized(r),"handleClickPreview",function(e){r.props.onPreviewClick&&r.props.onPreviewClick(e)}),r.files=e.files.slice(0,e.maxFiles),r.sorting=!1,r.state={dragOver:!1,draggingPreviewId:null},r}return babelHelpers.inherits(h,e),babelHelpers.createClass(h,[{key:"componentDidMount",value:function(){document.addEventListener("dragover",this.handleDragOver),document.addEventListener("drop",this.handleDragLeave),document.addEventListener("mouseenter",this.handleDragLeave)}},{key:"componentWillReceiveProps",value:function(e){e.files&&(this.files=e.files.slice(0,e.maxFiles))}},{key:"componentWillUnmount",value:function(){document.removeEventListener("dragover",this.handleDragOver),document.removeEventListener("drop",this.handleDragLeave),document.removeEventListener("mouseenter",this.handleDragLeave)}},{key:"render",value:function(){var e=this.props,t=e.className,r=e.design,a=e.size,n=e.maxFiles,i=this.state.dragOver,s=Object(c.a)(b.a.root,t,b.a["root_design-".concat(r)],b.a["size-".concat(a)]);return u.a.createElement("div",babelHelpers.extends({className:s},Object(c.b)(this.props)),u.a.createElement("div",babelHelpers.extends({className:Object(c.a)(b.a.list,babelHelpers.defineProperty({},b.a.list_dragover,this.files.length<n&&i))},Object(c.b)(this.props,"drop-zone"),{onDrop:this.handleDropList,onDragEnd:this.handleDragEndMove}),this.renderFiles(),this.renderItemAdd(),this.renderMainNote(),u.a.createElement("div",{className:b.a["drag-target"]},u.a.createElement("div",{className:b.a["drag-target-label"]},u.a.createElement("i",{className:b.a["drag-target-icon"]}),this.renderDragTargetMessage()))),this.renderErrors())}},{key:"renderFiles",value:function(){var i=this,s=this.props.design,o=this.files.every(function(e){return e.src})&&1<this.files.length;return this.files.map(function(e,t){var r=e.id;if(s!==g[0])return i.renderItemFile({key:r,classes:b.a.item,file:e});var a,n=Object(c.a)(b.a.item,babelHelpers.defineProperty({},b.a.item_main,i.hasMainImage()&&0===t));return e.src?i.renderItemPreview({key:r,index:t,classes:Object(c.a)(n,b.a.item_preview,(a={},babelHelpers.defineProperty(a,b.a.item_draggable,o),babelHelpers.defineProperty(a,b.a.item_rotating,e.isRotating),babelHelpers.defineProperty(a,b.a.item_dragging,i.state.draggingPreviewId===e.id),a)),file:e,isDraggable:o}):void 0!==e.progress?i.renderItemProgress({key:r,classes:n,progress:e.progress}):null})}},{key:"renderItemPreview",value:function(e){var t,r=this,a=e.key,n=e.index,i=e.classes,s=e.file,o=e.isDraggable,l=this.handleDragStartMove.bind(this,s.id),p=this.handleDragOverMove.bind(this,s.id),d=Object(c.a)(b.a.image,(t={},babelHelpers.defineProperty(t,b.a.image_hidden,s.isHidden),babelHelpers.defineProperty(t,b.a.image_clickable,this.props.onPreviewClick),t));return u.a.createElement("div",babelHelpers.extends({key:a,className:i,draggable:o},Object(c.b)({marker:"preview",markerId:a}),{onDragStart:o?l:null,onDragOver:o?p:null}),u.a.createElement("img",babelHelpers.extends({className:d,src:s.src},Object(c.b)({marker:"preview",markerId:a},"image"),{onClick:function(){r.handleClickPreview(s.id)}})),this.renderRotateButton({key:a,file:s}),this.renderDeleteButton(s.id,a),this.renderToggleButton({key:a,file:s,index:n}))}},{key:"renderRotateButton",value:function(e){var t=e.key,r=e.file,a=this.props,n=a.options,i=void 0===n?{}:n;if(a.disabled)return null;var s=Object(c.a)(b.a.button,b.a.button_rotate),o=this.handleFileRotate.bind(this,r.id);return u.a.createElement("button",babelHelpers.extends({className:s,type:"button",title:"Повернуть",hidden:!1===i.rotateButton},Object(c.b)({marker:"preview",markerId:t},"rotate-button"),{onClick:r.isRotating?null:o}))}},{key:"renderDeleteButton",value:function(e,t){var r=this,a=this.props,n=a.filesRemovalLoading,i=a.options,s=void 0===i?{}:i;if(a.disabled)return null;if(n&&n[e])return u.a.createElement("span",{className:b.a["button_delete-loader"]},u.a.createElement(l.a,{size:"17px"}));var o=Object(c.a)(b.a.button,b.a.button_delete);return u.a.createElement("button",babelHelpers.extends({className:o,type:"button",title:"Удалить",hidden:!1===s.deleteButton},Object(c.b)({marker:"preview",markerId:t},"delete-button"),{onClick:function(){r.handleFileRemove(e)}}))}},{key:"renderToggleButton",value:function(e){var t=e.key,r=e.file,a=e.index,n=this.props,i=n.canHide;if(n.disabled||!i||0===a)return null;var s=Object(c.a)(b.a.button,b.a.button_toggle,babelHelpers.defineProperty({},b.a.button_toggle_hidden,r.isHidden)),o=r.isHidden?"Показывать в объявлении":"Не показывать в объявлении",l=this.handleFileToggle.bind(this,r.id);return u.a.createElement("button",babelHelpers.extends({className:s,type:"button",title:o},Object(c.b)({marker:"preview",markerId:t},"toggle-button"),{onClick:l}))}},{key:"renderItemProgress",value:function(e){var t=e.key,r=e.classes,a=e.progress;return u.a.createElement("div",babelHelpers.extends({key:t,className:r},Object(c.b)({marker:"progress",markerId:t})),this.renderProgress(a))}},{key:"renderProgress",value:function(e){return u.a.createElement("div",{className:b.a.progress},u.a.createElement("div",babelHelpers.extends({className:b.a["progress-bar"],style:{width:e+"%"}},Object(c.b)({marker:"progress-value"}))))}},{key:"renderItemFile",value:function(e){var t=this,r=e.key,a=e.classes,n=e.file,i=void 0!==n.progress;return u.a.createElement("div",babelHelpers.extends({key:r,className:a},Object(c.b)({marker:"file",markerId:r})),u.a.createElement("span",{className:b.a.file},u.a.createElement("span",babelHelpers.extends({className:b.a["file-name"]},Object(c.b)({marker:"file",markerId:r},"name")),n.name),u.a.createElement("span",babelHelpers.extends({className:b.a["file-size"]},Object(c.b)({marker:"file",markerId:r},"size")),this.formatBytes(n.size)),u.a.createElement("button",babelHelpers.extends({className:Object(c.a)(b.a.button,b.a.button_delete),type:"button"},Object(c.b)({marker:"file",markerId:r},"delete-button"),{onClick:function(){t.handleFileRemove(n.id)}}),"Удалить")),i?this.renderProgress(n.progress):null)}},{key:"renderItemAdd",value:function(){var e=this.props,t=e.id,r=e.name,a=e.maxFiles,n=e.accept,i=e.design,s=e.size,o=e.disabled;if(this.files.length>=a||o)return null;var l=p.a.getClassName({className:Object(c.a)(b.a.item,b.a.item_add),size:s});return u.a.createElement("label",babelHelpers.extends({className:l},Object(c.b)({marker:"add"}),i===g[1]&&{tabIndex:0}),i===g[1]?"Выбрать файл":null,u.a.createElement("input",babelHelpers.extends({className:b.a["input-file"],id:t,name:r,value:"",type:"file",accept:n.join(","),multiple:1<a-this.files.length},Object(c.b)({marker:"add"},"input"),{onChange:this.handleInputChange})))}},{key:"renderDragTargetMessage",value:function(){var e="Перетащите сюда ",t=this.props,r=t.maxFiles,a=t.design;return 1<r-this.files.length?a===g[0]?e+"изображения":e+"файлы":a===g[0]?e+"изображение":e+"файл"}},{key:"renderMainNote",value:function(){return this.hasMainImage()?u.a.createElement("span",{className:b.a["main-note"]},"основное фото"):null}},{key:"renderErrors",value:function(){var e=this.props.errors;return e&&e.length?u.a.createElement("div",{className:b.a.errors},e.map(function(e,t){return u.a.createElement("div",babelHelpers.extends({key:e+t,className:b.a.error},Object(c.b)({marker:"error",markerId:e+t})),e)})):null}},{key:"handleFilesAdd",value:function(e){var r=this,t=this.props,a=t.maxFiles,n=t.maxFileSize,i=t.onChange,s=t.onError,o=[],l=[],p=!0,d=!1,u=void 0;try{var c=function(){var e=b.value;if(r.files.length+o.length>=a)return l.push({type:h.errorTypes.MAX_FILES_EXCEEDED}),"break";if(r.props.accept.length&&!r.props.accept.includes(e.type))return l.push({type:h.errorTypes.WRONG_FILE_TYPE,props:{file:e}}),"continue";if(e.size>n)return l.push({type:h.errorTypes.MAX_SIZE_EXCEEDED,props:{file:e}}),"continue";var t=r.createHash(e);if(r.files.some(function(e){return e.id===t}))return l.push({type:h.errorTypes.ALREADY_UPLOADED,props:{file:e}}),"continue";o.push({id:t,file:e,size:e.size,name:e.name,rotate:0,lastModifiedDate:e.lastModifiedDate})};e:for(var b,f=e[Symbol.iterator]();!(p=(b=f.next()).done);p=!0){switch(c()){case"break":break e;case"continue":continue}}}catch(e){d=!0,u=e}finally{try{p||null==f.return||f.return()}finally{if(d)throw u}}o.length&&i({type:"add",files:o}),l.length&&s(l)}},{key:"handleFileRotate",value:function(t){var e=this.files.find(function(e){return e.id===t});e&&this.props.onChange({type:"rotate",files:[f({},e,{rotate:(e.rotate+90)%360})]})}},{key:"handleFileToggle",value:function(t){var e=this.files.find(function(e){return e.id===t});e&&this.props.onChange({type:"toggle",files:[f({},e,{isHidden:!e.isHidden})]})}},{key:"handleDragStartMove",value:function(e,t){t.stopPropagation(),t.dataTransfer.setData("text",""),this.sorting=!0,this.setState({draggingPreviewId:e})}},{key:"handleDragOverMove",value:function(t,e){var r=this;if(e.preventDefault(),e.nativeEvent.stopImmediatePropagation(),e.dataTransfer.dropEffect="move",t!==this.state.draggingPreviewId){var a=this.files.findIndex(function(e){return e.id===t}),n=this.files.findIndex(function(e){return e.id===r.state.draggingPreviewId}),i=this.files.splice(n,1)[0];this.files.splice(a,0,i),this.forceUpdate()}}},{key:"createHash",value:function(e){var t="";if(e.name){var r=encodeURIComponent(e.name).replace(/[^0-9a-z]/gi,"");t=parseInt(r,36).toString().replace(/\.|e\+/g,"")}e.size&&(t+=e.size.toString());var a=e.lastModifiedDate?e.lastModifiedDate.getTime():void 0;return a&&(t+=a.toString()),t}},{key:"formatBytes",value:function(e){var t;if(0<e){var r=Math.min(Math.floor(Math.log(e)/Math.log(1024)),m.length-1);t=Math.round(e/Math.pow(1024,r))+" "+m[r]}else t="0 "+m[0];return t}},{key:"getRandomInputKey",value:function(){return Date.now()+Math.floor(1e7*Math.random())}},{key:"hasMainImage",value:function(){var e=this.props,t=e.design,r=e.maxFiles,a=e.options;return t===g[0]&&1<r&&!1!==(void 0===a?{}:a).description&&this.files.length}}]),h}(a.PureComponent);babelHelpers.defineProperty(h,"propTypes",{className:i.a.string,size:i.a.oneOf(["s","m","l"]),disabled:i.a.bool,design:i.a.oneOf(g),id:i.a.string,name:i.a.string,accept:i.a.arrayOf(i.a.string),maxFiles:i.a.number,maxFileSize:i.a.number,files:i.a.arrayOf(i.a.shape({id:i.a.string.isRequired,src:i.a.string,progress:i.a.number,file:i.a.object,rotate:0,isRotating:i.a.bool,isHidden:i.a.bool})),filesRemovalLoading:i.a.object,options:i.a.shape({deleteButton:i.a.bool,rotateButton:i.a.bool,description:i.a.bool}),errors:i.a.oneOfType([i.a.bool,i.a.arrayOf(i.a.string)]),marker:i.a.string,markerId:i.a.oneOfType([i.a.string,i.a.number]),onChange:i.a.func.isRequired,onPreviewClick:i.a.func,onError:i.a.func,canHide:i.a.bool}),babelHelpers.defineProperty(h,"defaultProps",{accept:["image/gif","image/png","image/jpeg","image/pjpeg"],maxFiles:1,maxFileSize:16e6,design:"photo",size:"s",files:[],onError:function(){}}),babelHelpers.defineProperty(h,"errorTypes",{MAX_SIZE_EXCEEDED:0,MAX_FILES_EXCEEDED:1,ALREADY_UPLOADED:2,WRONG_FILE_TYPE:3}),t.a=Object(s.a)(h)}}]);